import{d as z,N as $,o as i,c as v,a as t,w as l,g as T,cY as xe,i as S,m as R,F as b,r as x,O as X,n as p,j as H,f as g,t as k,h as M,V as w,b as N,aW as F,K as A,cA as Y,v as O,l as G,s as P,bg as Ne,cD as se,c2 as J,b$ as U,cf as ze,aV as D,p as pe,q as K,Q as ve,P as re,k as Ie,cr as fe,cq as ye,aY as oe,cp as ke,M as ee,b3 as de,y as ge,A as je,cZ as Ze,cC as q,cz as Te,co as _e,u as te,c_ as Oe,bj as L,c6 as He,cO as Ye,cP as Xe,c7 as qe,e as I,c$ as Fe,d0 as B,d1 as Je,d2 as Ke,d3 as et,d4 as $e,d5 as tt,d6 as lt,bT as Qe,d7 as W,d8 as Ee,d9 as ae,da as Ge,db as ot,dc as at,dd as nt,de as it,df as st,ak as Me,z as rt,cK as Ue,dg as dt,x as me,dh as ut,di as ct,cQ as Ae,cR as Le,ck as mt,cS as pt,cU as vt,ct as Pe,cM as ft,cW as yt,dj as Se,cL as Re}from"./index-DCXcuAJz.js";import{e as kt,a as gt,L as _t,_ as ht,g as wt,o as Ct,b as bt,h as Vt,c as xt,d as Ot}from"./DialogTextField-CIn-asOA.js";import{a as $t,b as le}from"./ValueSlider-Bcl3TigJ.js";import{C as he}from"./Card-Dj3LhSc_.js";import{_ as De}from"./ColorPicker-B0DOrMyE.js";import{_ as ne}from"./NodeAvatar-CPaoehoz.js";import{_ as Pt}from"./ConnectionAvatar-Ko5ARZiq.js";import{_ as St}from"./NodeMenu-Bc5tNuE3.js";import{a as Rt,_ as Nt}from"./ImportDialog-1H8cn1XC.js";const zt={class:"activityChartPanelMenuPopover"},Be=z({__name:"ActivityChartPanelMenuPopover",props:{graph:{}},emits:["changed"],setup(h,{emit:d}){const e=h,o=$(()=>e.graph),s=d,c=u=>{s("changed",u)};return(u,r)=>(i(),v("div",zt,[t(X,null,{default:l(()=>[t(T,{density:"compact"},{default:l(()=>[t(xe,{fluid:"",value:"Analog signals"},{activator:l(({props:a})=>[t(S,R(a,{title:"Analog signals"}),null,16)]),default:l(()=>[(i(!0),v(b,null,x(o.value.modelsAnalog,(a,n)=>(i(),p(S,{key:"analogPanel"+n,"prepend-icon":a.icon,onClick:m=>c(a.id)},{default:l(()=>[t(H,null,{default:l(()=>[g(k(a.label),1)]),_:2},1024)]),_:2},1032,["prepend-icon","onClick"]))),128))]),_:1}),t(xe,{fluid:"",value:"Spike activity"},{activator:l(({props:a})=>[t(S,R(a,{title:"Spike activity"}),null,16)]),default:l(()=>[(i(!0),v(b,null,x(o.value.modelsSpike,(a,n)=>(i(),p(S,{key:"spikePanel"+n,"prepend-icon":a.icon,onClick:m=>c(a.id)},{default:l(()=>[t(H,null,{default:l(()=>[g(k(a.label),1)]),_:2},1024)]),_:2},1032,["prepend-icon","onClick"]))),128))]),_:1})]),_:1})]),_:1})]))}}),It=z({__name:"ActivityChartPanelModelParamEditor",props:{param:{}},setup(h){const d=h,e=$(()=>d.param),o=[{icon:"mdi:mdi-reload",iconClass:"mdi-flip-h",onClick:()=>{e.value.reset(),e.value.changes()},title:"Set default value"},{icon:"mdi:mdi-eye-off-outline",iconClass:"",onClick:()=>{e.value.hide(),e.value.changes()},title:"Hide parameter"}],s=c=>{c!=null&&(e.value.state.value=c,e.value.changes())};return(c,u)=>d.param?(i(),p(S,{key:0,class:"param pl-0 pr-1"},{append:l(()=>[t(M,null,{activator:l(({props:r})=>[t(w,R({color:"primary",class:"menu align-center justify-center my-auto",icon:"mdi:mdi-dots-vertical",size:"x-small"},r,{variant:"text"}),null,16)]),default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(o,(r,a)=>t(S,{key:a,title:r.title,onClick:n=>r.onClick()},{prepend:l(()=>[t(N,{class:F(r.iconClass),icon:r.icon},null,8,["class","icon"])]),_:2},1032,["title","onClick"])),64))]),_:1})]),_:1})]),default:l(()=>[t(A,{"no-gutters":""},{default:l(()=>[e.value.options.component==="checkbox"?(i(),p(Y,R({key:0,"model-value":e.value.state.value,"onUpdate:modelValue":s,density:"compact","hide-details":""},e.value.options),null,16,["model-value"])):e.value.options.component==="tickSlider"?(i(),p($t,R({key:1,"model-value":e.value.state.value,"onUpdate:modelValue":s},e.value.options),null,16,["model-value"])):(i(),p(le,R({key:2,"model-value":e.value.state.value,"onUpdate:modelValue":s},e.value.options),null,16,["model-value"]))]),_:1})]),_:1})):O("",!0)}}),jt={class:"activityChartPanelToolbar"},Tt={class:"icons"},Qt=z({__name:"ActivityChartPanelToolbar",props:{panel:{}},setup(h){const d=h,e=$(()=>d.panel),o=s=>{e.value.selectModel(s),e.value.graph.update()};return(s,c)=>{var u;return i(),v("div",jt,[t(N,{class:"ma-3",size:"small"},{default:l(()=>[g(k(e.value.model.icon),1)]),_:1}),g(" "+k((u=e.value.model)==null?void 0:u.label)+" ",1),t(G),P("span",Tt,[t(w,{icon:e.value.state.visible?"mdi:mdi-eye":"mdi:mdi-eye-off",onClick:c[0]||(c[0]=r=>e.value.toggleVisible()),class:"mx-1",right:"",size:"x-small",variant:"text"},null,8,["icon"]),t(w,{onClick:c[1]||(c[1]=r=>e.value.decreaseHeight()),class:"mx-1",icon:"mdi:mdi-minus",right:"",size:"x-small",variant:"text"}),t(w,{onClick:c[2]||(c[2]=r=>e.value.increaseHeight()),class:"mx-1",icon:"mdi:mdi-plus",right:"",size:"x-small",variant:"text"}),t(w,{onClick:c[3]||(c[3]=r=>e.value.remove()),class:"mx-1",icon:"mdi:mdi-trash-can-outline",right:"",size:"x-small",variant:"text"}),t(M,{"close-on-content-click":!1},{activator:l(({props:r})=>[t(w,R({icon:"mdi:mdi-dots-vertical",color:"primary",size:"x-small"},r,{variant:"text"}),null,16)]),default:l(()=>[t(Be,{graph:e.value.graph,onChanged:o},null,8,["graph"])]),_:1})])])}}}),ie=z({__name:"NodeRecordChip",props:{nodeRecord:{}},setup(h){const d=h,e=$(()=>d.nodeRecord),o=Ne("category10"),s=["all","category10","category20","paired","set1","set2","set3","tableau10","google10c","google20c"],c=()=>{e.value.state.color="",e.value.node.changes(),u()},u=()=>{D(()=>e.value.node.network.project.activityGraph.activityChartGraph.updateRecordsColor())};return(r,a)=>e.value.state?(i(),p(ze,{key:0,color:e.value.state.color||"",title:e.value.title,onClick:[a[3]||(a[3]=U(()=>{},["prevent"])),a[4]||(a[4]=U(()=>{},["stop"]))],class:"nodeRecordChip",label:"",size:"small",variant:"outlined"},{default:l(()=>[t(M,{"close-on-content-click":!1,activator:"parent",transition:"slide-y-transition"},{default:l(()=>[t(X,null,{default:l(()=>[t(De,{colorScheme:o.value,"hide-inputs":"","onUpdate:modelValue":[a[0]||(a[0]=n=>u()),a[1]||(a[1]=n=>e.value.state.color=n)],modelValue:e.value.state.color},null,8,["colorScheme","modelValue"]),t(se,null,{default:l(()=>[t(J,{items:s,class:"mx-2",density:"compact","hide-details":"",modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=n=>o.value=n),variant:"outlined"},null,8,["modelValue"]),t(w,{onClick:c,size:"small",variant:"outlined"},{default:l(()=>[g(" reset ")]),_:1})]),_:1})]),_:1})]),_:1}),g(" "+k(e.value.groupId)+" "+k(e.value.uuid.slice(0,6)),1)]),_:1},8,["color","title"])):O("",!0)}}),Et={class:"activityChartController"},Gt={key:0},Mt=z({__name:"ActivityChartController",props:{graph:{}},setup(h){const d=h,e=$(()=>d.graph),o=["node","record","trace"],s=r=>{e.value.addPanel({model:{id:r}}),e.value.update()},c=r=>{r.model.selectAllNodeRecords(),e.value.update()},u=()=>{D(()=>{e.value.update()})};return(r,a)=>(i(),v("div",Et,[t(K,{color:"transparent",density:"compact"},{default:l(()=>[t(w,{onClick:a[0]||(a[0]=n=>e.value.resetPanels()),icon:"mdi:mdi-reload",size:"x-small",variant:"outlined"}),t(w,{class:"mx-2","prepend-icon":"mdi:mdi-plus",size:"small",variant:"outlined"},{default:l(()=>[g(" Add panel "),t(M,{"close-on-content-click":!1,activator:"parent"},{default:l(()=>[t(Be,{graph:e.value,onChanged:s},null,8,["graph"])]),_:1})]),_:1}),t(G),t(N,{class:"ma-auto",icon:"mdi:mdi-format-color-fill"}),t(pe,{"onUpdate:modelValue":[a[1]||(a[1]=n=>u()),a[2]||(a[2]=n=>e.value.state.traceColor=n)],class:"mx-2",density:"compact",modelValue:e.value.state.traceColor,variant:"outlined"},{default:l(()=>[(i(),v(b,null,x(o,(n,m)=>t(w,{key:m,text:n,value:n,size:"small"},null,8,["text","value"])),64))]),_:1},8,["modelValue"])]),_:1}),(i(!0),v(b,null,x(e.value.panels,(n,m)=>(i(),v("div",{key:"panel"+m},[t(he,{class:"mx-1",color:"primary"},{default:l(()=>[t(ve,{class:"pa-0"},{default:l(()=>[t(Qt,{panel:n},null,8,["panel"])]),_:2},1024),n.state.visible?(i(),p(re,{key:0,class:"pa-0"},{default:l(()=>[n.model.state.records.length>0?(i(),v("span",Gt,[t(J,{disabled:n.model.state.records.length<2,items:n.model.state.records,"onUpdate:modelValue":[a[3]||(a[3]=_=>u()),_=>n.model.state.recordsVisible=_],class:"pa-1 pt-3",chips:"",clearable:"",density:"compact","item-title":"title","item-value":"groupId","hide-details":"",label:"Recorded events",multiple:"","persistent-hint":"",variant:"outlined",modelValue:n.model.state.recordsVisible},{chip:l(({item:_})=>[t(ie,{nodeRecord:n.model.getNodeRecord(_.value)},null,8,["nodeRecord"])]),item:l(({item:_,props:C})=>[t(S,R({ref_for:!0},C,{density:"compact",title:""}),{default:l(()=>[t(Y,{label:_.title,"model-value":n.model.state.recordsVisible.includes(_.value),density:"compact","hide-details":""},{append:l(()=>[t(ie,{nodeRecord:n.model.getNodeRecord(_.value),class:"my-auto"},null,8,["nodeRecord"])]),_:2},1032,["label","model-value"])]),_:2},1040)]),"prepend-item":l(()=>[t(S,{onClick:_=>c(n),title:"Select All"},null,8,["onClick"]),t(Ie)]),_:2},1032,["disabled","items","modelValue","onUpdate:modelValue"])])):O("",!0),(i(!0),v(b,null,x(n.model.paramsAll,(_,C)=>(i(),p(It,{key:C,"model-value":_.value,param:_,"onUpdate:modelValue":a[4]||(a[4]=y=>e.value.update())},null,8,["model-value","param"]))),128))]),_:2},1024)):O("",!0)]),_:2},1024)]))),128))]))}}),Ut=z({__name:"ConnectionParamEditor",props:{param:{}},setup(h){const d=h,e=$(()=>d.param),o=[{icon:"custom:dice-multiple-outline",onClick:()=>{e.value.state.random=!e.value.state.random,e.value.changes()},title:"Toggle view"},{title:"Set default value",icon:"mdi:mdi-reload",onclick:()=>{e.value.reset(),e.value.changes()}},{title:"Hide parameter",icon:"mdi:mdi-eye-off-outline",onclick:()=>{e.value.hide(),e.value.changes()}}],s=c=>{c!=null&&(e.value.state.value=c,e.value.changes())};return(c,u)=>d.param?(i(),p(S,{key:0,class:"param pl-0 pr-1"},{append:l(()=>[t(M,null,{activator:l(({props:r})=>[t(w,R({color:"primary",class:"menu align-center justify-center my-auto",icon:"mdi:mdi-dots-vertical",size:"x-small"},r),null,16)]),default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(o,(r,a)=>t(S,{key:a,icon:r.icon,onClick:r.onclick},{prepend:l(()=>[t(N,{icon:r.icon},null,8,["icon"])]),default:l(()=>[g(" "+k(r.title),1)]),_:2},1032,["icon","onClick"])),64))]),_:1})]),_:1})]),default:l(()=>[t(A,{"no-gutters":""},{default:l(()=>[e.value.state.random?(i(),p(kt,{key:0,param:e.value},null,8,["param"])):O("",!0),e.value.options.component==="checkbox"?(i(),p(Y,R({key:1,color:e.value.connection.sourceNode.view.color,"model-value":e.value.state.value,"onUpdate:modelValue":s,density:"compact","hide-details":""},e.value.options),null,16,["color","model-value"])):O("",!0),e.value.options.component==="valueSlider"?(i(),p(le,R({key:2,"model-value":e.value.state.value,"thumb-color":e.value.connection.sourceNode.view.color,"onUpdate:modelValue":s},e.value.options),null,16,["model-value","thumb-color"])):O("",!0)]),_:1})]),_:1})):O("",!0)}}),At={class:"d-print-none menu align-center justify-center my-auto mx-1"},Lt=z({__name:"ConnectionSpecEditor",props:{connection:{}},setup(h){const d=h,e=$(()=>d.connection),o=[{title:"all to all",value:"all_to_all"},{title:"one to one",value:"one_to_one"},{title:"fixed indegree",value:"fixed_indegree"},{title:"fixed outdegree",value:"fixed_outdegree"},{title:"pairwise Bernoulli",value:"pairwise_bernoulli"}],s=[{id:"connectionReset",icon:"mdi:mdi-restart",title:"Reset connection",onClick:()=>{e.value.reset()}},{id:"connectionReverse",icon:"mdi:mdi-rotate-3d-variant",title:"Reverse connection",onClick:()=>{e.value.reverse()}}];return(c,u)=>(i(),v(b,null,[t(A,{class:"conn-spec mx-1","no-gutters":""},{default:l(()=>[t(J,{disabled:e.value.sourceNode.size===1&&e.value.targetNode.size===1,items:o,class:"pa-1",density:"compact","hide-details":"",label:"Connection rule",modelValue:e.value.rule.value,"onUpdate:modelValue":u[0]||(u[0]=r=>e.value.rule.value=r),variant:"outlined"},null,8,["disabled","modelValue"]),P("div",At,[t(M,{"close-on-content-click":!1},{activator:l(({props:r})=>[t(w,R({disabled:Object.keys(e.value.params).length===0,color:"primary",icon:"mdi:mdi-order-bool-ascending-variant",size:"small"},r,{variant:"text"}),null,16,["disabled"])]),default:l(()=>[t(X,null,{default:l(()=>[t(re,null,{default:l(()=>[(i(!0),v(b,null,x(Object.values(e.value.params),(r,a)=>(i(),p(Y,{color:e.value.sourceNode.view.color,key:a,label:r.label,value:r.id,density:"compact","hide-details":"",modelValue:e.value.paramsVisible,"onUpdate:modelValue":u[1]||(u[1]=n=>e.value.paramsVisible=n)},{append:l(()=>[g(k(r.id)+": "+k(r.value)+" "+k(r.unit),1)]),_:2},1032,["color","label","value","modelValue"]))),128))]),_:1})]),_:1})]),_:1}),t(M,null,{activator:l(({props:r})=>[t(w,R({color:"primary",icon:"mdi:mdi-dots-vertical",size:"small",variant:"text"},r),null,16)]),default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(s,(r,a)=>t(S,{key:a,icon:r.icon,onClick:r.onClick},{prepend:l(()=>[t(N,{icon:r.icon},null,8,["icon"])]),default:l(()=>[g(" "+k(r.title),1)]),_:2},1032,["icon","onClick"])),64))]),_:1})]),_:1})])]),_:1}),e.value.paramsVisible.length>0?(i(),p(T,{key:0,density:"compact"},{default:l(()=>[(i(!0),v(b,null,x(e.value.filteredParams,(r,a)=>(i(),p(Ut,{key:a,param:r},null,8,["param"]))),128))]),_:1})):O("",!0)],64))}}),Dt={class:"d-print-none menu align-center justify-center my-auto mx-1"},Bt=z({__name:"SynapseSpecEditor",props:{synapse:{}},setup(h){const d=h,e=$(()=>d.synapse),o=u=>{e.value.weight=u,e.value.changes()},s={id:"weight",component:"valueSlider",label:"synaptic weight",max:10,min:-10,step:.01,unit:"pA",value:1},c=[{id:"paramsReset",icon:"mdi:mdi-restart",title:"Reset synaptic weight",onClick:()=>{e.value.reset()},show:()=>!0},{id:"weightInverse",icon:"mdi:mdi-contrast",title:"Inverse synaptic weight",onClick:()=>{e.value.inverseWeight()}}];return(u,r)=>e.value.connection.view.connectRecorder()?O("",!0):(i(),p(A,{key:0,class:"syn-spec mx-1","no-gutters":""},{default:l(()=>[t(T,{density:"compact",width:"100%"},{default:l(()=>[t(S,{class:"param pl-0 pr-1"},{append:l(()=>[P("div",Dt,[t(M,null,{activator:l(({props:a})=>[t(w,R({color:"primary",icon:"mdi:mdi-dots-vertical",size:"small",variant:"text"},a),null,16)]),default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(c,(a,n)=>t(S,{key:n,onClick:a.onClick},{prepend:l(()=>[t(N,{icon:a.icon},null,8,["icon"])]),default:l(()=>[g(" "+k(a.title),1)]),_:2},1032,["onClick"])),64))]),_:1})]),_:1})])]),default:l(()=>[t(le,R({"model-value":e.value.weight,thumbColor:e.value.connection.sourceNode.view.color,"onUpdate:modelValue":o},s),null,16,["model-value","thumbColor"])]),_:1})]),_:1})]),_:1}))}}),Wt={class:"d-flex flex-column justify-center align-center text-grey"},We=z({__name:"ConnectionEditor",props:{connection:{}},setup(h){const d=h,e=$(()=>d.connection),o=$(()=>e.value.synapse),s=[{id:"connectionReset",icon:"mdi:mdi-restart",title:"Reset connection",onClick:()=>{e.value.reset(),e.value.synapse.reset()}},{id:"connectionReverse",icon:"mdi:mdi-rotate-3d-variant",title:"Reverse connection",onClick:()=>{e.value.reverse(),e.value.changes()}},{id:"weightInverse",icon:"mdi:mdi-contrast",title:"Inverse synaptic weight",onClick:()=>{e.value.synapse.inverseWeight()}},{id:"connectionDelete",icon:"mdi:mdi-trash-can-outline",title:"Delete connection",onClick:()=>{e.value.remove()},append:!0}];return(c,u)=>(i(),p(ke,{style:oe({opacity:e.value.view.opacity?1:.3}),onMouseenter:u[0]||(u[0]=r=>e.value.state.focus()),onMouseleave:u[1]||(u[1]=r=>e.value.connections.unfocusConnection()),elevation:"0",rounded:"0"},{default:l(()=>[t(fe,{class:"expansion-panel-title"},{default:l(()=>[t(A,{"no-gutters":""},{default:l(()=>[t(Pt,{connection:e.value},null,8,["connection"]),t(G),P("div",Wt,k(e.value.rule.value),1),t(G),t(w,{color:"primary",icon:"mdi:mdi-dots-vertical",size:"small",variant:"text",class:"menu"}),t(M,{activator:"parent"},{default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(s,(r,a)=>t(S,{icon:r.icon,key:a,onClick:r.onClick},{prepend:l(()=>[t(N,{icon:r.icon},null,8,["icon"])]),default:l(()=>[g(" "+k(r.title),1)]),_:2},1032,["icon","onClick"])),64))]),_:1})]),_:1})]),_:1})]),_:1}),t(ye,{class:"ma-1"},{default:l(()=>[t(Lt,{connection:e.value},null,8,["connection"]),t(Bt,{synapse:o.value},null,8,["synapse"])]),_:1})]),_:1},8,["style"]))}}),Zt={key:0},Ht={key:1},Yt=z({__name:"NodeGroupMenu",props:{nodeGroup:{}},setup(h){const d=h,e=$(()=>d.nodeGroup),o=ee({content:void 0,show:!1}),s=[{icon:"mdi:mdi-format-color-fill",iconClass:"",id:"nodeGroupColor",onClick:()=>{o.content="nodeGroupColor",window.dispatchEvent(new Event("resize"))},append:!0,show:()=>!0,title:"Colorize node"},{icon:"mdi:mdi-content-copy",iconClass:"",id:"nodeGroupClone",onClick:()=>{e.value.clone(),e.value.changes(),r()},show:()=>!0,title:"Clone node group"},{icon:"mdi:mdi-trash-can-outline",iconClass:"",id:"nodeGroupDelete",onClick:()=>{q({title:"Delete node group?",text:"Are you sure to delete node group?",buttons:[{title:"no",key:"no"},{title:"yes",key:"yes"}]}).then(a=>{a==="yes"&&e.value.remove()})},show:()=>!0,title:"Delete node group"}],c=()=>{e.value.view.color="",e.value.changes()},u=()=>{o.content=void 0},r=()=>{o.content=void 0,o.show=!1};return de(()=>{r()}),(a,n)=>(i(),p(M,{"close-on-content-click":!1,activator:"parent",modelValue:o.show,"onUpdate:modelValue":n[2]||(n[2]=m=>o.show=m)},{default:l(()=>[t(X,{flat:"",style:{"min-width":"300px"}},{default:l(()=>[o.content==null?(i(),v("span",Zt,[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(s,(m,_)=>ge(t(S,{key:_,title:m.title,onClick:m.onClick},{append:l(()=>[m.append?(i(),p(N,{key:0,icon:"mdi:mdi-menu-right",size:"small"})):O("",!0)]),prepend:l(()=>[t(N,{class:F(m.iconClass),icon:m.icon},null,8,["class","icon"])]),_:2},1032,["title","onClick"]),[[je,m.show()]])),64))]),_:1})])):O("",!0),o.content==="nodeGroupColor"?(i(),v("span",Ht,[t(Ze,{"onUpdate:modelValue":[n[0]||(n[0]=m=>e.value.changes()),n[1]||(n[1]=m=>e.value.view.color=m)],flat:"","show-swatches":"",elevation:"0",modelValue:e.value.view.color},null,8,["modelValue"]),t(se,null,{default:l(()=>[t(w,{onClick:u,"prepend-icon":"mdi:mdi-menu-left",size:"small",variant:"text"},{default:l(()=>[g(" back ")]),_:1}),t(G),t(w,{onClick:c,size:"small",variant:"outlined"},{default:l(()=>[g(" reset ")]),_:1})]),_:1})])):O("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Xt=z({__name:"NodeGroup",props:{nodeGroup:{}},setup(h){return(d,e)=>d.nodeGroup.show?(i(),p(X,{key:0,color:d.nodeGroup.view.color,onMouseenter:e[2]||(e[2]=o=>d.nodeGroup.view.focus()),onMouseleave:e[3]||(e[3]=o=>d.nodeGroup.parentNodes.unfocusNode()),class:"node-group ma-1",variant:"outlined"},{default:l(()=>[t(ve,{class:"node-group-title"},{default:l(()=>[t(A,{"no-gutters":""},{default:l(()=>[t(w,{onClick:e[0]||(e[0]=U(o=>d.nodeGroup.select(),["stop"])),class:"mx-1",flat:"",icon:""},{default:l(()=>[t(ne,{node:d.nodeGroup,size:"48px"},null,8,["node"])]),_:1}),t(Ie,{inset:"",vertical:""}),t(Te,{class:"mx-4",multiple:"",rounded:"xl",variant:"outlined"},{default:l(()=>[(i(!0),v(b,null,x(d.nodeGroup.nodes,(o,s)=>(i(),p(w,{key:s,onClick:U(c=>o.select(),["stop"]),class:"btn-avatar px-0",size:"small"},{default:l(()=>[t(ne,{node:o,size:"32px"},null,8,["node"])]),_:2},1032,["onClick"]))),128))]),_:1}),t(G),t(w,{class:"menu d-print-none ma-auto",color:"primary",icon:"",size:"small",variant:"text"},{default:l(()=>[t(N,{icon:"mdi:mdi-dots-vertical"}),t(Yt,{nodeGroup:d.nodeGroup},null,8,["nodeGroup"])]),_:1})]),_:1})]),_:1}),d.nodeGroup.connections.length>0?(i(),p(se,{key:0,style:{"min-height":"40px"}},{default:l(()=>[t(A,null,{default:l(()=>[(i(),p(_e,{key:d.nodeGroup.connections.length,modelValue:d.nodeGroup.view.expansionPanelIdx,"onUpdate:modelValue":e[1]||(e[1]=o=>d.nodeGroup.view.expansionPanelIdx=o),variant:"accordion"},{default:l(()=>[(i(!0),v(b,null,x(d.nodeGroup.connections,(o,s)=>(i(),p(We,{connection:o,key:s},null,8,["connection"]))),128))]),_:1},8,["modelValue"]))]),_:1})]),_:1})):O("",!0)]),_:1},8,["color"])):O("",!0)}}),qt=z({__name:"NetworkHistory",setup(h){const d=te(),e=$(()=>d.currentSimulator.stores.projectStore.state.project),o=$(()=>e.value.networkRevision.revisionIdx),s=$(()=>e.value.networkRevision.revisions.length-e.value.networkRevision.revisionIdx-1);return(c,u)=>(i(),p(Te,{density:"compact",theme:"dark",variant:"tonal"},{default:l(()=>[t(w,{disabled:o.value<=0,onClick:u[0]||(u[0]=r=>e.value.networkRevision.older()),stacked:"",title:"load older network"},{default:l(()=>[t(Oe,{content:o.value,"offset-y":o.value>0?-2:-18,color:"blue",location:"bottom right","offset-x":"-8"},{default:l(()=>[t(N,null,{default:l(()=>[g("mdi-undo-variant")]),_:1})]),_:1},8,["content","offset-y"])]),_:1},8,["disabled"]),t(w,{disabled:s.value<=0,onClick:u[1]||(u[1]=r=>e.value.networkRevision.newer()),stacked:"",title:"load newer network"},{default:l(()=>[t(Oe,{content:s.value,"offset-y":s.value>0?-2:-18,color:"blue",location:"bottom right","offset-x":"-8"},{default:l(()=>[t(N,null,{default:l(()=>[g("mdi-redo-variant")]),_:1})]),_:1},8,["content","offset-y"])]),_:1},8,["disabled"])]),_:1}))}}),Ft={class:"text-no-wrap"},Zl=z({__name:"ProjectBar",setup(h){const d=te(),e=$(()=>d.currentSimulator.stores.projectStore),o=[{icon:"network:network",iconClass:"",id:"networkEditor",label:"Editor",title:"Network editor",to:{name:"NetworkEditor"}},{icon:"mdi:mdi-border-style",iconClass:"mdi-flip-v",id:"activityExplorer",label:"Explorer",title:"Activity explorer",to:{name:"ActivityExplorer"}},{icon:"mdi:mdi-book-open-outline",iconClass:"",id:"labBook",label:"Lab book",title:"Lab book",to:{name:"LabBook"}}];return(s,c)=>(i(),p(Xe,{class:"d-print-none",height:"48",flat:""},{default:l(()=>[t(He,{stacked:""},{default:l(()=>[L(s.$slots,"tabs",{},()=>[(i(),v(b,null,x(o,(u,r)=>L(s.$slots,u.id,{},()=>[(i(),p(qe,{key:r,to:{name:I(d).state.simulator+u.to.name,params:{projectId:e.value.state.projectId}},title:u.title,size:"small"},{default:l(()=>[t(N,{class:F(u.iconClass),icon:u.icon},null,8,["class","icon"]),P("span",Ft,k(u.label),1)]),_:2},1032,["to","title"]))])),64))])]),_:3}),t(G),t(Ye,null,{default:l(()=>[g(k(e.value.state.project.name),1)]),_:1}),t(G),t(qt),t(gt,{simulation:e.value.state.project.simulation,"onClick:simulate":c[0]||(c[0]=u=>e.value.startSimulation())},null,8,["simulation"])]),_:3}))}}),Jt=Fe({String:B.string,Number:B.number,"True False":B.bool,PropertyName:B.propertyName,Null:B.null,",":B.separator,"[ ]":B.squareBracket,"{ }":B.brace}),Kt=_t.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#CjOOQO'#Cp'#CpQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CrOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59U,59UO!iQPO,59UOVQPO,59QOqQPO'#CkO!nQPO,59^OOQO1G.k1G.kOVQPO'#ClO!vQPO,59aOOQO1G.p1G.pOOQO1G.l1G.lOOQO,59V,59VOOQO-E6i-E6iOOQO,59W,59WOOQO-E6j-E6j",stateData:"#O~OcOS~OQSORSOSSOTSOWQO]ROePO~OVXOeUO~O[[O~PVOg^O~Oh_OVfX~OVaO~OhbO[iX~O[dO~Oh_OVfa~OhbO[ia~O",goto:"!kjPPPPPPkPPkqwPPk{!RPPP!XP!ePP!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:"⚠ JsonText True False Null Number String } { Object Property PropertyName ] [ Array",maxTerm:25,nodeProps:[["isolate",-2,6,11,""],["openedBy",7,"{",12,"["],["closedBy",8,"}",13,"]"]],propSources:[Jt],skippedNodes:[0],repeatNodeCount:2,tokenData:"(|~RaXY!WYZ!W]^!Wpq!Wrs!]|}$u}!O$z!Q!R%T!R![&c![!]&t!}#O&y#P#Q'O#Y#Z'T#b#c'r#h#i(Z#o#p(r#q#r(w~!]Oc~~!`Wpq!]qr!]rs!xs#O!]#O#P!}#P;'S!];'S;=`$o<%lO!]~!}Oe~~#QXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#m~#pR!Q![#y!c!i#y#T#Z#y~#|R!Q![$V!c!i$V#T#Z$V~$YR!Q![$c!c!i$c#T#Z$c~$fR!Q![!]!c!i!]#T#Z!]~$rP;=`<%l!]~$zOh~~$}Q!Q!R%T!R![&c~%YRT~!O!P%c!g!h%w#X#Y%w~%fP!Q![%i~%nRT~!Q![%i!g!h%w#X#Y%w~%zR{|&T}!O&T!Q![&Z~&WP!Q![&Z~&`PT~!Q![&Z~&hST~!O!P%c!Q![&c!g!h%w#X#Y%w~&yOg~~'OO]~~'TO[~~'WP#T#U'Z~'^P#`#a'a~'dP#g#h'g~'jP#X#Y'm~'rOR~~'uP#i#j'x~'{P#`#a(O~(RP#`#a(U~(ZOS~~(^P#f#g(a~(dP#i#j(g~(jP#X#Y(m~(rOQ~~(wOW~~(|OV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),el=Ke.define({name:"json",parser:Kt.configure({props:[et.add({Object:$e({except:/^\s*\}/}),Array:$e({except:/^\s*\]/})}),tt.add({"Object Array":lt})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function tl(){return new Je(el)}const ll={style:{color:"rgb(var(--v-theme-primary))"}},ol={style:{color:"rgb(var(--v-theme-primary))"}},al={style:{color:"rgb(var(--v-theme-primary))"}},nl={class:"pr-4 wrapper-table"},il={class:"py-2"},sl=P("td",{style:{width:"48px"}},null,-1),rl={key:0},dl={key:1},ul=P("span",null,"μ",-1),cl={key:2},ml=z({__name:"ActivityStatsAnalog",props:{activity:{}},setup(h){const d=h,e=$(()=>d.activity),o=$(()=>e.value.recorder.records[0]),s=ee({activityHash:"",items:[],loading:!1,selectedRecord:""}),c=[{title:"ID",key:"id"},{title:"Mean",key:"mean"},{title:"Std",key:"std"},{title:"Actions",key:"actions",sortable:!1}],u=_=>ae(s.items.map(C=>C[_])),r=()=>{D(()=>a())},a=()=>{if(s.loading=!0,s.items=[],!s.selectedRecord&&e.value.recorder.records.length>0&&(s.selectedRecord=o.value.id),e.value&&s.selectedRecord){const _=e.value.events[s.selectedRecord],C=Object.create(null);e.value.nodeIds.forEach(y=>C[y]=[]),e.value.events.senders.forEach((y,V)=>{C[y].push(_[V])}),s.items=e.value.nodeIds.map(y=>{const V=C[y];return{id:y,mean:V.length>0?ae(V):NaN,std:V.length>0?Ge(V):NaN}})}s.activityHash=e.value.hash,s.loading=!1},n=()=>{D(()=>{e.value.chartGraph.updateRecordsColor()})},m=()=>{D(()=>{e.value.state.selected.sort((_,C)=>_-C),e.value.chartGraph.update()})};return de(()=>a()),Qe(()=>e.value.hash,()=>a()),(_,C)=>(i(),p(Ee,{headers:c,items:s.items,key:s.activityHash,loading:s.loading,"onUpdate:modelValue":[C[3]||(C[3]=y=>m()),C[4]||(C[4]=y=>e.value.state.selected=y)],class:"activityStatsAnalog",density:"compact","fixed-header":"","loading-text":"Loading... Please wait","show-select":"",modelValue:e.value.state.selected},{top:l(()=>[e.value.recorder.model.isMultimeter?(i(),p(J,{key:0,readonly:e.value.recorder.records.length<2,items:e.value.recorder.records,"onUpdate:modelValue":[C[0]||(C[0]=y=>r()),C[1]||(C[1]=y=>s.selectedRecord=y)],chips:"",class:"mr-1",density:"compact","hide-details":"","item-title":"title","item-value":"id",modelValue:s.selectedRecord,variant:"outlined"},{chip:l(({item:y})=>[g(k(y.title)+" ",1),y.raw.groupId?(i(),p(ie,{key:0,nodeRecord:e.value.getNodeRecord(y.raw.groupId),style:{position:"absolute",right:"4px"}},null,8,["nodeRecord"])):O("",!0)]),item:l(({item:y,props:V})=>[t(S,R(V,{density:"compact",title:""}),{default:l(()=>[t(A,{"no-gutters":""},{default:l(()=>[g(k(y.title)+" ",1),t(G),y.raw.groupId?(i(),p(ie,{key:0,nodeRecord:e.value.getNodeRecord(y.raw.groupId),class:"my-auto"},null,8,["nodeRecord"])):O("",!0)]),_:2},1024)]),_:2},1040)]),_:1},8,["readonly","items","modelValue"])):O("",!0)]),"item.id":l(({item:y})=>[P("span",ll,k(y.id),1)]),"item.mean":l(({item:y})=>[P("span",ol,k(I(W)(Number(y.mean))),1)]),"item.std":l(({item:y})=>[P("span",al,k(I(W)(Number(y.std))),1)]),"item.actions":l(({index:y})=>[t(M,{transition:"slide-y-transition"},{activator:l(({props:V})=>[t(N,R({color:o.value.state.traceColors[y],class:"me-2",icon:"mdi:mdi-format-color-fill",size:"small"},V),null,16,["color"])]),default:l(()=>[t(De,{"onUpdate:modelValue":[C[2]||(C[2]=V=>n()),V=>o.value.state.traceColors[y]=V],colorScheme:"google20c","hide-inputs":"",modelValue:o.value.state.traceColors[y]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),bottom:l(()=>[P("div",nl,[P("table",il,[P("tr",null,[sl,(i(),v(b,null,x(c,(y,V)=>P("td",{key:V,class:"px-2"},[y.key==="id"?(i(),v("div",rl,"Total")):["mean","std"].includes(y.key)?(i(),v("div",dl,[ul,g(" = "+k(I(W)(u(y.key))),1)])):(i(),v("div",cl))])),64))])])])]),_:1},8,["items","loading","modelValue"]))}}),pl={class:"pr-4 wrapper-table"},vl={class:"py-2"},fl={key:0},yl={key:1},kl=P("span",null,"Σ",-1),gl={key:2},_l=P("span",null,"μ",-1),hl=z({__name:"ActivityStatsSpike",props:{activity:ot,height:{default:500,type:Number}},setup(h){const d=h,e=$(()=>d.activity),o=ee({activityHash:"",items:[],loading:!1,search:""}),s=[{title:"ID",align:"start",key:"id"},{title:"Spike count",key:"count"},{title:"mean (ISI)",key:"meanISI"},{title:"std (ISI)",key:"stdISI"},{title:"cv (ISI)",key:"cvISI"}],c=a=>ae(o.items.map(n=>n[a])),u=a=>at(o.items.map(n=>n[a])),r=()=>{if(o.loading=!0,o.items=[],e.value&&e.value.nodeIds.length>0){const a=Object.create(null);e.value.nodeIds.forEach(n=>{a[n]=[]}),e.value.events.senders.forEach((n,m)=>{a[n].push(e.value.events.times[m])}),o.items=e.value.nodeIds.map(n=>{let m=a[n],_=[],C=NaN,y=NaN,V=NaN;return m.length>1&&(m=m.sort((j,f)=>j-f),_=nt(m),C=_.length>0?ae(_):NaN,y=_.length>0?Ge(_):NaN,!isNaN(C)&&!isNaN(y)&&(V=y/C)),{id:n,count:m.length,meanISI:C,stdISI:y,cvISI:V}})}o.activityHash=e.value.hash,o.loading=!1};return de(()=>{r()}),Qe(()=>e.value.hash,()=>r()),(a,n)=>(i(),p(Ee,{headers:s,height:d.height,items:o.items,key:o.activityHash,loading:o.loading,class:"activityStatsSpike",density:"compact","fixed-header":"","loading-text":"Loading... Please wait"},{"item.meanISI":l(({item:m})=>[g(k(I(W)(Number(m.meanISI))),1)]),"item.stdISI":l(({item:m})=>[g(k(I(W)(Number(m.stdISI))),1)]),"item.cvISI":l(({item:m})=>[g(k(I(W)(Number(m.cvISI))),1)]),bottom:l(()=>[P("div",pl,[P("table",vl,[P("tr",null,[(i(),v(b,null,x(s,(m,_)=>P("td",{key:_,class:"px-2"},[m.key==="id"?(i(),v("div",fl,"Total")):m.key==="count"?(i(),v("div",yl,[kl,g(" = "+k(u(m.key)),1)])):(i(),v("div",gl,[_l,g(" = "+k(I(W)(c(m.key))),1)]))])),64))])])])]),_:1},8,["headers","height","items","loading"]))}}),wl={class:"activityStatsViewer"},Cl=z({__name:"ActivityStats",props:{activities:{}},setup(h){const d=h,e=$(()=>d.activities),o=ee({height:700}),s=["node","record","trace"],c=()=>{o.height=window.innerHeight-24-48-48-64-(e.value.all.length-1)*48-42},u=()=>{D(()=>{e.value.project.activityGraph.activityChartGraph.update()})};return(r,a)=>(i(),v("div",wl,[t(K,{color:"transparent",density:"compact",title:"Activity stats"},{default:l(()=>[t(G),t(N,{class:"ma-auto",icon:"mdi:mdi-format-color-fill"}),t(pe,{"onUpdate:modelValue":[a[0]||(a[0]=n=>u()),a[1]||(a[1]=n=>e.value.project.activityGraph.activityChartGraph.state.traceColor=n)],class:"mx-2",density:"compact",modelValue:e.value.project.activityGraph.activityChartGraph.state.traceColor,variant:"outlined"},{default:l(()=>[(i(),v(b,null,x(s,(n,m)=>t(w,{key:m,text:n,value:n,size:"small"},null,8,["text","value"])),64))]),_:1},8,["modelValue"])]),_:1}),ge((i(),p(it,{class:"activityStats ml-1","full-height":""},{default:l(()=>[t(_e,{mandatory:"",modelValue:e.value.state.activityStatsPanelId,"onUpdate:modelValue":a[2]||(a[2]=n=>e.value.state.activityStatsPanelId=n),variant:"accordion"},{default:l(()=>[(i(!0),v(b,null,x(e.value.all,(n,m)=>(i(),p(ke,{key:m},{default:l(()=>[t(fe,{class:"py-0"},{default:l(()=>[t(A,{class:"text-button"},{default:l(()=>[t(ne,{node:n.recorder},null,8,["node"]),t(G),g(" "+k(n.recorder.model.label)+" ",1),t(G)]),_:2},1024)]),_:2},1024),(i(),p(ye,{key:e.value.hash,class:"ma-0 pa-0"},{default:l(()=>[n.recorder.model.isSpikeRecorder?(i(),p(hl,{key:0,activity:n,height:o.height},null,8,["activity","height"])):O("",!0),n.recorder.model.isAnalogRecorder?(i(),p(ml,{key:1,activity:n,height:o.height-(n.recorder.model.isMultimeter?40:0)},null,8,["activity","height"])):O("",!0)]),_:2},1024))]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})),[[st,c]])]))}}),bl={class:"d-print-none"},Vl={class:"d-print-none menu"},xl=z({__name:"NodeEditor",props:{node:{}},setup(h){const d=h,e=$(()=>d.node),o=ee({elementType:"",items:[],menu:!1,panelIdx:null}),s=[{title:"neuron",value:"neuron"},{title:"recorder",value:"recorder"},{title:"stimulator",value:"stimulator"}],c=[{icon:"mdi:mdi-reload",iconClass:"mdi-flip-h",onClick:()=>{e.value.size=1},title:"Set default size"}],u=(r,a)=>{["neuron","recorder","stimulator"].includes(r.value)?(o.elementType=r.value,o.items=e.value.network.project.modelDBStore.getModelsByElementType(o.elementType)):e.value.modelId=r.value,a&&a()};return de(()=>{o.items=e.value.models,o.elementType=e.value.elementType}),(r,a)=>e.value.show?(i(),p(he,{key:0,color:e.value.view.color,onMouseenter:a[13]||(a[13]=n=>e.value.view.focus()),onMouseleave:a[14]||(a[14]=n=>e.value.nodes.unfocusNode()),class:"node ma-1"},{default:l(()=>[(i(),p(_e,{key:e.value.connections.length,modelValue:e.value.view.expansionPanelIdx,"onUpdate:modelValue":a[12]||(a[12]=n=>e.value.view.expansionPanelIdx=n),variant:"accordion"},{default:l(()=>[t(ke,null,{default:l(()=>[t(fe,{class:"node-title"},{default:l(()=>[t(J,{items:e.value.models,label:e.value.model.elementType+" model",onClick:a[8]||(a[8]=U(()=>{},["stop"])),class:"text-primary",density:"compact","hide-details":"","item-title":"label","item-value":"id",modelValue:e.value.modelId,"onUpdate:modelValue":a[9]||(a[9]=n=>e.value.modelId=n),variant:"outlined"},Me({append:l(()=>[P("div",bl,[t(ze,null,{default:l(()=>[g(k(e.value.hash),1)]),_:1})]),P("div",Vl,[t(M,{"close-on-content-click":!1,modelValue:o.menu,"onUpdate:modelValue":a[5]||(a[5]=n=>o.menu=n)},{activator:l(({props:n})=>[t(w,R({color:"primary",icon:"mdi:mdi-order-bool-ascending-variant",size:"small"},n,{variant:"text"}),null,16)]),default:l(()=>[t(X,null,{default:l(()=>[t(re,null,{default:l(()=>[t(Y,{disabled:e.value.model.isRecorder,color:e.value.view.color,density:"compact","hide-details":"",label:"Population size",modelValue:e.value.view.state.showSize,"onUpdate:modelValue":a[0]||(a[0]=n=>e.value.view.state.showSize=n)},{append:l(()=>[g("n: "+k(e.value.size),1)]),_:1},8,["disabled","color","modelValue"]),e.value.modelParams?(i(!0),v(b,{key:0},x(Object.values(e.value.modelParams),(n,m)=>(i(),p(Y,{color:e.value.view.color,key:m,label:n.label,value:n.id,density:"compact","hide-details":"",modelValue:e.value.paramsVisible,"onUpdate:modelValue":a[1]||(a[1]=_=>e.value.paramsVisible=_)},{append:l(()=>[g(k(n.id)+": "+k(n.value)+" "+k(n.unit),1)]),_:2},1032,["color","label","value","modelValue"]))),128)):O("",!0)]),_:1}),t(se,null,{default:l(()=>[t(w,{onClick:a[2]||(a[2]=U(()=>e.value.showAllParams(),["stop"])),size:"small",variant:"outlined"},{default:l(()=>[g(" all ")]),_:1}),t(w,{onClick:a[3]||(a[3]=U(()=>e.value.hideAllParams(),["stop"])),size:"small",variant:"outlined"},{default:l(()=>[g(" none ")]),_:1}),t(G),t(w,{onClick:a[4]||(a[4]=U(n=>o.menu=!1,["stop"])),size:"small",variant:"outlined"},{default:l(()=>[g(" close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(w,{color:"primary",icon:"",size:"small",variant:"text"},{default:l(()=>[t(N,{icon:"mdi:mdi-dots-vertical"}),t(St,{node:e.value},null,8,["node"])]),_:1})])]),item:l(({props:n})=>[t(S,{onClick:m=>u(n),class:"node-model-item"},{append:l(()=>[t(w,{onClick:U(m=>u(n,()=>o.menu=!0),["stop"]),class:"icon",icon:"mdi:mdi-menu-right",size:"small",variant:"text"},null,8,["onClick"])]),default:l(()=>[g(k(n.title)+" ",1)]),_:2},1032,["onClick"])]),prepend:l(()=>[t(w,{class:"position-absolute",flat:"",icon:"",size:"large",style:{left:"8px",top:"8px"}},{default:l(()=>[t(ne,{node:e.value,onClick:a[6]||(a[6]=n=>e.value.select()),size:"48px"},null,8,["node"])]),_:1})]),_:2},[o.elementType?{name:"prepend-item",fn:l(()=>[t(S,{onClick:a[7]||(a[7]=()=>{o.elementType="",o.items=s})},{prepend:l(()=>[t(N,{icon:"mdi:mdi-menu-left"})]),default:l(()=>[g(" Other element types ")]),_:1})]),key:"0"}:void 0]),1032,["items","label","modelValue"])]),_:1}),t(ye,null,{default:l(()=>[e.value.view.state.showSize?(i(),p(T,{key:0,class:"py-0"},{default:l(()=>[t(S,{class:"param pl-0 pr-1"},{default:l(()=>[t(A,{"no-gutters":""},{default:l(()=>[t(le,{"thumb-color":e.value.view.color,"onUpdate:modelValue":[a[10]||(a[10]=n=>e.value.changes()),a[11]||(a[11]=n=>e.value.size=n)],id:"n","input-label":"n",label:"population size",modelValue:e.value.size},null,8,["thumb-color","modelValue"]),t(M,{"close-on-content-click":!1},{activator:l(({props:n})=>[t(w,R({color:"primary",class:"d-print-none menu align-center justify-center my-auto",icon:"mdi:mdi-dots-vertical",size:"x-small"},n,{variant:"text"}),null,16)]),default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(c,(n,m)=>t(S,{icon:n.icon,key:m,title:n.title},{prepend:l(()=>[t(N,{class:F(n.iconClass),icon:n.icon},null,8,["class","icon"])]),_:2},1032,["icon","title"])),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):O("",!0),e.value.paramsVisible.length>0?(i(),p(T,{key:e.value.modelId,class:"py-0"},{default:l(()=>[(i(!0),v(b,null,x(e.value.paramsVisible,(n,m)=>(i(),p(ht,{key:m,param:e.value.params[n]},null,8,["param"]))),128))]),_:1})):O("",!0)]),_:1})]),_:1}),(i(!0),v(b,null,x(e.value.connections,(n,m)=>(i(),p(We,{connection:n,key:m},null,8,["connection"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["color"])):O("",!0)}}),Ol={class:"networkParamEditor"},$l=z({__name:"NetworkParamEditor",props:{network:{}},setup(h){return(d,e)=>(i(),v("div",Ol,[t(K,{color:"transparent",density:"compact"},{default:l(()=>[t(pe,{class:"ma-2",mandatory:"",modelValue:d.network.state.state.elementTypeIdx,"onUpdate:modelValue":e[1]||(e[1]=o=>d.network.state.state.elementTypeIdx=o),variant:"text"},{default:l(()=>[(i(!0),v(b,null,x(d.network.elementTypes,(o,s)=>(i(),p(wt,{icon:o.icon,key:s,title:o.title,onClick:e[0]||(e[0]=c=>d.network.nodes.unselectNodes()),size:"x-small"},null,8,["icon","title"]))),128))]),_:1},8,["modelValue"]),t(G),t(w,{icon:"mdi:mdi-dots-vertical",size:"small"})]),_:1}),L(d.$slots,"model"),L(d.$slots,"nodes",{},()=>[(i(),v("div",{key:d.network.nodes.length},[(i(!0),v(b,null,x(d.network.nodes.all,(o,s)=>(i(),v("div",{key:s},[o.isNode?(i(),p(xl,{key:0,node:o},null,8,["node"])):o.isGroup?(i(),p(Xt,{key:1,nodeGroup:o},null,8,["nodeGroup"])):O("",!0)]))),128))]))])]))}}),Pl={class:"simulationKernelEditor"},Sl=z({__name:"SimulationKernelEditor",props:{color:{},simulation:{}},setup(h){const d=h,e={simulationTimeSettings:{id:"time",component:"valueSlider",label:"simulation time",max:2e3,min:0,unit:"ms",value:1e3,rules:[o=>o<2e3||"Large values generate many data points and can put quite a load on your browser."]}};return(o,s)=>(i(),v("div",Pl,[t(K,{color:"transparent",density:"compact"},{default:l(()=>[t(rt,null,{default:l(()=>[g("Simulation kernel editor")]),_:1})]),_:1}),t(he,{color:d.color||"primary",class:"ma-1"},{default:l(()=>[t(ve,{class:"pa-0 text-center text-button"},{default:l(()=>[g(" Simulation ")]),_:1}),t(re,{class:"py-0"},{default:l(()=>[t(le,R({"thumb-color":d.color||"primary",class:"mx-1 py-2"},e.simulationTimeSettings,{modelValue:o.simulation.time,"onUpdate:modelValue":s[0]||(s[0]=c=>o.simulation.time=c)}),null,16,["thumb-color","modelValue"])]),_:1})]),_:1},8,["color"])]))}}),Rl={class:"text-button",style:{"font-size":"9px !important"}},Nl=z({__name:"ProjectController",setup(h){const d=te(),e=Ue(),o=$(()=>d.currentSimulator.stores.projectStore),s=$(()=>o.value.state.project),c=$(()=>JSON.stringify(s.value.toJSON(),null,2)),u=[{id:"network",icon:{class:"",icon:"network:network"},title:"Edit network"},{id:"kernel",icon:{class:"",icon:"mdi:mdi-engine-outline"},title:"Edit kernel"},{id:"raw",icon:{class:"",icon:"mdi:mdi-code-json"},show:"dev",title:"View raw data"},{id:"code",icon:{icon:"mdi:mdi-xml",class:""},title:"Edit code"},{id:"activity",icon:{class:"mdi-flip-v",icon:"mdi:mdi-border-style"},title:"Configure activity"},{id:"stats",icon:{class:"",icon:"mdi:mdi-table-large"},title:"View statistics"}],r=[tl()];dt()&&r.push(Ct);const a=()=>{D(()=>window.dispatchEvent(new Event("resize")))},n=f=>{o.value.state.bottomNav.height=window.innerHeight-f.clientY},m=()=>{e.state.resizing=!1,window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",m),a()},_=f=>{o.value.state.controller.width=window.innerWidth-f.clientX-64},C=()=>{e.state.resizing=!1,window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",C),a()},y=()=>{e.state.resizing=!0,window.addEventListener("mousemove",n),window.addEventListener("mouseup",m)},V=()=>{e.state.resizing=!0,window.addEventListener("mousemove",_),window.addEventListener("mouseup",C)},j=()=>{o.value.state.bottomNav.active=!o.value.state.bottomNav.active};return(f,Q)=>(i(),v(b,null,[t(me,{class:"d-print-none full-height",location:"right",permanent:"",rail:""},{append:l(()=>[t(A,{align:"center",class:"my-1",justify:"center","no-gutters":""},{default:l(()=>[t(w,{icon:o.value.state.bottomNav.active?"mdi:mdi-arrow-expand-down":"mdi:mdi-arrow-expand-up",onClick:Q[0]||(Q[0]=U(E=>j(),["stop"])),value:"code",variant:"plain"},null,8,["icon"])]),_:1})]),default:l(()=>[t(T,{"model-value":o.value.state.controller.view,class:"px-0 text-center",color:"primary",density:"compact"},{default:l(()=>[(i(),v(b,null,x(u,(E,ue)=>ge(t(S,{key:ue,value:E.id,onClick:U(ce=>o.value.toggleController(E),["stop"]),class:"py-3 my-0 justify-center"},{default:l(()=>[t(N,{class:F(E.icon.class),icon:E.icon.icon,size:"large"},null,8,["class","icon"]),P("span",Rl,k(E.id),1)]),_:2},1032,["value","onClick"]),[[je,E.show!=="dev"||E.show==="dev"&&I(d).state.devMode]])),64))]),_:1},8,["model-value"])]),_:1}),t(me,{"model-value":o.value.state.controller.open,style:oe({transition:I(e).state.resizing?"initial":""}),width:o.value.state.controller.width,onTransitionend:Q[2]||(Q[2]=E=>a()),class:"d-print-none",location:"right",permanent:""},{default:l(()=>[P("div",{onMousedown:Q[1]||(Q[1]=E=>V()),class:"resize-handle left"},null,32),(i(),v("div",{key:o.value.state.projectId},[o.value.state.controller.view==="network"?L(f.$slots,"network",{key:0},()=>[t($l,{network:s.value.network},{model:l(()=>[L(f.$slots,"model",{},void 0,!0)]),nodes:l(()=>[L(f.$slots,"nodes",{},void 0,!0)]),_:3},8,["network"])],!0):o.value.state.controller.view==="kernel"?L(f.$slots,"simulationKernel",{key:1},()=>[t(Sl,{simulation:s.value.simulation},null,8,["simulation"])],!0):I(d).state.devMode&&o.value.state.controller.view==="raw"?(i(),p(I(ut),{key:2,extensions:r,"model-value":c.value,disabled:"",style:{"font-size":"0.75rem",width:"100%"}},null,8,["model-value"])):o.value.state.controller.view==="code"?L(f.$slots,"simulationCodeEditor",{key:3},()=>[t(bt,{simulation:s.value.simulation},null,8,["simulation"])],!0):o.value.state.controller.view==="activity"?L(f.$slots,"activityController",{key:4},()=>[t(Mt,{graph:s.value.activityGraph.activityChartGraph},null,8,["graph"])],!0):o.value.state.controller.view==="stats"?(i(),p(Cl,{key:5,activities:s.value.activities},null,8,["activities"])):O("",!0)]))]),_:3},8,["model-value","style","width"]),t(ct,{active:o.value.state.bottomNav.active,height:o.value.state.bottomNav.height,style:oe({transition:I(e).state.resizing?"initial":""}),onTransitionend:Q[4]||(Q[4]=E=>a()),location:"bottom"},{default:l(()=>[P("div",{onMousedown:Q[3]||(Q[3]=E=>y()),class:"resize-handle bottom"},null,32),L(f.$slots,"simulationCodeMirror",{},()=>[t(Vt,{simulation:s.value.simulation},null,8,["simulation"])],!0)]),_:3},8,["active","height","style"])],64))}}),Hl=Ae(Nl,[["__scopeId","data-v-b47cd842"]]),zl=z({__name:"ProjectMenu",props:{project:{}},setup(h){const d=Le(),e=mt(),o=te(),s=h,c=$(()=>s.project),u=$(()=>o.currentSimulator.stores.projectDBStore),r=[{icon:"mdi:mdi-pencil",onClick:()=>{u.value.loadProject(c.value),D(()=>{c.value.state.state.editMode=!0})},title:"Rename"},{icon:"mdi:mdi-content-save-outline",onClick:()=>{u.value.loadProject(c.value),D(()=>{u.value.saveProject(c.value)})},title:"Save"},{icon:"mdi:mdi-reload",onClick:()=>{u.value.reloadProject(c.value)},title:"Reload"},{icon:"mdi:mdi-power",onClick:()=>{u.value.unloadProject(c.value)},title:"Unload"},{icon:"mdi:mdi-content-duplicate",id:"projectDuplicate",onClick:()=>{const a=u.value.duplicateProject(c.value);e.path.endsWith(a.id)||d.push({name:o.state.simulator+"NetworkEditor",params:{projectId:a.id}})},title:"Duplicate"},{icon:"mdi:mdi-download",onClick:()=>u.value.exportProject(c.value),title:"Download"},{icon:"mdi:mdi-trash-can-outline",onClick:()=>pt({text:"Are you sure to delete it?",title:"Delete project"}).then(a=>{a&&u.value.deleteProject(c.value)}),title:"Delete"}];return(a,n)=>(i(),p(M,{activator:"parent"},{default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(r,(m,_)=>t(S,{key:_,value:_,onClick:m.onClick},{prepend:l(()=>[t(N,{icon:m.icon},null,8,["icon"])]),default:l(()=>[t(H,null,{default:l(()=>[g(k(m.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:1})]),_:1}))}}),Il={key:0,class:"mx-1"},jl={key:1,class:"mx-1"},Tl=z({__name:"ProjectNav",setup(h){const d=Le(),e=te(),o=Ue(),s=$(()=>e.currentSimulator.stores.projectDBStore),c=$(()=>s.value.state.projects.filter(V=>V.name.toLocaleLowerCase().includes(u.value?u.value.toLocaleLowerCase():""))),u=Ne(""),r=[{title:"Import",icon:"mdi:mdi-import",id:"import-dialog",onClick:()=>{q({title:"",text:"",customComponent:{component:Rt,props:{}},dialogOptions:{width:"1280px"}})}},{title:"Export",icon:"mdi:mdi-export",id:"export-dialog",onClick:()=>{q({title:"",text:"",customComponent:{component:Nt,props:{}},dialogOptions:{width:"1280px"}})}},{title:"Delete",icon:"mdi:mdi-trash-can-outline",id:"delete-dialog",onClick:()=>{q({title:"",text:"",customComponent:{component:Ot,props:{store:s.value}},dialogOptions:{width:"1280px"}})}},{title:"Reload list",icon:"mdi:mdi-reload",onClick:()=>s.value.updateList()}],a=()=>{q({title:"",text:"",customComponent:{component:xt,props:{title:"Create project",modelValue:"new_project_"+s.value.state.projects.length}}}).then(V=>{V&&d.push({name:e.state.simulator+"ProjectAdd",query:{name:V}})})},n=()=>{D(()=>window.dispatchEvent(new Event("resize")))},m=V=>{o.state.width=V.clientX-64},_=()=>{o.state.resizing=!1,window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",_),n()},C=()=>{o.state.resizing=!0,window.addEventListener("mousemove",m),window.addEventListener("mouseup",_)},y=V=>{V.state.state.editMode=!1,s.value.saveProject(V)};return(V,j)=>(i(),p(me,{"model-value":I(o).state.open,style:oe({transition:I(o).state.resizing?"initial":""}),width:I(o).state.width,onTransitionend:j[5]||(j[5]=f=>n()),class:"d-print-none",permanent:""},{default:l(()=>[P("div",{onMousedown:j[0]||(j[0]=f=>C()),class:"resize-handle"},null,32),t(K,{class:"fixed-bar",color:"nest-project",density:"compact",extended:"","extension-height":"36"},{extension:l(()=>[t(vt,{onClick:j[2]||(j[2]=f=>a()),class:"ms-4",color:"primary",icon:"mdi:mdi-plus",location:"bottom left",size:"40",absolute:"",offset:"",title:"Create a new project"}),t(A,{class:"mx-4 text-subtitle-2","no-gutters":""},{default:l(()=>[t(G),g(" "+k(c.value.length)+" projects ",1)]),_:1})]),default:l(()=>[t(Pe,{class:"mx-1",clearable:"",density:"compact","hide-details":"",placeholder:"Search project","prepend-inner-icon":"mdi:mdi-magnify","single-line":"",modelValue:u.value,"onUpdate:modelValue":j[1]||(j[1]=f=>u.value=f),variant:"outlined"},null,8,["modelValue"]),t(M,null,{activator:l(({props:f})=>[t(w,R({icon:"mdi:mdi-dots-vertical",size:"small"},f),null,16)]),default:l(()=>[t(T,{density:"compact"},{default:l(()=>[(i(),v(b,null,x(r,(f,Q)=>t(S,{id:f.id,key:Q,value:Q,onClick:E=>f.onClick()},{prepend:l(()=>[t(N,{icon:f.icon},null,8,["icon"])]),default:l(()=>[t(H,null,{default:l(()=>[g(k(f.title),1)]),_:2},1024)]),_:2},1032,["id","value","onClick"])),64))]),_:1})]),_:1})]),_:1}),(i(),p(T,{key:c.value.length,class:"pt-0",density:"compact",lines:"two",nav:""},{default:l(()=>[t(ft,{title:"Projects",inset:""}),(i(!0),v(b,null,x(c.value.slice().reverse(),(f,Q)=>(i(),p(yt,null,{default:l(({isHovering:E,props:ue})=>{var ce,we,Ce;return[(i(),p(S,R({key:Q,to:{name:I(e).state.simulator+"Project",params:{projectId:f.id}},ripple:!((ce=f.state)!=null&&ce.editMode),ref_for:!0},ue),Me({_:2},[(we=f.state)!=null&&we.editMode?void 0:{name:"append",fn:l(()=>{var Z,be,Ve;return[f.doc?(i(),p(w,{key:0,onClick:U(Ql=>y(f),["prevent"]),disabled:!((Z=f.state)!=null&&Z.changes),color:(be=f.state)!=null&&be.changes?"red":"primary",icon:(Ve=f.state)!=null&&Ve.changes?"mdi:mdi-content-save-outline":"mdi:mdi-check",size:"x-small",variant:"text"},null,8,["onClick","disabled","color","icon"])):O("",!0),t(w,{color:E?"primary":"transparent",onClick:j[3]||(j[3]=U(()=>{},["prevent"])),icon:"",size:"x-small",variant:"text"},{default:l(()=>[t(N,{icon:"mdi:mdi-dots-vertical"}),t(zl,{project:f},null,8,["project"])]),_:2},1032,["color"])]}),key:"0"},(Ce=f.state)!=null&&Ce.editMode?{name:"default",fn:l(()=>[t(Pe,{onClick:j[4]||(j[4]=U(()=>{},["prevent"])),"onClick:appendInner":Z=>y(f),"onUpdate:modelValue":[Z=>f.state.state.changes=!0,Z=>f.name=Z],"append-inner-icon":"mdi:mdi-content-save-edit-outline",autofocused:"",class:"pt-2",density:"compact","hide-details":"",label:"Project name",modelValue:f.name,variant:"outlined"},null,8,["onClick:appendInner","onUpdate:modelValue","modelValue"])]),key:"1"}:I(e).state.devMode?{name:"default",fn:l(()=>[t(H,null,{default:l(()=>[g(k(f.name||"undefined project "+s.value.getProjectIdx(f)),1)]),_:2},1024),t(Se,null,{default:l(()=>[f.id?(i(),v("span",Il,k(I(Re)(f.id)),1)):O("",!0),f.doc?(i(),v("span",jl,k(I(Re)(f.docId)),1)):O("",!0)]),_:2},1024)]),key:"2"}:{name:"default",fn:l(()=>[t(H,null,{default:l(()=>[g(k(f.name||"undefined project "+s.value.getProjectIdx(f)),1)]),_:2},1024),t(Se,null,{default:l(()=>[g(k(f.network.nodes.length)+" nodes, "+k(f.network.connections.length)+" connections ",1)]),_:2},1024)]),key:"3"}]),1040,["to","ripple"]))]}),_:2},1024))),256))]),_:1}))]),_:1},8,["model-value","style","width"]))}}),Yl=Ae(Tl,[["__scopeId","data-v-8879e301"]]);export{Yl as P,ie as _,Lt as a,Zl as b,Mt as c,Hl as d,Xt as e};
