import{a as oe,_ as le,b as ae,c as se,d as ne}from"./DialogTextField-CIn-asOA.js";import{d as j,u as U,N as S,o as a,n as _,w as t,a as e,bj as D,c as m,r as V,F as p,c6 as ie,l as L,f as C,t as w,cO as re,v as z,cP as de,c7 as ue,e as N,b as I,s as $,K,i as A,cK as Q,g as b,x as W,q as O,aV as F,b$ as Y,O as ce,cD as me,V as P,cQ as G,cR as J,ck as pe,h as Z,j as ee,cS as ve,cT as fe,M as _e,cU as we,cf as q,y as ye,A as he,ct as ke,m as H,cM as ge,p as xe,cV as Ve,cW as Ce,aY as Se,cC as R}from"./index-DCXcuAJz.js";import{_ as Me}from"./ModelParamEditor-Cooob83e.js";import{a as be,_ as $e}from"./ImportDialog-1H8cn1XC.js";const Ee={class:"text-no-wrap"},Pe=j({__name:"ModelBar",setup(g){const k=U(),i=S(()=>k.currentSimulator.stores.modelStore),l=[{icon:"mdi:mdi-chart-scatter-plot",id:"modelExplorer",label:"Explore",title:"Explore activity",to:{name:"ModelExplorer"}},{icon:"mdi:mdi-pencil",id:"modelEditor",label:"Edit",title:"Edit activity",to:{name:"ModelEditor"}}];return(y,c)=>(a(),_(de,{class:"d-print-none",flat:"",height:"48"},{default:t(()=>[e(ie,{stacked:""},{default:t(()=>[D(y.$slots,"prependTabs"),(a(),m(p,null,V(l,(u,s)=>D(y.$slots,u.id,{},()=>[(a(),_(ue,{key:s,title:u.title,to:{name:N(k).state.simulator+u.to.name,params:{modelId:i.value.state.modelId}},size:"small"},{default:t(()=>[e(I,{icon:u.icon},null,8,["icon"]),$("span",Ee,w(u.label),1)]),_:2},1032,["title","to"]))])),64)),D(y.$slots,"appendTabs")]),_:3}),e(L),e(re,null,{default:t(()=>[C(w(i.value.state.modelId),1)]),_:1}),e(L),D(y.$slots,"prependBtn"),i.value.state.project?(a(),_(oe,{key:0,disabled:!i.value.model.isNeuron,simulation:i.value.state.project.simulation,"onClick:simulate":c[0]||(c[0]=u=>i.value.startSimulation())},null,8,["disabled","simulation"])):z("",!0)]),_:3}))}}),ze={class:"text-medium-emphasis"},Be=j({__name:"ModelParamViewer",props:["param"],setup(g){return(k,i)=>(a(),_(A,null,{default:t(()=>[e(K,{"no-gutters":""},{default:t(()=>[$("span",ze,w(g.param.label),1),e(L),C(" "+w(g.param.id)+": "+w(g.param.value)+" "+w(g.param.unit),1)]),_:1})]),_:1}))}}),Te={class:"text-button",style:{"font-size":"9px !important"}},De=j({__name:"ModelController",setup(g){const k=U(),i=Q(),l=S(()=>k.currentSimulator.stores.modelStore),y=S(()=>Object.values(l.value.model.params)),c=[{id:"defaults",icon:"mdi:mdi-format-list-numbered-rtl",title:"View defaults"},{id:"params",icon:"mdi:mdi-tune-variant",title:"Edit params"},{id:"code",icon:"mdi:mdi-xml"}],u=()=>{const h=l.value.state.project.network.nodes.neurons[0],n=l.value.model.params;h.paramsVisible.forEach(v=>{n[v].value=h.params[v].value})},s=()=>{F(()=>window.dispatchEvent(new Event("resize")))},f=x=>{l.value.state.controller.width=window.innerWidth-x.clientX-64},B=()=>{i.state.resizing=!1,window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",B),s()},M=()=>{i.state.resizing=!0,window.addEventListener("mousemove",f),window.addEventListener("mouseup",B)};return(x,h)=>(a(),m(p,null,[e(W,{location:"right",permanent:"",rail:""},{default:t(()=>[e(b,{"model-value":l.value.state.controller.view,class:"px-0 text-center",color:"primary",density:"compact"},{default:t(()=>[(a(),m(p,null,V(c,(n,v)=>e(A,{disabled:!l.value.model.isNeuron&&n.id==="code",key:v,value:n.id,onClick:Y(T=>l.value.toggleController(n),["stop"]),class:"py-3 my-0 justify-center"},{default:t(()=>[e(I,{icon:n.icon,size:"large"},null,8,["icon"]),$("span",Te,w(n.id),1)]),_:2},1032,["disabled","value","onClick"])),64))]),_:1},8,["model-value"])]),_:1}),e(W,{"model-value":l.value.state.controller.open,width:l.value.state.controller.width,onTransitionend:h[2]||(h[2]=n=>s()),location:"right",permanent:""},{default:t(()=>[$("div",{onMousedown:h[0]||(h[0]=n=>M()),class:"resize-handle left"},null,32),l.value.state.controller.view==="defaults"?(a(),m(p,{key:0},[e(O,{color:"transparent",density:"compact",title:"Model parameter defaults"}),e(b,null,{default:t(()=>[(a(!0),m(p,null,V(y.value,(n,v)=>(a(),_(Be,{key:v,param:n},null,8,["param"]))),128))]),_:1})],64)):z("",!0),l.value.state.controller.view==="params"?(a(),m(p,{key:1},[l.value.model.isNeuron?(a(),m(p,{key:0},[e(O,{color:"transparent",density:"compact",title:"Model parameter for simulation"}),(a(!0),m(p,null,V(l.value.state.project.network.nodes.neurons,(n,v)=>(a(),_(ce,{key:v,flat:""},{default:t(()=>[n.paramsVisible.length>0?(a(),_(b,{key:n.modelId},{default:t(()=>[(a(!0),m(p,null,V(n.paramsVisible,(T,r)=>(a(),_(le,{key:r,param:n.params[T]},null,8,["param"]))),128))]),_:2},1024)):z("",!0),e(me,null,{default:t(()=>[e(P,{onClick:h[1]||(h[1]=T=>u())},{default:t(()=>[C("set param values as defaults")]),_:1})]),_:1})]),_:2},1024))),128))],64)):(a(),m(p,{key:1},[e(O,{color:"transparent",density:"compact",title:"Default values of model parameters"}),e(b,null,{default:t(()=>[(a(!0),m(p,null,V(y.value,(n,v)=>(a(),_(Me,{key:v,param:n},null,8,["param"]))),128))]),_:1})],64))],64)):z("",!0),l.value.state.controller.view==="code"?D(x.$slots,"simulationCodeEditor",{key:2},()=>[l.value.state.project?(a(),_(ae,{key:0,simulation:l.value.state.project.simulation},null,8,["simulation"])):z("",!0)],!0):z("",!0)]),_:3},8,["model-value","width"])],64))}}),Ue=G(De,[["__scopeId","data-v-5473905d"]]),Ne=j({__name:"ModelMenu",props:{model:{}},setup(g){const k=U(),i=J(),l=pe(),y=g,c=S(()=>y.model),u=S(()=>k.currentSimulator.stores.modelDBStore),s=[{icon:"mdi:mdi-content-save-outline",onClick:()=>{u.value.saveModel(c.value)},title:"Save"},{icon:"mdi:mdi-content-duplicate",id:"modelDuplicate",onClick:()=>{const f=u.value.duplicateModel(c.value);l.path.endsWith(f.id)||i.push({name:k.state.simulator+"ModelEditor",params:{modelId:f.id}})},title:"Duplicate"},{icon:"mdi:mdi-download",onClick:()=>u.value.exportModel(c.value),title:"Download"},{icon:"mdi:mdi-trash-can-outline",onClick:()=>ve({text:"Are you sure to delete it?",title:"Delete model"}).then(f=>{f&&u.value.deleteModel(c.value)}),title:"Delete"}];return(f,B)=>(a(),_(Z,{activator:"parent"},{default:t(()=>[e(b,{density:"compact"},{default:t(()=>[(a(),m(p,null,V(s,(M,x)=>e(A,{key:x,value:x,onClick:M.onClick},{prepend:t(()=>[e(I,{icon:M.icon},null,8,["icon"])]),default:t(()=>[e(ee,null,{default:t(()=>[C(w(M.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:1})]),_:1}))}}),Le={class:"text-subtitle-2"},Ie=j({__name:"ModelNav",setup(g){const k=J(),i=U(),l=Q(),y=S(()=>i.currentSimulator.stores.modelStore),c=S(()=>i.currentSimulator.stores.modelDBStore),u=S(()=>{let r=[];s.source==i.currentSimulator.id?r=y.value.state.models:(r=c.value.state.models,s.source==="custom"&&(r=r.filter(o=>o.custom))),s.search&&(r=r.filter(o=>o.label.toLocaleLowerCase().includes(s.search?s.search.toLocaleLowerCase():""))),s.elementType&&(r=r.filter(o=>o.elementType===s.elementType));const d="id";return r.sort((o,E)=>fe(o[d],E[d],s.orderByAsc)),r}),s=_e({elementType:"",orderByAsc:!0,search:"",source:"installed"}),f=["installed","custom",i.currentSimulator.id],B=["neuron","recorder","stimulator","synapse"],M=[{title:"Import",icon:"mdi:mdi-import",id:"import-dialog",onClick:()=>{R({title:"",text:"",customComponent:{component:be,props:{}},dialogOptions:{width:"1280px"}})}},{title:"Export",icon:"mdi:mdi-export",id:"export-dialog",onClick:()=>{R({title:"",text:"",customComponent:{component:$e,props:{project:!1}},dialogOptions:{width:"1280px"}})}},{title:"Delete",icon:"mdi:mdi-trash-can-outline",id:"delete-dialog",onClick:()=>{R({title:"",text:"",customComponent:{component:ne,props:{store:c.value}},dialogOptions:{width:"1280px"}})}}],x=()=>{R({title:"",text:"",customComponent:{component:se,props:{title:"Create model",modelValue:"new model "+c.value.state.models.length}}}).then(r=>{if(r){let d=r;const o=c.value.newModel({id:d.replaceAll(" ","_"),label:r});F(()=>{k.push({name:i.state.simulator+"ModelEditor",params:{modelId:o.id}})})}})},h=()=>{F(()=>window.dispatchEvent(new Event("resize")))},n=r=>{l.state.width=r.clientX-64},v=()=>{l.state.resizing=!1,window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",v)},T=()=>{l.state.resizing=!0,window.addEventListener("mousemove",n),window.addEventListener("mouseup",v)};return(r,d)=>(a(),_(W,{"model-value":N(l).state.open,style:Se({transition:N(l).state.resizing?"initial":""}),width:N(l).state.width,onTransitionend:d[6]||(d[6]=o=>h()),permanent:""},{default:t(()=>[$("div",{onMousedown:T,class:"resize-handle"},null,32),e(O,{class:"fixed-bar",color:"nest-model",density:"compact",extended:"","extension-height":"36"},{extension:t(()=>[e(we,{onClick:d[1]||(d[1]=o=>x()),class:"ms-4",color:"primary",icon:"mdi:mdi-plus",location:"bottom left",size:"40",absolute:"",offset:"",title:"Create a new model"}),e(K,{class:"ma-2","no-gutters":""},{default:t(()=>[e(L),e(q,{onClick:d[2]||(d[2]=o=>s.source=f[(f.indexOf(s.source)+1)%f.length]),class:"mx-1",density:"compact","prepend-icon":"mdi:mdi-filter-variant",title:"source of the models"},{default:t(()=>[C(w(s.source),1)]),_:1}),e(q,{"prepend-icon":"mdi:mdi-order-alphabetical-"+(s.orderByAsc?"ascending":"descending"),onClick:d[3]||(d[3]=o=>s.orderByAsc=!s.orderByAsc),class:"mx-1",density:"compact",title:"order by"},{default:t(()=>[C(" sort ")]),_:1},8,["prepend-icon"]),e(L),$("span",Le,[C(w(u.value.length)+" model",1),ye($("span",null,"s",512),[[he,u.value.length>1]])])]),_:1})]),default:t(()=>[e(ke,{class:"mx-1",clearable:"",density:"compact","hide-details":"",placeholder:"Search model","prepend-inner-icon":"mdi:mdi-magnify","single-line":"",modelValue:s.search,"onUpdate:modelValue":d[0]||(d[0]=o=>s.search=o),variant:"outlined"},null,8,["modelValue"]),e(Z,null,{activator:t(({props:o})=>[e(P,H({icon:"mdi:mdi-dots-vertical",size:"small"},o),null,16)]),default:t(()=>[e(b,{density:"compact"},{default:t(()=>[(a(),m(p,null,V(M,(o,E)=>e(A,{key:E,value:E,onClick:X=>o.onClick()},{prepend:t(()=>[e(I,{icon:o.icon},null,8,["icon"])]),default:t(()=>[e(ee,null,{default:t(()=>[C(w(o.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:1})]),_:1})]),_:1}),e(b,{class:"pt-0",density:"compact",lines:"two",nav:""},{default:t(()=>[e(ge,{class:"pa-0",inset:"",style:{"margin-left":"-28px"}},{default:t(()=>[e(xe,{density:"compact",style:{height:"24px"},modelValue:s.elementType,"onUpdate:modelValue":d[4]||(d[4]=o=>s.elementType=o)},{default:t(()=>[(a(),m(p,null,V(B,o=>e(P,{key:o,value:o,size:"x-small",style:{"font-size":"9px"}},{default:t(()=>[C(w(o),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(Ve,{items:u.value},{default:t(({item:o})=>[e(Ce,null,{default:t(({isHovering:E,props:X})=>[e(A,H({subtitle:o.elementType,title:o.label||o.id,to:{name:N(i).state.simulator+"Model",params:{modelId:o.id}}},X),{append:t(()=>[e(P,{color:E?"primary":"transparent",onClick:d[5]||(d[5]=Y(te=>te.preventDefault(),["stop"])),class:"list-item-menu",icon:"",size:"x-small",variant:"text"},{default:t(()=>[e(I,{icon:"mdi:mdi-dots-vertical"}),e(Ne,{model:o},null,8,["model"])]),_:2},1032,["color"])]),_:2},1040,["subtitle","title","to"])]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1},8,["model-value","style","width"]))}}),We=G(Ie,[["__scopeId","data-v-d92dc207"]]);export{We as M,Pe as _,Ue as a};
