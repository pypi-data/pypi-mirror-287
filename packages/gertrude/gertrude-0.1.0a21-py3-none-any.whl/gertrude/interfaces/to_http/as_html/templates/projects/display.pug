//- Gertrude --- GTD done right
//- Copyright Â© 2023 Tanguy Le Carrour <tanguy@bioneland.org>
//-
//- This program is free software: you can redistribute it and/or modify
//- it under the terms of the GNU Affero General Public License as
//- published by the Free Software Foundation, either version 3 of the
//- License, or (at your option) any later version.
//-
//- This program is distributed in the hope that it will be useful,
//- but WITHOUT ANY WARRANTY; without even the implied warranty of
//- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//- GNU Affero General Public License for more details.
//-
//- You should have received a copy of the GNU Affero General Public License
//- along with this program. If not, see <http://www.gnu.org/licenses/>.

extends layout

block title
  title= project.name

block content
  section.section
    .container.project
      h1.title.is-3= project.name

      block tasks
        #tasks(
          hx-get=url_for("projects.display", id=project.id)
          hx-trigger="TasksChanged from:body delay:100ms"
          hx-disinherit="*"
        )
            if tasks
              h2.title.is-4= _("pages-projects-display-actionable-tasks-title")
              if actionable_tasks
                .box
                  ul
                    each task in actionable_tasks
                      li.link: a(
                        href=url_for("tasks.display", id=task.id)
                        title=_("pages-mixins-list-of-tasks-display-title")
                      )
                        span= task.title
                        if task.project_short_name
                          span.tag.is-info.is-light.ml-1= task.project_short_name
              else
                article.message.is-info: .message-body: p= _("pages-projects-display-actionable-tasks-empty")

              h2.title.is-4= _("pages-projects-display-incubated-tasks-title")
              if incubated_tasks
                .box
                  ul
                    each task in incubated_tasks
                      li.link: a(
                        href=url_for("tasks.display", id=task.id)
                        title=_("pages-mixins-list-of-tasks-display-title")
                      )
                        span= task.title
                        if task.project_short_name
                          span.tag.is-info.is-light.ml-1= task.project_short_name
              else
                article.message.is-info: .message-body: p= _("pages-projects-display-incubated-tasks-empty")
            else
                article.message.is-success: .message-body!= _("pages-projects-display-nothing-to-do-html")

            h2.title.is-4= _("pages-projects-display-done-tasks-title")
            if done_tasks
              .box
                ul
                  each task in done_tasks
                    li.link: a(
                      href=url_for("tasks.display", id=task.id)
                      title=_("pages-mixins-list-of-tasks-display-title")
                    )
                      span= task.title
                      if task.project_short_name
                        span.tag.is-info.is-light.ml-1= task.project_short_name
            else
              article.message: .message-body: p= _("pages-projects-display-done-tasks-empty")
