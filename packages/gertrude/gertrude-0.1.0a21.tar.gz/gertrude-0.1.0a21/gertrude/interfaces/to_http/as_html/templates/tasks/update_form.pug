//- Gertrude --- GTD done right
//- Copyright Â© 2024 Tanguy Le Carrour <tanguy@bioneland.org>
//-
//- This program is free software: you can redistribute it and/or modify
//- it under the terms of the GNU Affero General Public License as
//- published by the Free Software Foundation, either version 3 of the
//- License, or (at your option) any later version.
//-
//- This program is distributed in the hope that it will be useful,
//- but WITHOUT ANY WARRANTY; without even the implied warranty of
//- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//- GNU Affero General Public License for more details.
//-
//- You should have received a copy of the GNU Affero General Public License
//- along with this program. If not, see <http://www.gnu.org/licenses/>.

form(
  hx-post=url_for("tasks.update", id=values.id)
  hx-target="this"
  hx-swap="outerHTML settle:0.5s"
)
  input(type="hidden" name="csrf_token" value=generate_csrf_token())

  if errors.task_id
    article.message.is-danger
      p.message-body #[code task_id] #{errors.task_id}

  .field
    p.control.is-expanded
      input.input(
        type="text"
        name="title"
        placeholder=_("pages-tasks-capture-title-placeholder")
        value=values.title
        maxlength=max.title
        required
        autofocus
      )
      if errors.title
        small.help.is-danger= errors.title

  .field
    p.control.is-expanded
      textarea.textarea(
        name="description"
        placeholder=_("pages-tasks-capture-description-placeholder")
        maxlength=max.description
      )= values.description
    if errors.description
      small.help.is-danger= errors.description

  .field.is-grouped
    .control: button.button.is-success(type="submit")
      span.icon: i.fas.fa-edit
      span=_("pages-tasks-update-submit")
    .control
      a.button(hx-get=url_for("tasks.display_details", id=values.id) hx-target="#details" hx-swap="innerHTML")
        span.icon: i.fas.fa-ban(aria-hidden="true")
        span= _("pages-tasks-schedule-cancel")

if errors.other
  article.message.is-danger
    p.message-body= errors.other
