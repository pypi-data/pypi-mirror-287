import{H as I,J as y,K as P,r as c,j as e,g as j,I as m,c as R,u as f,ay as B,i as F,aw as L,ax as u,z as b,aC as T,aD as _,aE as $,aF as k}from"./index-Bp2ZNQly.js";import{D as J,a as A,b as U,c as H}from"./index-v_3C9bKy.js";import{P as z}from"./index-BU7XzTTW.js";import{S as q}from"./index-Brr_55To.js";import{D as G}from"./index-CQDuuTls.js";import{N as K}from"./index-D8wraVj5.js";import"./popover-Cu1XJFlQ.js";import"./index-DtDsy0Ro.js";import"./separator-a0keE0MJ.js";import"./index-D4wNn-1b.js";import"./input-B8OkafrL.js";import"./label-VsbKzK6O.js";import"./checkbox-CgVf3NF-.js";import"./shortcuts-CF3bxFwN.js";import"./index-BQt-x7mj.js";const Y=s=>{const{mutate:l}=I();return l(["useDeleteFolders"],async({folder_id:r})=>(await y.delete(`${P("FOLDERS")}/${r}`)).data,s)};function Q({firstButtonName:s,onFirstBtnClick:l,options:a,plusButton:n=!1,dropdownOptions:r=!0}){const[i,d]=c.useState(!1);return e.jsx("div",{children:e.jsxs(J,{open:i,children:[e.jsx(A,{asChild:!0,children:e.jsxs(j,{id:"new-project-btn",variant:"primary",className:"relative"+r?"pl-[12px]":"pl-[12px] pr-10",onClick:o=>{o.stopPropagation(),o.preventDefault(),l()},children:[n&&e.jsx(m,{name:"Plus",className:"main-page-nav-button"}),s,r&&e.jsx("div",{className:"absolute right-2 items-center text-muted-foreground",onClick:o=>{o.stopPropagation(),o.preventDefault(),d(!i)},children:i?e.jsx(m,{name:"ChevronUp"}):e.jsx(m,{name:"ChevronDown"})})]})}),e.jsx(U,{onPointerDownOutside:o=>{o.stopPropagation(),o.preventDefault(),d(!i)},children:a.map(({name:o,onBtnClick:h},p)=>e.jsx(H,{onClick:h,children:o},p))})]})})}const V=({openModal:s,setOpenModal:l,openDeleteFolderModal:a,setOpenDeleteFolderModal:n,handleDeleteFolder:r})=>e.jsxs(e.Fragment,{children:[s&&e.jsx(K,{open:s,setOpen:l}),a&&e.jsx(G,{open:a,setOpen:n,onConfirm:()=>{r(),n(!1)},description:"folder",note:"Deleting the selected folder will remove all associated flows and components.",children:e.jsx(j,{variant:"ghost",size:"icon",className:"whitespace-nowrap",children:e.jsx(m,{"data-testid":"delete-folder",name:"Trash2",className:R("h-5 w-5")})})})]}),W=V,X=({uploadFlow:s,navigate:l,is_component:a})=>{const n=f(o=>o.setSuccessData),r=f(o=>o.setErrorData);return[...[{name:"Import from JSON",onBtnClick:()=>{s({newProject:!0,isComponent:a}).then(o=>{n({title:`${a?"Component":"Flow"} uploaded successfully`}),a||l("/flow/"+o)}).catch(o=>{r({title:B,list:[o]})})}}]]},Z=X;function he(){const s=F(t=>t.uploadFlow),l=F(t=>t.setCurrentFlowId),n=L().pathname,[r,i]=c.useState(!1),[d,o]=c.useState(!1),[h,p]=c.useState(!1),g=n==="/components",D=u(t=>t.setFolderToEdit),x=b(),C=f(t=>t.setSuccessData),S=f(t=>t.setErrorData),w=u(t=>t.folderToEdit),O=u(t=>t.myCollectionId),E=u(t=>t.getFoldersApi);c.useEffect(()=>{l("")},[n]);const N=Z({uploadFlow:s,navigate:x,is_component:g}),{mutate:v}=Y(),M=()=>{v({folder_id:w==null?void 0:w.id},{onSuccess:()=>{C({title:"Folder deleted successfully."}),k(O),E(!0),x("/all")},onError:t=>{console.error(t),S({title:"Error deleting folder."})}})};return e.jsxs(e.Fragment,{children:[e.jsx(z,{title:T,description:_,button:e.jsx("div",{className:"flex gap-2",children:e.jsx(Q,{firstButtonName:"New Project",onFirstBtnClick:()=>i(!0),options:N,plusButton:!0,dropdownOptions:!1})}),children:e.jsxs("div",{className:"flex h-full w-full space-y-8 md:flex-col lg:flex-row lg:space-x-8 lg:space-y-0",children:[e.jsx("aside",{className:"flex h-fit w-fit flex-col space-y-6",children:e.jsx(q,{items:[],handleChangeFolder:t=>{x(`all/folder/${t}`,{state:{folderId:t}})},handleEditFolder:t=>{D(t),o(!0)},handleDeleteFolder:t=>{D(t),p(!0)},className:"w-[20vw]"})}),e.jsx("div",{className:"relative h-full w-full flex-1",children:e.jsx($,{})})]})}),e.jsx(W,{openModal:r,setOpenModal:i,openDeleteFolderModal:h,setOpenDeleteFolderModal:p,handleDeleteFolder:M})]})}export{he as default};
