import{af as h,r as a,A as W,u as Z,i as k,au as ee,z as te,bf as _,bg as se,bh as ae,bi as le,bj as re,j as e,bk as oe,bl as ne,g as ie,c as de,I as K,v as O,S as ce,b8 as ue,av as pe}from"./index-Bp2ZNQly.js";import{I as me,C as xe,S as y}from"./index-2yPZc9YS.js";import{P as he}from"./index-BU7XzTTW.js";import{u as ge,T as be}from"./index-DxzqFyHp.js";import{P as fe}from"./index-CPW-JQrH.js";import{S as L,a as z,b as V,c as B,d as je,e as u}from"./select-BvkzWd6M.js";import"./index-DbuFANws.js";import"./index-DtDsy0Ro.js";import"./index-D3UShQdH.js";import"./input-B8OkafrL.js";import"./addNewVariableButton-DPqqa66L.js";import"./popover-Cu1XJFlQ.js";import"./index-CIF6BEC2.js";import"./label-VsbKzK6O.js";import"./index-CQDuuTls.js";import"./separator-a0keE0MJ.js";import"./checkbox-CgVf3NF-.js";import"./index-v_3C9bKy.js";import"./index-D4wNn-1b.js";import"./shortcuts-CF3bxFwN.js";import"./index-BQt-x7mj.js";import"./index-CT4pxyBt.js";function Me(){const c=h(t=>t.hasApiKey),l=h(t=>t.validApiKey),p=h(t=>t.loadingApiKey),g=h(t=>t.updateValidApiKey),{apiKey:D}=a.useContext(W),b=Z(t=>t.setErrorData),M=k(t=>t.setCurrentFlowId),q=k(t=>t.currentFlowId),[s,m]=a.useState(!0),{id:x}=ee(),[i,G]=a.useState([]),[f,Y]=a.useState(""),[o,C]=a.useState([]),[j,N]=a.useState(0),[v,A]=a.useState(12),[S,E]=a.useState(1),[I,Q]=a.useState("Popular"),[n,w]=a.useState("All"),[U,T]=a.useState(""),[d,F]=a.useState("all"),{isFetching:X,data:$}=ge(),H=te();a.useEffect(()=>{p||(c?l||b({title:_,list:[ae]}):(b({title:_,list:[se]}),m(!1)))},[p,l,c,q]),a.useEffect(()=>{J()},[n,I,S,v,i,d,l,c,D,U,p,x]);function J(){p||(m(!0),le({component_id:x,page:S,limit:v,is_component:n==="All"?null:n!=="Flows",sort:I==="Popular"?"-count(downloads)":"name",tags:i,liked:d==="likedbyme"&&l?!0:null,isPrivate:null,search:f===""?null:f,filterByUser:d==="createdbyme"&&l?!0:null}).then(t=>{var r;!(t!=null&&t.authorized)&&l===!0?(g(!1),F("all")):(t!=null&&t.authorized&&g(!0),m(!1),C((t==null?void 0:t.results)??[]),N((i==null?void 0:i.length)===0?Number((t==null?void 0:t.count)??0):((r=t==null?void 0:t.results)==null?void 0:r.length)??0))}).catch(t=>{var r,R;((r=t.response)==null?void 0:r.status)===403||((R=t.response)==null?void 0:R.status)===401?g(!1):(C([]),N(0),m(!1),b({title:re,list:[t.response.data.detail]}))}))}a.useEffect(()=>{M("")},[]);function P(){E(1),A(12)}return e.jsx(he,{betaIcon:!0,title:oe,description:ne,button:e.jsxs(ie,{"data-testid":"api-key-button-store",disabled:s,className:de(`${l?"":"animate-pulse border-error"}`,s?"cursor-not-allowed":""),variant:"primary",onClick:()=>{H("/settings/general/api")},children:[e.jsx(K,{name:"Key",className:"mr-2 w-4"}),"API Key"]}),children:e.jsxs("div",{className:"flex h-full w-full flex-col justify-between",children:[e.jsxs("div",{className:"flex w-full flex-col gap-4 p-0",children:[e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(me,{loading:s,divClasses:"relative h-12 w-[40%]",value:f,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&T(O.uniqueId())},onClick:()=>{T(O.uniqueId())}}),e.jsxs("div",{className:"ml-4 flex w-full gap-2 border-b border-border",children:[e.jsx("button",{"data-testid":"all-button-store",disabled:s,onClick:()=>{w("All")},className:(n==="All"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"All"}),e.jsx("button",{"data-testid":"flows-button-store",disabled:s,onClick:()=>{P(),w("Flows")},className:(n==="Flows"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Flows"}),e.jsx("button",{"data-testid":"components-button-store",disabled:s,onClick:()=>{P(),w("Components")},className:(n==="Components"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Components"}),e.jsx(ce,{content:"Coming Soon",children:e.jsx("button",{className:"cursor-not-allowed p-3 text-muted-foreground",children:"Bundles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(L,{disabled:s,onValueChange:F,value:d,children:[e.jsx(z,{className:"mr-4 w-[160px] flex-shrink-0",children:e.jsx(V,{placeholder:"Filter Values"})}),e.jsx(B,{children:e.jsxs(je,{children:[e.jsx(u,{value:"all",children:"All"}),e.jsx(u,{disabled:!c||!l,value:"createdbyme",children:"Created By Me"}),e.jsx(u,{disabled:!c||!l,value:"likedbyme",children:"Liked By Me"})]})})]}),x===void 0?e.jsx(be,{tags:$??[],loadingTags:X,disabled:s,selectedTags:i,setSelectedTags:G}):e.jsxs(ue,{variant:"outline",size:"sq",className:"gap-2 bg-beta-foreground text-background hover:bg-beta-foreground",children:[e.jsx(pe,{to:"/store",className:"cursor-pointer",children:e.jsx(K,{name:"X",className:"h-4 w-4"})}),x]},"id")]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:"px-0.5 text-sm text-muted-foreground",children:(!s||o.length!==0)&&e.jsxs(e.Fragment,{children:[j," ",j!==1?"results":"result"]})}),e.jsxs(L,{disabled:s,onValueChange:t=>{Q(t)},children:[e.jsx(z,{"data-testid":"select-order-store",children:e.jsx(V,{placeholder:"Popular"})}),e.jsxs(B,{children:[e.jsx(u,{value:"Popular",children:"Popular"}),e.jsx(u,{value:"Alphabetical",children:"Alphabetical"})]})]})]}),e.jsx("div",{className:"grid w-full gap-4 md:grid-cols-2 lg:grid-cols-3",children:!s||o.length!==0?o.map(t=>{var r;return e.jsx(e.Fragment,{children:e.jsx(xe,{data:t,authorized:l,disabled:s,playground:((r=t.last_tested_version)==null?void 0:r.includes("1.0.0"))&&!t.is_component},t.id)})}):e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx(y,{}),e.jsx(y,{})]})}),!s&&(o==null?void 0:o.length)===0&&e.jsx("div",{className:"mt-6 flex w-full items-center justify-center text-center",children:e.jsx("div",{className:"flex h-full w-full flex-col",children:e.jsx("div",{className:"flex w-full flex-col gap-4",children:e.jsx("div",{className:"grid w-full gap-4",children:d!="all"?e.jsxs(e.Fragment,{children:["You haven't"," ",d==="createdbyme"?"created":"liked"," ","anything with the selected filters yet."]}):e.jsxs(e.Fragment,{children:["There are no"," ",n=="Flows"?"Flows":"Components"," with the selected filters."]})})})})})]}),!s&&o.length>0&&e.jsx("div",{className:"relative py-6",children:e.jsx(fe,{storeComponent:!0,pageIndex:S,pageSize:v,totalRowsCount:j,paginate:(t,r)=>{E(r),A(t)}})})]})})}export{Me as default};
