"use strict";(self.webpackChunkfirebird=self.webpackChunkfirebird||[]).push([[9902],{9902:(k,M,x)=>{x.r(M),x.d(M,{TMultiGraphPainter:()=>T});var h=x(467),l=x(6998),H=x(9041),N=x(675),P=x(2953),O=x(4693);class p extends N.JW{constructor(i,r){super(i,r),this.firstpainter=null,this.autorange=!1,this.painters=[]}cleanup(){this.painters=[],super.cleanup()}updateObject(i){if(!this.matchObjectType(i))return!1;const r=this.getObject(),a=i.fGraphs,s=this.getPadPainter();r.fTitle=i.fTitle;let t=!1;if(this.firstpainter){let e=i.fHistogram;this.autorange&&!e&&(e=this.scanGraphsRange(a)),this.firstpainter.updateObject(e)&&(t=!0)}const n=Math.min(a.arr.length,this.painters.length);for(let e=0;e<n;++e)this.painters[e].updateObject(a.arr[e],a.opt[e])&&(t=!0);const f=i.fFunctions?.arr?.length??0;for(let e=0;e<f;++e){const c=i.fFunctions.arr[e],y=i.fFunctions.opt[e];c?._typename&&c?.fName&&s?.findPainterFor(null,c.fName,c._typename)?.updateObject(c,y)}return t}scanGraphsRange(i,r,a){const s=this.getObject(),t={xmin:0,xmax:0,ymin:0,ymax:0,first:!0};let n,f,e=!1,c=!1,y=!1,F="";a&&(e=a.fLogx,c=a.fLogy,t.xmin=a.fUxmin,t.xmax=a.fUxmax,t.ymin=a.fUymin,t.ymax=a.fUymax,t.first=!1),this._3d&&r&&!r.fXaxis.fLabels&&(r=null),r||(this.autorange=!0,i.arr[0]?.fHistogram?.fXaxis?.fTimeDisplay&&(y=!0,F=i.arr[0].fHistogram.fXaxis.fTimeFormat)),i.arr.forEach(m=>{if(0!==m.fNpoints){t.first&&(t.xmin=t.xmax=m.fX[0],t.ymin=t.ymax=m.fY[0],t.first=!1);for(let u=0;u<m.fNpoints;++u)t.xmin=Math.min(t.xmin,m.fX[u]),t.xmax=Math.max(t.xmax,m.fX[u]),t.ymin=Math.min(t.ymin,m.fY[u]),t.ymax=Math.max(t.ymax,m.fY[u])}}),t.xmin===t.xmax&&(t.xmax+=1),t.ymin===t.ymax&&(t.ymax+=1);const G=.05*(t.xmax-t.xmin),v=.05*(t.ymax-t.ymin);let g=t.xmin-G,d=t.xmax+G;c?(t.ymin<=0&&(t.ymin=.001*t.ymax),f=t.ymin/(1+.5*Math.log10(t.ymax/t.ymin)),n=t.ymax*(1+.2*Math.log10(t.ymax/t.ymin))):(f=t.ymin-v,n=t.ymax+v),f<0&&t.ymin>=0&&(f=0),n>0&&t.ymax<=0&&(n=0);const D=f,L=n;if(g<0&&t.xmin>=0&&(g=e?.9*t.xmin:0),d>0&&t.xmax<=0&&(d=e?1.1*t.xmax:0),s.fMinimum!==l.kNoZoom&&(t.ymin=f=s.fMinimum),s.fMaximum!==l.kNoZoom&&(t.ymax=n=s.fMaximum),f<0&&t.ymin>=0&&c&&(f=.9*t.ymin),n>0&&t.ymax<=0&&c&&(n=1.1*t.ymax),f<=0&&c&&(f=.001*n),!c&&f>0&&f<.05*n&&(f=0),g<=0&&e&&(g=d>1e3?1:.001*d),!r){let m,u;if(this._3d){m=(r=(0,l.createHistogram)(l.clTH2I,i.arr.length,10)).fXaxis,m.fXmin=0,m.fXmax=i.arr.length,m.fLabels=(0,l.create)(l.clTHashList);for(let o=0;o<i.arr.length;o++){const w=(0,l.create)(l.clTObjString);w.fString=i.arr[o].fTitle||`gr${o}`,w.fUniqueID=i.arr.length-o,m.fLabels.Add(w,"")}m=r.fYaxis,u=r.fZaxis}else m=(r=(0,l.createHistogram)(l.clTH1I,10)).fXaxis,u=r.fYaxis;if(r.fTitle=s.fTitle,r.fTitle.indexOf(";")>=0){const o=r.fTitle.split(";");r.fTitle=o[0],o[1]&&(m.fTitle=o[1]),o[2]&&(u.fTitle=o[2])}m.fXmin=g,m.fXmax=d,m.fTimeDisplay=y,y&&(m.fTimeFormat=F)}const A=this._3d?r.fZaxis:r.fYaxis;return A.fXmin=Math.min(f,D),A.fXmax=Math.max(n,L),r.fMinimum=f,r.fMaximum=n,r.fBits|=l.kNoStats,r}drawAxisHist(i,r){var a=this;return(0,h.A)(function*(){return P.N.draw(a.getDom(),i,r)})()}drawNextFunction(i){var r=this;return(0,h.A)(function*(){const a=r.getObject();return!a.fFunctions||i>=a.fFunctions.arr.length?r:r.getPadPainter().drawObject(r.getDom(),a.fFunctions.arr[i],a.fFunctions.opt[i]).then(()=>r.drawNextFunction(i+1))})()}drawGraph(i,r){var a=this;return(0,h.A)(function*(){return O.TGraphPainter.draw(a.getDom(),i,r)})()}drawNextGraph(i,r){var a=this;return(0,h.A)(function*(){const s=a.getObject().fGraphs;let t="";if(i>=s.arr.length)return a._pfc=a._plc=a._pmc=!1,a.drawNextFunction(0);const n=s.arr[i],f=s.opt[i]||r||"";if(a._pfc||a._plc||a._pmc){const e=a.getMainPainter();if((0,l.isFunc)(e?.createAutoColor)){const c=e.createAutoColor(s.arr.length);a._pfc&&(n.fFillColor=c,t+=`SetFillColor(${c});;`),a._plc&&(n.fLineColor=c,t+=`SetLineColor(${c});;`),a._pmc&&(n.fMarkerColor=c,t+=`SetMarkerColor(${c});;`)}}return a.drawGraph(n,f,s.arr.length-i).then(e=>(e&&(a.painters.push(e),e._auto_exec=t),a.drawNextGraph(i+1,r)))})()}static _drawMG(i,r){return(0,h.A)(function*(){const a=new H.nC(r);i._3d=a.check("3D"),i._pfc=a.check("PFC"),i._plc=a.check("PLC"),i._pmc=a.check("PMC");let s="";a.check("FB")&&i._3d&&(s+="FB"),P.c.forEach(n=>{a.check(n)&&(s+=";"+n)});let t=Promise.resolve(!0);if(a.check("A")||!i.getMainPainter()){const n=i.getObject(),f=i.scanGraphsRange(n.fGraphs,n.fHistogram,i.getPadPainter()?.getRootPad(!0));t=i.drawAxisHist(f,s).then(e=>{i.firstpainter=e,e.$secondary="hist",n.fHistogram&&(i.$primary=!0)})}return t.then(()=>(i.addToPadPrimitives(),i.drawNextGraph(0,a.remain())))})()}static draw(i,r,a){return(0,h.A)(function*(){return p._drawMG(new p(i,r),a)})()}}var C=x(4149),X=x(895);class T extends p{drawAxisHist(i,r){var a=this;return(0,h.A)(function*(){return a._3d?C.TH2Painter.draw(a.getDom(),i,"LEGO"+r):P.N.draw(a.getDom(),i,r)})()}drawGraph(i,r,a){var s=this;return(0,h.A)(function*(){return s._3d&&(r+="pos3d_"+a),X.k.draw(s.getDom(),i,r)})()}static draw(i,r,a){return(0,h.A)(function*(){return T._drawMG(new T(i,r),a)})()}}}}]);