"use strict";(self.webpackChunkfirebird=self.webpackChunkfirebird||[]).push([[2076],{2695:(D,M,_)=>{_.r(M),_.d(M,{TLinePainter:()=>n});var T=_(467),c=_(6998),E=_(675),p=_(9025),P=_(6714),h=_(6370);class n extends E.JW{moveStart(r,a){const e=Math.sqrt((this.x1-this.x2)**2+(this.y1-this.y2)**2),t=Math.sqrt((r-this.x1)**2+(a-this.y1)**2)/e,s=Math.sqrt((r-this.x2)**2+(a-this.y2)**2)/e;this.side=t>.9?1:s>.9?-1:0}moveDrag(r,a){1!==this.side&&(this.x1+=r,this.y1+=a),-1!==this.side&&(this.x2+=r,this.y2+=a),this.draw_g.select("path").attr("d",this.createPath())}moveEnd(r){if(r)return;const a=this.getObject();let e="";a.fX1=this.svgToAxis("x",this.x1,this.isndc),a.fX2=this.svgToAxis("x",this.x2,this.isndc),a.fY1=this.svgToAxis("y",this.y1,this.isndc),a.fY2=this.svgToAxis("y",this.y2,this.isndc),1!==this.side&&(e+=`SetX1(${a.fX1});;SetY1(${a.fY1});;`),-1!==this.side&&(e+=`SetX2(${a.fX2});;SetY2(${a.fY2});;`),this.submitCanvExec(e+"Notify();;")}prepareDraw(){const r=this.getObject(),a=(0,c.BIT)(14);this.isndc=r.TestBit(a),this.x1=this.axisToSvg("x",r.fX1,this.isndc,!0),this.y1=this.axisToSvg("y",r.fY1,this.isndc,!0),this.x2=this.axisToSvg("x",r.fX2,this.isndc,!0),this.y2=this.axisToSvg("y",r.fY2,this.isndc,!0),this.createAttLine({attr:r})}createPath(){const r=Math.round(this.x1),a=Math.round(this.x2),e=Math.round(this.y1),t=Math.round(this.y2);return`M${r},${e}`+(r===a?`V${t}`:e===t?`H${a}`:`L${a},${t}`)}addExtras(){}redraw(){this.prepareDraw(),this.createG();const r=this.draw_g.append("svg:path").attr("d",this.createPath()).call(this.lineatt.func);return this.addExtras(r),(0,P.X2)(this),(0,h.wh)(this,h.Ew),this}static draw(r,a,e){return(0,T.A)(function*(){const t=new n(r,a,e);return(0,p.ensureTCanvas)(t,!1).then(()=>t.redraw())})()}}},9109:(D,M,_)=>{_.d(M,{Y:()=>p});var T=_(467),c=_(6998),E=_(1069);function p(){return P.apply(this,arguments)}function P(){return(P=(0,T.A)(function*(){const h=this.$fp||this.getFramePainter();if(delete this.$fp,!((0,c.isObject)(h)&&h.grx&&h.gry&&h.grz))return this;const n=this.getObject(),r=n.fP;let a=1,e=0;for(let i=0;i<r.length;i+=3)r[i]<h.scale_xmin||r[i]>h.scale_xmax||r[i+1]<h.scale_ymin||r[i+1]>h.scale_ymax||r[i+2]<h.scale_zmin||r[i+2]>h.scale_zmax||++e;c.settings.OptimizeDraw>0&&e>5e4&&(a=Math.floor(e/5e4),a<=2&&(a=2));const t=Math.floor(e/a),s=new E._l(t,h.webgl,h.size_x3d/100),l=new Int32Array(t);let o=0,f=0;for(let i=0;i<r.length;i+=3)r[i]<h.scale_xmin||r[i]>h.scale_xmax||r[i+1]<h.scale_ymin||r[i+1]>h.scale_ymax||r[i+2]<h.scale_zmin||r[i+2]>h.scale_zmax||a>1&&(o=(o+1)%a,0!==o)||(l[f++]=i,s.addPoint(h.grx(r[i]),h.gry(r[i+1]),h.grz(r[i+2])));return s.createPoints({color:this.getColor(n.fMarkerColor),style:n.fMarkerStyle}).then(i=>(i.tip_color=3===n.fMarkerColor?16711680:65280,i.tip_name=n.fName||"Poly3D",i.poly=n,i.painter=h,i.scale0=.7*s.scale,i.index=l,h.toplevel.add(i),i.tooltip=function(m){let x=Math.floor(m.index/this.nvertex);if(x<0||x>=this.index.length)return null;x=this.index[x];const g=this.painter,d=g.grx(this.poly.fP[x]),u=g.gry(this.poly.fP[x+1]),y=g.grz(this.poly.fP[x+2]);return{x1:d-this.scale0,x2:d+this.scale0,y1:u-this.scale0,y2:u+this.scale0,z1:y-this.scale0,z2:y+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+x/3,"x: "+g.axisAsText("x",this.poly.fP[x]),"y: "+g.axisAsText("y",this.poly.fP[x+1]),"z: "+g.axisAsText("z",this.poly.fP[x+2])]}},h.render3D(100),this))})).apply(this,arguments)}},230:(D,M,_)=>{_.r(M),_.d(M,{TF1Painter:()=>a,produceTAxisLogScale:()=>r,proivdeEvalPar:()=>v});var T=_(467),c=_(6998),E=_(9041),p=_(675),P=_(3277),h=_(2953),n=_(8977);function v(e){e._math=n;let t=e.fTitle,s=!1,l="[";if("gaus"===t&&(t="gaus(0)"),(0,c.isStr)(e.fFormula?.fFormula)&&(0===e.fFormula.fFormula.indexOf("[](double*x,double*p)")?(s=!0,l="p[",t=e.fFormula.fFormula.slice(21)):(t=e.fFormula.fFormula,l="[p"),e.fFormula.fClingParameters&&e.fFormula.fParams&&e.fFormula.fParams.forEach(o=>{const f=new RegExp(`(\\[${o.first}\\])`,"g"),i=e.fFormula.fClingParameters[o.second];t=t.replace(f,i<0?`(${i})`:i)})),!t)return!1;if(e.formulas?.forEach(o=>{t=t.replaceAll(o.fName,o.fTitle)}),t=t.replace(/\b(sin|SIN)\b/g,"Math.sin").replace(/\b(cos|COS)\b/g,"Math.cos").replace(/\b(tan|TAN)\b/g,"Math.tan").replace(/\b(exp|EXP|TMath::Exp)\b/g,"Math.exp").replace(/\b(log|LOG)\b/g,"Math.log").replace(/\b(log10|LOG10)\b/g,"Math.log10").replace(/\b(pow|POW)\b/g,"Math.pow").replace(/\b(pi|PI)\b/g,"Math.PI").replace(/\b(abs|ABS|TMath::Abs)\b/g,"Math.abs").replace(/\bxygaus\(/g,"this._math.gausxy(this, x, y, ").replace(/\bgaus\(/g,"this._math.gaus(this, x, ").replace(/\bgausn\(/g,"this._math.gausn(this, x, ").replace(/\bexpo\(/g,"this._math.expo(this, x, ").replace(/\blandau\(/g,"this._math.landau(this, x, ").replace(/\blandaun\(/g,"this._math.landaun(this, x, ").replace(/\bTMath::/g,"this._math.").replace(/\bROOT::Math::/g,"this._math."),t.match(/^pol[0-9]$/)&&parseInt(t[3])===e.fNpar-1){t="[0]";for(let o=1;o<e.fNpar;++o)t+=` + [${o}] * `+(1===o?"x":`Math.pow(x,${o})`)}for(let o=0;o<e.fNpar;++o)t=t.replaceAll(l+o+"]",`(${e.GetParValue(o)})`);for(let o=2;o<10;++o)t=t.replaceAll(`x^${o}`,`Math.pow(x,${o})`);return s?(t=t.replace(/x\[0\]/g,"x"),e._typename===c.clTF2?(t=t.replace(/x\[1\]/g,"y"),e.evalPar=new Function("x","y",t).bind(e)):e.evalPar=new Function("x",t).bind(e)):e.evalPar=e._typename===c.clTF2?new Function("x","y","return "+t).bind(e):new Function("x","return "+t).bind(e),!0}function r(e,t,s,l){let o,f;l>0?(f=Math.log(l),o=s>0?Math.log(s):f-5):(f=-10,o=-15),e.fNbins=t,e.fXbins=new Array(t+1);for(let i=0;i<=t;++i)e.fXbins[i]=Math.exp(o+i/t*(f-o));e.fXmin=Math.exp(o),e.fXmax=Math.exp(f)}class a extends h.N{getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??c.clTF1}isTF1(){return!0}updateObject(t){if(!t||this.getClassName()!==t._typename)return!1;delete t.evalPar;const s=this.getHisto();if(this.webcanv_hist){const l=this.getPadPainter()?.findInPrimitives("Func",c.clTH1D);l&&this.updateAxes(s,l,this.getFramePainter())}return this.$func=t,this.createTF1Histogram(t,s),this.scanContent(),!0}redraw(t){return!this._use_saved_points&&("logx"===t||"zoom"===t)&&(this.createTF1Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(t)}createTF1Histogram(t,s){const l=this.getFramePainter(),o=this.getPadPainter()?.getRootPad(!0),f=o?.fLogx,i=l?.getGrFuncs(this.second_x,this.second_y);let m=t.fXmin,x=t.fXmax;i?.zoom_xmin!==i?.zoom_xmax&&(m=Math.min(m,i.zoom_xmin),x=Math.max(x,i.zoom_xmax)),this._use_saved_points=t.fSave.length>3&&(c.settings.PreferSavedPoints||this.force_saved);const g=d=>{s.fNcells!==d+2&&(s.fNcells=d+2,s.fArray=new Float32Array(s.fNcells),s.fArray.fill(0)),s.fXaxis.fNbins=d,s.fXaxis.fXbins=[]};if(delete this._fail_eval,!this._use_saved_points){const d=Math.max(t.fNpx,100);let u=!1;if(!t.evalPar)try{v(t)||(u=!0)}catch{u=!0}g(d),f?r(s.fXaxis,d,m,x):(s.fXaxis.fXmin=m,s.fXaxis.fXmax=x);for(let y=0;y<d&&!u;y++){const O=s.fXaxis.GetBinCenter(y+1);let A=0;try{A=t.evalPar(O)}catch{u=!0}u||s.setBinContent(y+1,Number.isFinite(A)?A:0)}u&&(this._fail_eval=!0),u&&t.fSave.length>3&&(this._use_saved_points=!0)}if(this._use_saved_points){let d=t.fSave.length-2,u=null;if(m=t.fSave[d],x=t.fSave[d+1],m===x){m=t.fSave[--d];const y=this.getMainPainter();(0,c.isFunc)(y?.getHisto)?u=y?.getHisto()?.fXaxis:console.error("Very special stored values, see TF1::Save, in TF1.cxx:3183",m,x)}else{const O=(t.fXmax-t.fXmin)/Math.max(1,t.fNpx),A=Math.abs(m-t.fXmin-.5*O)<1e-10&&Math.abs(t.fXmax-.5*O-x)<1e-10;d>=t.fNpx&&(d=A?t.fNpx-1:t.fNpx)}g(d),u?Object.assign(s.fXaxis,u):(s.fXaxis.fXmin=m,s.fXaxis.fXmax=x);for(let y=0;y<d;++y){const O=t.fSave[y];s.setBinContent(y+1,Number.isFinite(O)?O:0)}}s.fName="Func",(0,c.setHistogramTitle)(s,t.fTitle),s.fMinimum=t.fMinimum,s.fMaximum=t.fMaximum,s.fLineColor=t.fLineColor,s.fLineStyle=t.fLineStyle,s.fLineWidth=t.fLineWidth,s.fFillColor=t.fFillColor,s.fFillStyle=t.fFillStyle,s.fMarkerColor=t.fMarkerColor,s.fMarkerStyle=t.fMarkerStyle,s.fMarkerSize=t.fMarkerSize,s.fBits|=c.kNoStats}extractAxesProperties(t){super.extractAxesProperties(t);const s=this.$func,l=s?.fSave.length??0;l>3&&this._use_saved_points&&(this.xmin=Math.min(this.xmin,s.fSave[l-2]),this.xmax=Math.max(this.xmax,s.fSave[l-1])),s&&(this.xmin=Math.min(this.xmin,s.fXmin),this.xmax=Math.max(this.xmax,s.fXmax))}canZoomInside(t,s,l){if(this.$func?.fSave.length>0&&this._use_saved_points&&"x"===t){const o=this.$func.fNpx;return Math.abs(this.$func.fSave[o+2]-this.$func.fSave[o+1])/o<Math.abs(l-s)}return"x"===t||"y"===t}getTF1Tooltips(t){delete this.$tmp_tooltip;const s=[this.getObjectHint()],l=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!l||!(0,c.isFunc)(this.$func?.evalPar))return s.push("grx = "+t.x,"gry = "+t.y),s;const o=l.revertAxis("x",t.x);let f=0,i=0,m=!1;try{f=this.$func.evalPar(o),i=Math.round(l.gry(f))}catch{m=!0}return s.push("x = "+l.axisAsText("x",o),"value = "+(m?"<fail>":(0,E.lg)(f,c.gStyle.fStatFormat))),m||(this.$tmp_tooltip={y:f,gry:i}),s}processTooltipEvent(t){if(this._use_saved_points)return super.processTooltipEvent(t);let s=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!t)return s?.remove(),null;const l={name:this.$func?.fName,title:this.$func?.fTitle,x:t.x,y:t.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF1Tooltips(t),exact:!0,menu:!0};return s.empty()&&(s=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),s.attr("cx",t.x).attr("cy",this.$tmp_tooltip.gry??t.y).call(this.lineatt?.func),l}fillWebObjectOptions(t){t.fcust=this._fail_eval?"func_fail":""}static draw(t,s,l){return(0,T.A)(function*(){(0,c.isStr)(l)||(l="");let m,o=l.indexOf(";webcanv_hist"),f=!1,i=!1;o>=0&&(f=!0,l=l.slice(0,o)),o=l.indexOf(";force_saved"),o>=0&&(i=!0,l=l.slice(0,o)),f&&(m=new p.JW(t).getPadPainter()?.findInPrimitives("Func",c.clTH1D)),m||(m=(0,c.createHistogram)(c.clTH1D,100),m.fBits|=c.kNoStats),!l&&(0,p.Nn)(t)&&(l="same");const x=new a(t,m);return x.$func=s,x.webcanv_hist=f,x.force_saved=i,x.createTF1Histogram(s,m),P.mf._drawHist(x,l)})()}}},895:(D,M,_)=>{_.d(M,{k:()=>P});var T=_(467),c=_(4693),E=_(1516),p=_(1069);class P extends c.TGraphPainter{drawBins3D(n,v){if(!(n.mode3d&&n.grx&&n.gry&&n.grz&&n.toplevel))return console.log("Frame painter missing base 3d elements");if(n.zoom_xmin!==n.zoom_xmax&&(this.options.pos3d<n.zoom_xmin||this.options.pos3d>n.zoom_xmax))return;const r=this.optimizeBins(1e3);let a=0,e=r.length-1;if(n.zoom_ymin!==n.zoom_ymax){for(;a<e&&r[a].x<n.zoom_ymin;)a++;for(;a<e&&r[e].x>n.zoom_ymax;)e--}if(a===e)return;const t=[],s=n.grx(this.options.pos3d);let l=r[a];for(let f=a+1;f<=e;++f){const i=r[f];t.push(s,n.gry(l.x),n.grz(l.y),s,n.gry(i.x),n.grz(i.y)),l=i}const o=(0,p.Fc)(t,(0,p.DH)(this,v));n.toplevel.add(o),n.render3D(100)}drawAxisHisto(){var n=this;return(0,T.A)(function*(){return E.TH1Painter.draw(n.getDom(),n.createHistogram(),n.options.Axis)})()}static draw(n,v,r){return(0,T.A)(function*(){return P._drawGraph(new P(n,v),r)})()}}},2826:(D,M,_)=>{_.r(M),_.d(M,{TLinePainter:()=>v});var T=_(467),c=_(5461),E=_(3641),p=_(4080),P=_(3307),h=_(1713);const n=(0,c.BIT)(14);class v extends E.JW{moveStart(a,e){const t=Math.sqrt((this.x1-this.x2)**2+(this.y1-this.y2)**2),s=Math.sqrt((a-this.x1)**2+(e-this.y1)**2)/t,l=Math.sqrt((a-this.x2)**2+(e-this.y2)**2)/t;this.side=s>.9?1:l>.9?-1:0}moveDrag(a,e){1!==this.side&&(this.x1+=a,this.y1+=e),-1!==this.side&&(this.x2+=a,this.y2+=e),this.draw_g.select("path").attr("d",this.createPath())}moveEnd(a){if(a)return;const e=this.getObject();let t="";e.fX1=this.svgToAxis("x",this.x1,this.isndc),e.fX2=this.svgToAxis("x",this.x2,this.isndc),e.fY1=this.svgToAxis("y",this.y1,this.isndc),e.fY2=this.svgToAxis("y",this.y2,this.isndc),1!==this.side&&(t+=`SetX1(${e.fX1});;SetY1(${e.fY1});;`),-1!==this.side&&(t+=`SetX2(${e.fX2});;SetY2(${e.fY2});;`),this.submitCanvExec(t+"Notify();;")}prepareDraw(){const a=this.getObject();this.isndc=a.TestBit(n);const e=this.getAxisToSvgFunc(this.isndc,!0,!0);this.x1=e.x(a.fX1),this.y1=e.y(a.fY1),this.x2=e.x(a.fX2),this.y2=e.y(a.fY2),this.createAttLine({attr:a})}createPath(){const a=Math.round(this.x1),e=Math.round(this.x2),t=Math.round(this.y1),s=Math.round(this.y2);return`M${a},${t}`+(a===e?`V${s}`:t===s?`H${e}`:`L${e},${s}`)}addExtras(){}redraw(){this.createG(),this.prepareDraw();const a=this.draw_g.append("svg:path").attr("d",this.createPath()).call(this.lineatt.func);return this.getObject()?.$do_not_draw?a.remove():(this.addExtras(a),(0,P.X2)(this),(0,h.wh)(this,h.Ew)),this}static draw(a,e,t){return(0,T.A)(function*(){const s=new v(a,e,t);return(0,p.ensureTCanvas)(s,!1).then(()=>s.redraw())})()}}},5562:(D,M,_)=>{_.d(M,{Y:()=>p});var T=_(467),c=_(5461),E=_(5308);function p(){return P.apply(this,arguments)}function P(){return(P=(0,T.A)(function*(){const h=this.$fp||this.getFramePainter();if(delete this.$fp,!((0,c.isObject)(h)&&h.grx&&h.gry&&h.grz))return this;const n=this.getObject(),r=n.fP;let a=1,e=0;for(let i=0;i<r.length;i+=3)r[i]<h.scale_xmin||r[i]>h.scale_xmax||r[i+1]<h.scale_ymin||r[i+1]>h.scale_ymax||r[i+2]<h.scale_zmin||r[i+2]>h.scale_zmax||++e;c.settings.OptimizeDraw>0&&e>5e4&&(a=Math.floor(e/5e4),a<=2&&(a=2));const t=Math.floor(e/a),s=new E._l(t,h.webgl,h.size_x3d/100),l=new Int32Array(t);let o=0,f=0;for(let i=0;i<r.length;i+=3)r[i]<h.scale_xmin||r[i]>h.scale_xmax||r[i+1]<h.scale_ymin||r[i+1]>h.scale_ymax||r[i+2]<h.scale_zmin||r[i+2]>h.scale_zmax||a>1&&(o=(o+1)%a,0!==o)||(l[f++]=i,s.addPoint(h.grx(r[i]),h.gry(r[i+1]),h.grz(r[i+2])));return s.createPoints({color:this.getColor(n.fMarkerColor),style:n.fMarkerStyle}).then(i=>(i.tip_color=3===n.fMarkerColor?16711680:65280,i.tip_name=n.fName||"Poly3D",i.poly=n,i.fp=h,i.scale0=.7*s.scale,i.index=l,h.add3DMesh(i,this,!0),i.tooltip=function(m){let x=Math.floor(m.index/this.nvertex);if(x<0||x>=this.index.length)return null;x=this.index[x];const g=this.fp,d=g.grx(this.poly.fP[x]),u=g.gry(this.poly.fP[x+1]),y=g.grz(this.poly.fP[x+2]);return{x1:d-this.scale0,x2:d+this.scale0,y1:u-this.scale0,y2:u+this.scale0,z1:y-this.scale0,z2:y+this.scale0,color:this.tip_color,lines:[this.tip_name,"pnt: "+x/3,"x: "+g.axisAsText("x",this.poly.fP[x]),"y: "+g.axisAsText("y",this.poly.fP[x+1]),"z: "+g.axisAsText("z",this.poly.fP[x+2])]}},h.render3D(100),this))})).apply(this,arguments)}},5727:(D,M,_)=>{_.r(M),_.d(M,{TF1Painter:()=>r,produceTAxisLogScale:()=>v});var T=_(467),c=_(5461),E=_(3282),p=_(3641),P=_(6084),h=_(8527),n=_(1568);function v(a,e,t,s){let l,o;s>0?(o=Math.log(s),l=t>0?Math.log(t):o-5):(o=-10,l=-15),a.fNbins=e,a.fXbins=new Array(e+1);for(let f=0;f<=e;++f)a.fXbins[f]=Math.exp(l+f/e*(o-l));a.fXmin=Math.exp(l),a.fXmax=Math.exp(o)}class r extends h.N{getObjectName(){return this.$func?.fName??"func"}getClassName(){return this.$func?._typename??c.clTF1}isTF1(){return!0}getPrimaryObject(){return this.$func}updateObject(e){if(!e||this.getClassName()!==e._typename)return!1;delete e.evalPar;const t=this.getHisto();if(this.webcanv_hist){const s=this.getPadPainter()?.findInPrimitives("Func",c.clTH1D);s&&this.updateAxes(t,s,this.getFramePainter())}return this.$func=e,this.createTF1Histogram(e,t),this.scanContent(),!0}redraw(e){return!this._use_saved_points&&("logx"===e||"zoom"===e)&&(this.createTF1Histogram(this.$func,this.getHisto()),this.scanContent()),super.redraw(e)}createTF1Histogram(e,t){const s=this.getFramePainter(),l=this.getPadPainter()?.getRootPad(!0),o=l?.fLogx,f=s?.getGrFuncs(this.second_x,this.second_y);let i=e.fXmin,m=e.fXmax;f?.zoom_xmin!==f?.zoom_xmax&&(i=Math.min(i,f.zoom_xmin),m=Math.max(m,f.zoom_xmax)),this._use_saved_points=e.fSave.length>3&&(c.settings.PreferSavedPoints||this.force_saved);const x=g=>{t.fNcells!==g+2&&(t.fNcells=g+2,t.fArray=new Float32Array(t.fNcells)),t.fArray.fill(0),t.fXaxis.fNbins=g,t.fXaxis.fXbins=[]};if(delete this._fail_eval,!this._use_saved_points){const g=Math.max(e.fNpx,100);let d=!1;if(!e.evalPar)try{(0,n.Dx)(e)||(d=!0)}catch{d=!0}x(g),o?v(t.fXaxis,g,i,m):(t.fXaxis.fXmin=i,t.fXaxis.fXmax=m);for(let u=0;u<g&&!d;u++){const y=t.fXaxis.GetBinCenter(u+1);let O=0;try{O=e.evalPar(y)}catch{d=!0}d||t.setBinContent(u+1,Number.isFinite(O)?O:0)}d&&(this._fail_eval=!0),d&&e.fSave.length>3&&(this._use_saved_points=!0)}if(this._use_saved_points){const g=e.fSave.length-3;let d=null;if(i=e.fSave[g+1],m=e.fSave[g+2],i===m){const u=this.getMainPainter();(0,c.isFunc)(u?.getHisto)&&(d=u?.getHisto()?.fXaxis)}if(d){x(t.fXaxis.fNbins),Object.assign(t.fXaxis,d);for(let u=0;u<g;++u){const y=e.fSave[u];t.setBinContent(u+1,Number.isFinite(y)?y:0)}}else{x(e.fNpx),t.fXaxis.fXmin=e.fXmin,t.fXaxis.fXmax=e.fXmax;for(let u=0;u<e.fNpx;++u){const y=(0,n.YI)(e,t.fXaxis.GetBinCenter(u+1));t.setBinContent(u+1,Number.isFinite(y)?y:0)}}}t.fName="Func",(0,c.setHistogramTitle)(t,e.fTitle),t.fMinimum=e.fMinimum,t.fMaximum=e.fMaximum,t.fLineColor=e.fLineColor,t.fLineStyle=e.fLineStyle,t.fLineWidth=e.fLineWidth,t.fFillColor=e.fFillColor,t.fFillStyle=e.fFillStyle,t.fMarkerColor=e.fMarkerColor,t.fMarkerStyle=e.fMarkerStyle,t.fMarkerSize=e.fMarkerSize,t.fBits|=c.kNoStats}extractAxesProperties(e){super.extractAxesProperties(e);const t=this.$func,s=t?.fSave.length??0;s>3&&this._use_saved_points&&(this.xmin=Math.min(this.xmin,t.fSave[s-2]),this.xmax=Math.max(this.xmax,t.fSave[s-1])),t&&(this.xmin=Math.min(this.xmin,t.fXmin),this.xmax=Math.max(this.xmax,t.fXmax))}canZoomInside(e,t,s){if(this.$func?.fSave.length>0&&this._use_saved_points&&"x"===e){const l=this.$func.fNpx;return Math.abs(this.$func.fSave[l+2]-this.$func.fSave[l+1])/l<Math.abs(s-t)}return"x"===e||"y"===e}getTF1Tooltips(e){delete this.$tmp_tooltip;const t=[this.getObjectHint()],s=this.getFramePainter()?.getGrFuncs(this.options.second_x,this.options.second_y);if(!s||!(0,c.isFunc)(this.$func?.evalPar))return t.push("grx = "+e.x,"gry = "+e.y),t;const l=s.revertAxis("x",e.x);let o=0,f=0,i=!1;try{o=this.$func.evalPar(l),f=Math.round(s.gry(o))}catch{i=!0}return t.push("x = "+s.axisAsText("x",l),"value = "+(i?"<fail>":(0,E.lg)(o,c.gStyle.fStatFormat))),i||(this.$tmp_tooltip={y:o,gry:f}),t}processTooltipEvent(e){if(this._use_saved_points)return super.processTooltipEvent(e);let t=this.draw_g?.selectChild(".tooltip_bin");if(!this.draw_g||!e)return t?.remove(),null;const s={name:this.$func?.fName,title:this.$func?.fTitle,x:e.x,y:e.y,color1:this.lineatt?.color??"green",color2:this.fillatt?.getFillColorAlt("blue")??"blue",lines:this.getTF1Tooltips(e),exact:!0,menu:!0};return e.disabled?t.remove():(t.empty()&&(t=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").style("fill","none").attr("r",(this.lineatt?.width??1)+4)),t.attr("cx",e.x).attr("cy",this.$tmp_tooltip.gry??e.y).call(this.lineatt?.func)),s}fillWebObjectOptions(e){e.fcust=this._fail_eval?"func_fail":""}static draw(e,t,s){return(0,T.A)(function*(){(0,c.isStr)(s)||(s="");let i,l=s.indexOf(";webcanv_hist"),o=!1,f=!1;l>=0&&(o=!0,s=s.slice(0,l)),l=s.indexOf(";force_saved"),l>=0&&(f=!0,s=s.slice(0,l)),o&&(i=new p.JW(e).getPadPainter()?.findInPrimitives("Func",c.clTH1D)),i||(i=(0,c.createHistogram)(c.clTH1D,100),i.fBits|=c.kNoStats),!s&&(0,p.Nn)(e)&&(s="same");const m=new r(e,i);return m.$func=t,m.webcanv_hist=o,m.force_saved=f,m.createTF1Histogram(t,i),P.mf._drawHist(m,s)})()}}},8884:(D,M,_)=>{_.d(M,{k:()=>P});var T=_(467),c=_(3026),E=_(3829),p=_(5308);class P extends c.TGraphPainter{drawBins3D(n,v){if(!(n.mode3d&&n.grx&&n.gry&&n.grz&&n.toplevel))return console.log("Frame painter missing base 3d elements");if(n.zoom_xmin!==n.zoom_xmax&&(this.options.pos3d<n.zoom_xmin||this.options.pos3d>n.zoom_xmax))return;this.createGraphDrawAttributes(!0);const r=this.optimizeBins(1e3);let a=0,e=r.length-1;if(n.zoom_ymin!==n.zoom_ymax){for(;a<e&&r[a].x<n.zoom_ymin;)a++;for(;a<e&&r[e].x>n.zoom_ymax;)e--}if(a===e)return;const t=[],s=n.grx(this.options.pos3d);let l=r[a];for(let f=a+1;f<=e;++f){const i=r[f];t.push(s,n.gry(l.x),n.grz(l.y),s,n.gry(i.x),n.grz(i.y)),l=i}const o=(0,p.Fc)(t,(0,p.DH)(this,v));n.add3DMesh(o,this,!0),n.render3D(100)}drawAxisHisto(){var n=this;return(0,T.A)(function*(){return E.TH1Painter.draw(n.getDom(),n.createHistogram(),n.options.Axis)})()}static draw(n,v,r){return(0,T.A)(function*(){return P._drawGraph(new P(n,v),r)})()}}}}]);