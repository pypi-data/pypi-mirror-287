"use strict";(self.webpackChunk_secretflow_secretnote=self.webpackChunk_secretflow_secretnote||[]).push([[5987],{80117:function(Wr,_e,c){c.r(_e),c.d(_e,{default:function(){return ye}});var ht=c(73193),ze=c.n(ht),Xe=c(45332),b=c.n(Xe),Be=c(42739),Ye=c(30209),f=c(69251),Qe=c(49679),O=c(92120),_=c(44194),Q=c(89428),qe=c(65941),q=c(95831),et=c(55844),S=c(86434),I=c(36582),xe=c(78796),tt=c.n(xe),Ie=c(4977),nt=c.n(Ie),j=c(10154),Re=c.n(j),G=function(){function M(){tt()(this,M),Re()(this,"_terminal",void 0),Re()(this,"_cacheDecorations",new Map),Re()(this,"_highlightTimeout",0)}return nt()(M,[{key:"activate",value:function(A){this._terminal=A}},{key:"_getLineProperty",value:function(A){for(var V=0,T=A.getCell(V),D=0,Z=!0,J=!0;T;)T.isBgDefault()||(Z=!1),T.isFgDefault()||(J=!1),D+=T.getWidth(),T=A.getCell(V),V++;return{width:D,isAllBgDefault:Z,isAllFgDefault:J}}},{key:"_decoration",value:function(A,V,T){if(this._terminal&&T&&T.decorations){var D=this._terminal,Z=this._getLineProperty(A),J=Z.width,ee=Z.isAllBgDefault,K=Z.isAllFgDefault;if(!(!ee||!K)){var ce=D.registerMarker(-D.buffer.active.baseY-D.buffer.active.cursorY+V);if(ce){var te={marker:ce,x:0,width:J,backgroundColor:T.decorations.matchBackground,foregroundColor:T.decorations.matchForegroundColor,layer:"bottom"},de=D.registerDecoration(te);de&&(de.onDispose(function(){ce.dispose()}),this._cacheDecorations.set(V,de))}}}}},{key:"_clearDecoration",value:function(){this._cacheDecorations.forEach(function(A){A.dispose()}),this._cacheDecorations.clear()}},{key:"_updateHighlight",value:function(A){var V=this;if(this._terminal&&Array.isArray(A)){this._clearDecoration();for(var T=this._terminal,D=0,Z=T.buffer.active.getLine(D),J,ee=function(){var ce,te=T.buffer.active.getLine(D+1),de=te?te.isWrapped:!1,Ae=(ce=Z)===null||ce===void 0?void 0:ce.translateToString(!de);if(Ae){var pe;if((pe=Z)!==null&&pe!==void 0&&pe.isWrapped&&J)V._decoration(Z,D,J);else{var fe=A.find(function(Me){var me=Me.keyword||"";if(Me.ignoreSensitive){var Ce=Ae.toLowerCase();return Ce.includes(me.toLowerCase())||Ce.includes(me)}return Ae.includes(me)});J=fe,V._decoration(Z,D,fe)}}D++,Z=te};Z;)ee()}}},{key:"highlight",value:function(A){var V=this;if(this._terminal&&Array.isArray(A)){this._cacheDecorations=new Map;var T=this._terminal;T.onWriteParsed(function(){clearTimeout(V._highlightTimeout),V._highlightTimeout=window.setTimeout(function(){V._updateHighlight(A)},0)}),T.onResize(function(){clearTimeout(V._highlightTimeout),V._highlightTimeout=window.setTimeout(function(){V._updateHighlight(A)},0)})}}},{key:"dispose",value:function(){clearTimeout(this._highlightTimeout),this._cacheDecorations.clear()}}]),M}();function rt(M,R,A,V){var T=(0,_.useState)(),D=b()(T,2),Z=D[0],J=D[1],ee=(0,_.useRef)(V);return(0,_.useEffect)(function(){ee.current=V}),(0,_.useEffect)(function(){var K=new R;return A&&M&&(M.loadAddon(K),J(K),ee.current instanceof Function&&ee.current(M,K)),function(){J(void 0),K.dispose()}},[M,R,A]),Z}var w=rt;function at(M,R){var A=(0,_.useRef)(M),V=(0,_.useRef)(0);return(0,_.useEffect)(function(){A.current=M}),(0,_.useEffect)(function(){return function(){clearTimeout(V.current)}},[]),(0,_.useCallback)(function(T){var D=T.target.value;clearTimeout(V.current),V.current=window.setTimeout(function(){A.current(D)},R)},[R])}var he=at,it=c(23417),ge=function(R,A){var V=(0,_.useRef)(R);return(0,_.useEffect)(function(){V.current=R}),(0,_.useCallback)(function(){return(0,it.Z)(V.current,A)()},[A])},st=ge,x=c(31549),Fe={regex:!1,wholeWord:!1,caseSensitive:!1,incremental:!1,decorations:{matchForegroundColor:"#000000",matchBackground:"#f6c8ac",matchBorder:"none",matchOverviewRuler:"none",activeMatchBackground:"#babfb1",activeMatchBorder:"none",activeMatchColorOverviewRuler:"none"}},E={cursorBlink:!1,convertEol:!1,scrollback:Number.MAX_SAFE_INTEGER,drawBoldTextInBrightColors:!1,allowProposedApi:!0,allowTransparency:!0,fontSize:13,fontFamily:"Roboto Mono,Andale Mono,Consolas,Courier New,monospace",lineHeight:20/17,fastScrollSensitivity:35},be=[{keyword:"[error]",ignoreSensitive:!0,decorations:{matchForegroundColor:"red",matchBackground:"#24292e"}},{keyword:"[warn]",ignoreSensitive:!0,decorations:{matchForegroundColor:"yellow",matchBackground:"#24292e"}},{keyword:"[debug]",ignoreSensitive:!0,decorations:{matchForegroundColor:"cyan",matchBackground:"#24292e"}}],Ne=function(R){var A=(0,_.useState)(),V=b()(A,2),T=V[0],D=V[1],Z=(0,_.useState)(""),J=b()(Z,2),ee=J[0],K=J[1],ce=(0,_.useState)({resultIndex:-1,resultCount:0}),te=b()(ce,2),de=te[0],Ae=te[1],pe=(0,_.useRef)(null),fe=(0,_.useRef)(!1),Me=R.theme||"dark",me=(0,_.useRef)(0);(0,_.useEffect)(function(){var L=new Q.Terminal(ze()(ze()({},E),{},{theme:Me==="dark"?{selectionBackground:"#fff",selectionForeground:"#fff",background:"#24292e",foreground:"#b5bbc6"}:{selectionBackground:"#b7d7fb",selectionForeground:"#000",background:"#fff",foreground:"#000"}}));return D(L),function(){try{L.dispose()}catch(H){}}},[]),(0,_.useEffect)(function(){return pe.current&&T&&(T.open(pe.current),fe.current=!0),function(){T&&(T.clear(),fe.current=!1)}},[T]),w(T,qe.CanvasAddon,!!T),w(T,S.WebLinksAddon,!!T);var Ce=w(T,q.FitAddon,!!T),re=w(T,et.SearchAddon,!!T,(0,_.useCallback)(function(L,H){var F=H;F&&F.onDidChangeResults&&F.onDidChangeResults(function(p){Ae(p||{resultIndex:-1,resultCount:0})})},[]));w(T,G,!!T,function(L,H){var F=H;F&&F.highlight(be)}),(0,_.useEffect)(function(){if(T)if(R.code.length===0){T.clear(),me.current=0;return}else{var L=R.code.slice(me.current);if(L.length>0){var H=L.join("").replaceAll(`
`,`\r
`);T.write(H),me.current=R.code.length}}},[T,R.code]);var Ee=st(function(){fe.current&&Ce&&Ce.fit&&Ce.fit()},3e3);(0,_.useEffect)(function(){var L=new ResizeObserver(Ee),H=pe.current;return H&&L.observe(H),function(){H&&(L.unobserve(H),L.disconnect())}},[Ce,Ee]);var De=he(function(L){re&&re.findNext(L,Fe)},800),ot=(0,_.useCallback)(function(){re&&re.findNext("",Fe)},[re]),lt=(0,_.useCallback)(function(L){re&&re.findPrevious(L,Fe)},[re]),Ze=(0,_.useCallback)(function(L){re&&re.findNext(L,Fe)},[re]),ut=(0,_.useCallback)(function(){T&&T.scrollToTop()},[T]),se=(0,_.useCallback)(function(){T&&T.scrollToBottom()},[T]),Ge=(0,x.jsxs)("div",{className:"terminal-viewer ".concat(Me),children:[(0,x.jsx)("div",{className:"terminal-viewer-header",children:(0,x.jsxs)("div",{className:"terminal-viewer-input-wrapper",children:[(0,x.jsx)("input",{placeholder:"Search...",className:"terminal-viewer-input",value:ee,type:"text",onKeyDown:function(H){H.key==="Enter"&&Ze(ee)},onChange:function(H){K(H.target.value),De(H)}}),(0,x.jsxs)("div",{className:"terminal-viewer-input-suffix",children:[ee&&(0,x.jsx)("span",{className:"input-suffix-search-result",children:de.resultCount}),(0,x.jsx)("span",{className:"input-suffix-clear",onClick:function(){K(""),ot()},children:(0,x.jsx)(Be.Z,{size:16})}),(0,x.jsx)("span",{className:"input-suffix-search-tool",onClick:function(){return lt(ee)},children:(0,x.jsx)(Ye.Z,{size:16})}),(0,x.jsx)("span",{className:"input-suffix-search-tool",onClick:function(){return Ze(ee)},children:(0,x.jsx)(f.Z,{size:16})})]})]})}),(0,x.jsx)("div",{className:"terminal-viewer-body",ref:pe}),(0,x.jsxs)("div",{className:"terminal-viewer-toolbar",children:[(0,x.jsx)("div",{className:"terminal-viewer-toolbar-button",onClick:ut,children:(0,x.jsx)(Qe.Z,{size:16})}),(0,x.jsx)("div",{className:"terminal-viewer-toolbar-button",onClick:se,children:(0,x.jsx)(O.Z,{size:16})})]})]});return Ge},ye=Ne},92646:function(Wr,_e,c){c.r(_e),c.d(_e,{default:function(){return ai}});var ht=c(24352),ze=c(35252),Xe=c(67147),b=c(40897),Be=c(19859),Ye=c(90819),f=c.n(Ye),Qe=c(89933),O=c.n(Qe),_=c(78796),Q=c.n(_),qe=c(4977),q=c.n(qe),et=c(10154),S=c.n(et),I=c(37637),xe=Symbol("ComponentCellModelFactory"),tt=c(76711),Ie=c.n(tt),nt=c(73193),j=c.n(nt),Re=c(26336),G=c.n(Re),rt=c(41553),w=c.n(rt),at=c(49488),he=c.n(at),it=c(84047),ge=c.n(it),st=c(62055),x=c.n(st),Fe=c(23202),E=c(73004),be=c(15063),Ne=c(97754),ye=c(68280),M=c(56257),R=c(71340),A=c(44194),V=c(43127),T=c(42088),D=c(1155),Z=c(1137),J=c(33042),ee=c(10466),K=c(65596),ce=c(75992),te=c(14412),de=2*Number.EPSILON,Ae=function(a){return a.atomic.allowedValues?a.atomic.allowedValues.ss:[]},pe=function(a){switch(a.type){case"AT_BOOL":return"boolean";case"AT_INT":return"integer";case"AT_STRING":return"string";case"AT_FLOAT":return"number"}return"string"},fe=function(a,n){var r,e,t,o,i;if(JSON.stringify((r=a.atomic)===null||r===void 0?void 0:r[n])==="{}")return 0;switch(a.type){case"AT_BOOL":return(e=a.atomic)===null||e===void 0||(e=e[n])===null||e===void 0?void 0:e.b;case"AT_INT":return(t=a.atomic)===null||t===void 0||(t=t[n])===null||t===void 0?void 0:t.i64;case"AT_STRING":return(o=a.atomic)===null||o===void 0||(o=o[n])===null||o===void 0?void 0:o.s;case"AT_FLOAT":return(i=a.atomic)===null||i===void 0||(i=i[n])===null||i===void 0?void 0:i.f}},Me=function(a){return!a.atomic.isOptional},me=function(a){return a.atomic.lowerBoundInclusive},Ce=function(a){var n=Number(fe(a,"lowerBound"));if(a.atomic.lowerBoundEnabled)return n+(me(a)?0:de)},re=function(a){if(a.atomic.upperBoundEnabled)return Number(fe(a,"upperBound"))},Ee=function(a,n,r){var e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"/",t=Array.isArray(n)?n:n.split(e),o=t.pop();if(o){var i=a;t.forEach(function(s){(i[s]===null||i[s]===void 0)&&(i[s]={}),i=i[s]}),i[o]=r}return a},De=function(a,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"/",e,t=Array.isArray(n)?n:n.split(r);if(t.length)for(e=a;t.length;){var o=t.shift();if(Object(e)===e&&o&&o in e)e=e[o];else return}return e},ot=function(a){var n={id:"$root",type:"object",title:"schema form",description:"",properties:{attrs:{id:"attrs",type:"object",title:"attrs",description:"",properties:{}},inputs:{id:"inputs",type:"object",title:"inputs",description:"",properties:{}},outputs:{id:"outputs",type:"object",title:"outputs",description:"",properties:{}}}};return(a.attrs||[]).forEach(function(r){var e=r.name,t=r.desc,o=pe(r),i=Ae(r),s=Ce(r),l=s===void 0?void 0:"Must be greater than "+(me(r)?"or equal to ".concat(s):"".concat(s-de)),g={id:e,type:o,title:e,description:t,$componentType:i.length>0?"select":"input",$options:i.map(function(d){return{label:d,value:d}}),$defaultValue:fe(r,"defaultValue"),$required:Me(r),minimum:s,$minimumMessage:l,maximum:re(r)};Ee(n,"properties/attrs/properties/".concat(e),g)}),(a.inputs||[]).forEach(function(r){var e=r.name,t={id:e,type:"object",title:e,description:r.desc,$componentType:"tableConfig",$inputTableConfig:{types:r.types,attrs:(r.attrs||[]).map(function(o){return o.name})}};Ee(n,"properties/inputs/properties/".concat(e),t)}),(a.outputs||[]).forEach(function(r){var e=r.name,t={id:["output",e],type:"string",description:r.desc,title:e,$required:!0};Ee(n,"properties/outputs/properties/".concat(e),t)}),n},lt=c(86222),Ze=c.n(lt),ut=c(45332),se=c.n(ut),Ge=c(18011),L=c(18252),H=c(91280),F=c(26281),p=c(31549),Jr={span:8},Xr={offset:4,span:12},Yr=[{key:"features"},{key:"feature_types"},{key:"labels"},{key:"label_types"},{key:"ids"},{key:"id_types"}],Qr=function(a){var n=a.value,r=a.onChange,e=function(o){var i,s=o;return n==null||(i=n[s])===null||i===void 0?void 0:i.join(",")};return(0,p.jsx)("span",{className:"schema-selector",children:Yr.map(function(t){return(0,p.jsx)(K.Z.Item,{labelCol:Jr,wrapperCol:Xr,label:t.key,children:(0,p.jsx)(te.Z,{defaultValue:e(t.key),onChange:function(i){r&&r(S()({},t.key,i.target.value.split(",")))}})},t.key)})})},qr=function(a){var n=(0,A.useState)(),r=se()(n,2),e=r[0],t=r[1],o=function(){var d=O()(f()().mark(function h(){var y,m,C,N,v,k,P,z;return f()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return y=[],m="api/nodes",C={method:"GET"},B.next=5,(0,F.WY)(m,C);case 5:N=B.sent,v=Ze()(N),B.prev=7,v.s();case 9:if((k=v.n()).done){B.next=17;break}return P=k.value,B.next=13,(0,F.WY)("api/contents",{method:"GET"},P.id);case 13:z=B.sent,y.push({label:P.name,value:P.name,children:z.content.filter(function(ie){return ie.name.endsWith(".csv")}).map(function(ie){return{label:ie.name,value:ie.name}})});case 15:B.next=9;break;case 17:B.next=22;break;case 19:B.prev=19,B.t0=B.catch(7),v.e(B.t0);case 22:return B.prev=22,v.f(),B.finish(22);case 25:t(y);case 26:case"end":return B.stop()}},h,null,[[7,19,22,25]])}));return function(){return d.apply(this,arguments)}}();(0,A.useEffect)(function(){o()},[]);var i=function(h){var y,m=(((y=a.value)===null||y===void 0?void 0:y.data_ref)||[])[h];return m?[m.party,m.uri]:[]},s=function(h){var y,m=((y=a.value)===null||y===void 0?void 0:y.data_ref)||[];if(m.length>1){var C;return(C=a.value)===null||C===void 0||(C=C.schemas)===null||C===void 0?void 0:C[h]}else if(m.length===1){var N;return(N=a.value)===null||N===void 0?void 0:N.schema}},l=function(h,y){if(a.onChange)if(y&&y.length===2){var m,C=se()(y,2),N=C[0],v=C[1],k=((m=a.value)===null||m===void 0?void 0:m.data_ref)||[];k[h]={uri:v,party:N},a.onChange(j()(j()({},a.value),{},{data_ref:k}))}else{var P,z=((P=a.value)===null||P===void 0?void 0:P.data_ref)||[];z.splice(h,1),a.onChange(j()(j()({},a.value),{},{data_ref:z}))}},g=function(h,y){if(a.onChange){var m,C=((m=a.value)===null||m===void 0?void 0:m.data_ref)||[];if(C.length>1){var N,v=((N=a.value)===null||N===void 0?void 0:N.schemas)||[];v[h]=j()(j()({},v[h]),y),a.onChange(j()(j()({},a.value),{},{schemas:v,schema:void 0}))}else if(C.length===1){var k;a.onChange(j()(j()({},a.value),{},{schema:j()(j()({},(k=a.value)===null||k===void 0?void 0:k.schema),y),schemas:void 0}))}}};return(0,p.jsx)("span",{children:e==null?void 0:e.map(function(d,h){return(0,p.jsx)("span",{className:"table-selector",children:d.children.length>0?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Ge.Z,{defaultValue:i(h),options:e,onChange:function(m){return l(h,m)}}),(0,p.jsx)(L.Z,{content:(0,p.jsx)(Qr,{value:s(h),onChange:function(m){return g(h,m)}}),placement:"right",title:"",overlayClassName:"secretnote-table-selector-popover",trigger:"click",arrow:!1,children:(0,p.jsx)(H.Z,{size:14,cursor:"pointer"})})]}):(0,p.jsx)("span",{className:"no-table",children:"No table to choose."},d.value)},d.value)})})},Pe={span:8},Le={offset:4,span:12},ea={tableConfig:function(a){var n=a.root,r=De(n,"$inputTableConfig/types"),e=De(n,"$inputTableConfig/attrs"),t=function(){var s=a.form.getFieldValue(["input",n.id,"type"]);if(s)return s.split(".")[1]},o=t();return(0,p.jsxs)(K.Z.Item,{label:n.id,labelCol:{span:24},wrapperCol:{offset:1},className:"table-config-item",children:[(0,p.jsx)(K.Z.Item,{label:"type",name:["input",n.id,"type"],labelCol:Pe,wrapperCol:Le,children:(0,p.jsx)(ce.Z,{options:r.map(function(i){return{label:i,value:i}})})}),e.map(function(i){return(0,p.jsx)(K.Z.Item,{label:i,name:"input/".concat(n.id,"/").concat(i),labelCol:Pe,wrapperCol:Le,children:(0,p.jsx)(te.Z,{})},i)}),o==="table"&&(0,p.jsx)(K.Z.Item,{label:"tables",name:["input",n.id,"tables"],labelCol:Pe,wrapperCol:Le,dependencies:["input",n.id,"type"],children:(0,p.jsx)(qr,{})}),o==="model"&&(0,p.jsx)(K.Z.Item,{label:"model",name:["input",n.id,"model"],labelCol:Pe,wrapperCol:Le,dependencies:["input",n.id,"type"],children:(0,p.jsx)(te.Z,{})}),o==="rule"&&(0,p.jsx)(K.Z.Item,{label:"rule",name:["input",n.id,"rule"],labelCol:Pe,wrapperCol:Le,dependencies:["input",n.id,"type"],children:(0,p.jsx)(te.Z,{})})]},n.id)}},gt=(0,A.forwardRef)(function(u,a){return(0,p.jsx)("div",{className:"component-form",children:(0,p.jsx)(ee.ZP,{ref:a,json:ot(u.config),value:u.defaultValue,customComponent:ea,formOptions:{size:"small",layout:"horizontal",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:12,offset:4},initialValues:u.defaultValue,onValuesChange:function(r,e){var t;console.log(e),(t=u.onValuesChange)===null||t===void 0||t.call(u,r,e)}}})})});gt.displayName="ComponentForm";var ta=c(80117),na=c(84176),ra=c.n(na),aa=["input","output"],ia={runtime_config:{protocol:"REF2K",field:"FM64"},link_desc:{connect_retry_times:60,connect_retry_interval_ms:1e3,brpc_channel_protocol:"http",brpc_channel_connection_type:"pooled",recv_timeout_ms:12e5,http_timeout_ms:12e5}},bt=8e3,yt=8001,sa={public_config:{ray_fed_config:{parties:["alice","bob"],addresses:["alice:".concat(bt),"bob:".concat(bt)]},spu_configs:[{name:"spu",parties:["alice","bob"],addresses:["alice:".concat(yt),"bob:".concat(yt)]}]},private_config:{self_party:"{self_party}",ray_head_addr:"127.0.0.1:6379"},desc:{parties:["alice","bob"],devices:[{name:"spu",type:"spu",parties:["alice","bob"],config:JSON.stringify(ia)},{name:"heu",type:"heu",parties:[],config:JSON.stringify({mode:"PHEU",schema:"paillier",key_size:2048})}]}},oa=function(a,n,r){var e=(a.attrs||[]).find(function(o){return o.name===n});if(e){var t=e.type;switch(t){case"AT_INT":return{i64:r};case"AT_BOOL":return{b:r};case"AT_STRING":return{s:r};case"AT_FLOAT":return{f:r};default:return{s:r}}}else return{ss:(r||"").split(",")}},la=function(a){var n={"sf.table.individual":"secretflow.spec.v1.IndividualTable","sf.table.vertical_table":"secretflow.spec.v1.VerticalTable","sf.rule.binning":"secretflow.spec.extend.DeviceObjectCollection","sf.model.sgb":"secretflow.spec.extend.DeviceObjectCollection","sf.model.ss_glm":"secretflow.spec.extend.DeviceObjectCollection","sf.model.ss_sgd":"secretflow.spec.extend.DeviceObjectCollection","sf.model.ss_xgb":"secretflow.spec.extend.DeviceObjectCollection","sf.report":"secretflow.spec.v1.Report"};return n[a]?"type.googleapis.com/".concat(n[a]):""},ua=["feature.vert_binning","feature.vert_woe_binning","ml.train.ss_xgb_train","ml.train.ss_glm_train","ml.train.ss_sgd_train","ml.train.sgb_train"],Ct=function(a,n){if(!(a&&n))return"";var r=Symbol("__extra"),e=S()(S()(S()(S()(S()(S()(S()(S()({},r,{}),"domain",a.domain),"name",a.name),"version",a.version),"attr_paths",[]),"attrs",[]),"inputs",[]),"output_uris",[]),t=n.input,o=n.output,i=ra()(n,aa);i&&Object.entries(i).forEach(function(d){var h=se()(d,2),y=h[0],m=h[1];e.attr_paths.push(y);var C=oa(a,y,m);e.attrs.push(C)}),t&&Object.entries(t).forEach(function(d){var h=se()(d,2),y=h[0],m=h[1],C=m,N=C.type;if(N){var v=N.split(".")[1];switch(v){case"table":{var k=m.tables,P=N==="sf.table.individual"?"schema":"schemas";k&&e.inputs.push({name:y,type:N,data_refs:k.data_ref.map(function(B){return{uri:B.uri,party:B.party,format:"csv"}}),meta:S()(S()({"@type":la(N)},P,k[P]),"line_count",-1)});break}case"model":{var z=m.model;z&&(e[r].model=z);break}case"rule":{var W=m.rule;W&&(e[r].rule=W);break}case"report":throw new Error("Report is not expected to be used as input.")}}}),o&&Object.entries(o).forEach(function(d){var h=se()(d,2),y=h[1];e.output_uris.push(y)});var s=ua.includes("".concat(e.domain,".").concat(e.name))?Ie()(e.output_uris):void 0,l=s?"".concat(s.join(" = ")," = None"):"",g=s?"global ".concat(s.join(", "),`
`)+s.map(function(d,h){return"  ".concat(d," = res.outputs[").concat(h,"]")}).join(`
`):"";return`
`.concat(l,`
def __run_component(): # limit the scope to avoid polluting global
  from secretflow.spec.v1.evaluation_pb2 import NodeEvalParam
  from secretflow.spec.v1.data_pb2 import StorageConfig
  from secretflow.spec.extend.cluster_pb2 import SFClusterConfig
  from secretflow.component.entry import comp_eval
  from google.protobuf.json_format import Parse, MessageToJson
  from ipykernel.comm import Comm
  import os

  cluster_config_str = r"""
  `).concat(JSON.stringify(sa),`
  """

  component_config_str = r"""
  `).concat(JSON.stringify(e),`
  """

  self_party = os.getenv("SELF_PARTY", "alice")
  cluster_config = SFClusterConfig()
  Parse(cluster_config_str.replace('{self_party}', self_party), cluster_config)

  node_eval_config = NodeEvalParam()
  Parse(component_config_str, node_eval_config)
  `).concat(e[r].model?"node_eval_config.inputs.insert(0, ".concat(e[r].model,")"):"",`
  `).concat(e[r].rule?"node_eval_config.inputs.append(".concat(e[r].rule,")"):"",`
  
  storage_config = StorageConfig(
      type="local_fs",
      local_fs=StorageConfig.LocalFSConfig(wd=os.getcwd()),
  )

  res = comp_eval(node_eval_config, storage_config, cluster_config)

  print(f"The execution is complete and the result is: \\n{res}")

  `).concat(g,`

  Comm().send(data={"$type": "component-cell.result", "payload": MessageToJson(res, indent=0)})

__run_component()
    `).trim()},wt=c(86919),kt=JSON.parse(`{"$9":[{"domain":"preprocessing","name":"vert_bin_substitution","desc":"Substitute datasets' value by bin substitution rules.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Vertical partitioning dataset to be substituted.","types":["sf.table.vertical_table"]},{"name":"bin_rule","desc":"Input bin substitution rule.","types":["sf.rule.binning"]}],"outputs":[{"name":"output_data","desc":"Output vertical table.","types":["sf.table.vertical_table"]}]},{"domain":"feature","name":"vert_binning","desc":"Generate equal frequency or equal range binning rules for vertical partitioning datasets.","version":"0.0.1","attrs":[{"name":"binning_method","desc":"How to bin features with numeric types: \\"quantile\\"(equal frequency)/\\"eq_range\\"(equal range)","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"eq_range"},"allowedValues":{"ss":["eq_range","quantile"]}}},{"name":"bin_num","desc":"Max bin counts for one features.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{}}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"which features should be binned.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"bin_rule","desc":"Output bin rule.","types":["sf.rule.binning"]}]},{"domain":"feature","name":"vert_woe_binning","desc":"Generate Weight of Evidence (WOE) binning rules for vertical partitioning datasets.","version":"0.0.1","attrs":[{"name":"secure_device_type","desc":"Use SPU(Secure multi-party computation or MPC) or HEU(Homomorphic encryption or HE) to secure bucket summation.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"spu"},"allowedValues":{"ss":["spu","heu"]}}},{"name":"binning_method","desc":"How to bin features with numeric types: \\"quantile\\"(equal frequency)/\\"chimerge\\"(ChiMerge from AAAI92-019: https://www.aaai.org/Papers/AAAI/1992/AAAI92-019.pdf)","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"quantile"},"allowedValues":{"ss":["quantile","chimerge"]}}},{"name":"bin_num","desc":"Max bin counts for one features.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"positive_label","desc":"Which value represent positive value in label.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"1"}}},{"name":"chimerge_init_bins","desc":"Max bin counts for initialization binning in ChiMerge.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"100"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"}}},{"name":"chimerge_target_bins","desc":"Stop merging if remaining bin counts is less than or equal to this value.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"},"lowerBoundInclusive":true}},{"name":"chimerge_target_pvalue","desc":"Stop merging if biggest pvalue of remaining bins is greater than this value.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"which features should be binned.","colMinCntInclusive":"1"},{"name":"label","desc":"Label of input data.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"bin_rule","desc":"Output WOE rule.","types":["sf.rule.binning"]}]},{"domain":"ml.eval","name":"biclassification_eval","desc":"Statistics evaluation for a bi-classification model on a dataset.\\n1. summary_report: SummaryReport\\n2. group_reports: List[GroupReport]\\n3. eq_frequent_bin_report: List[EqBinReport]\\n4. eq_range_bin_report: List[EqBinReport]\\n5. head_report: List[PrReport]\\nreports for fpr = 0.001, 0.005, 0.01, 0.05, 0.1, 0.2","version":"0.0.1","attrs":[{"name":"bucket_size","desc":"Number of buckets.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"min_item_cnt_per_bucket","desc":"Min item cnt per bucket. If any bucket doesn't meet the requirement, error raises. For security reasons, we require this parameter to be at least 5.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"5"},"lowerBoundInclusive":true}}],"inputs":[{"name":"in_ds","desc":"Input table with predictions.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"label","desc":"Label column name of input data.","colMaxCntInclusive":"1"},{"name":"prediction","desc":"Prediction column name of input data.","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"reports","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.eval","name":"prediction_bias_eval","desc":"Calculate prediction bias, ie. average of predictions - average of labels.","version":"0.0.1","attrs":[{"name":"bucket_num","desc":"Num of bucket.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"min_item_cnt_per_bucket","desc":"Min item cnt per bucket. If any bucket doesn't meet the requirement, error raises. For security reasons, we require this parameter to be at least 2.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"2"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"},"lowerBoundInclusive":true}},{"name":"bucket_method","desc":"Bucket method.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"equal_width"},"allowedValues":{"ss":["equal_width","equal_frequency"]}}}],"inputs":[{"name":"in_ds","desc":"Input table with predictions.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"label","desc":"Label column name of input data.","colMaxCntInclusive":"1"},{"name":"prediction","desc":"Prediction column name of input data.","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"result","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.eval","name":"ss_pvalue","desc":"Calculate P-Value for LR model training on vertical partitioning dataset by using secret sharing.\\nFor large dataset(large than 10w samples & 200 features),\\nrecommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_sgd"]},{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"report","desc":"Output P-Value report.","types":["sf.report"]}]},{"domain":"ml.predict","name":"sgb_predict","desc":"Predict using SGB model.","version":"0.0.2","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Name for prediction column","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"model","types":["sf.model.sgb"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_glm_predict","desc":"Predict using the SSGLM model.","version":"0.0.1","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"offset_col","desc":"Specify a column to use as the offset","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_glm"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_sgd_predict","desc":"Predict using the SS-SGD model.","version":"0.0.1","attrs":[{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_sgd"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_xgb_predict","desc":"Predict using the SS-XGB model.","version":"0.0.1","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_xgb"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"saved_features","desc":"Features to save into output pred file.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.train","name":"sgb_train","desc":"Provides both classification and regression tree boosting (also known as GBDT, GBM)\\nfor vertical split dataset setting by using secure boost.\\n- SGB is short for SecureBoost. Compared to its safer counterpart SS-XGB, SecureBoost focused on protecting label holder.\\n- Check https://arxiv.org/abs/1901.08755.","version":"0.0.1","attrs":[{"name":"num_boost_round","desc":"Number of boosting iterations.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"max_depth","desc":"Maximum depth of a tree.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"16"},"upperBoundInclusive":true}},{"name":"learning_rate","desc":"Step size shrinkage used in update to prevent overfitting.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"objective","desc":"Specify the learning objective.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"reg_lambda","desc":"L2 regularization term on weights.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"gamma","desc":"Greater than 0 means pre-pruning enabled. If gain of a node is less than this value, it would be pruned.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"colsample_by_tree","desc":"Subsample ratio of columns when constructing each tree.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"sketch_eps","desc":"This roughly translates into O(1 / sketch_eps) number of bins.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"base_score","desc":"The initial prediction score of all instances, global bias.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"seed","desc":"Pseudorandom number generator seed.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"42"},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"fixed_point_parameter","desc":"Any floating point number encoded by heu, will multiply a scale and take the round, scale = 2 ** fixed_point_parameter. larger value may mean more numerical accuracy, but too large will lead to overflow problem.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"20"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"100"},"upperBoundInclusive":true}},{"name":"first_tree_with_label_holder_feature","desc":"Whether to train the first tree with label holder's own features.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"batch_encoding_enabled","desc":"If use batch encoding optimization.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{"b":true}}},{"name":"enable_quantization","desc":"Whether enable quantization of g and h.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"quantization_scale","desc":"Scale the sum of g to the specified value.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":10000},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000000},"upperBoundInclusive":true}},{"name":"max_leaf","desc":"Maximum leaf of a tree. Only effective if train leaf wise.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"15"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"32768"},"upperBoundInclusive":true}},{"name":"rowsample_by_tree","desc":"Row sub sample ratio of the training instances.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"enable_goss","desc":"Whether to enable GOSS.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"top_rate","desc":"GOSS-specific parameter. The fraction of large gradients to sample.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.3},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"bottom_rate","desc":"GOSS-specific parameter. The fraction of small gradients to sample.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.5},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"early_stop_criterion_g_abs_sum","desc":"If sum(abs(g)) is lower than or equal to this threshold, training will stop.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"early_stop_criterion_g_abs_sum_change_ratio","desc":"If absolute g sum change ratio is lower than or equal to this threshold, training will stop.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"tree_growing_method","desc":"How to grow tree?","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"level"}}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"},{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.sgb"]}]},{"domain":"ml.train","name":"ss_glm_train","desc":"generalized linear model (GLM) is a flexible generalization of ordinary linear regression.\\nThe GLM generalizes linear regression by allowing the linear model to be related to the response\\nvariable via a link function and by allowing the magnitude of the variance of each measurement to\\nbe a function of its predicted value.","version":"0.0.1","attrs":[{"name":"epochs","desc":"The number of complete pass through the training data.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"learning_rate","desc":"The step size at each iteration in one iteration.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"link_type","desc":"link function type","type":"AT_STRING","atomic":{"allowedValues":{"ss":["Logit","Log","Reciprocal","Indentity"]}}},{"name":"label_dist_type","desc":"label distribution type","type":"AT_STRING","atomic":{"allowedValues":{"ss":["Bernoulli","Poisson","Gamma","Tweedie"]}}},{"name":"tweedie_power","desc":"Tweedie distribution power parameter","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":2},"upperBoundInclusive":true}},{"name":"dist_scale","desc":"A guess value for distribution's scale","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{"f":1},"lowerBoundInclusive":true}},{"name":"eps","desc":"If the change rate of weights is less than this threshold, the model is considered to be converged, and the training stops early. 0 to disable.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.0001},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"iter_start_irls","desc":"run a few rounds of IRLS training as the initialization of w, 0 disable","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"decay_epoch","desc":"decay learning interval","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"decay_rate","desc":"decay learning rate","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1}}},{"name":"optimizer","desc":"which optimizer to use: IRLS(Iteratively Reweighted Least Squares) or SGD(Stochastic Gradient Descent)","type":"AT_STRING","atomic":{"allowedValues":{"ss":["SGD","IRLS"]}}},{"name":"offset_col","desc":"Specify a column to use as the offset","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"weight_col","desc":"Specify a column to use for the observation weights","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"},{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_glm"]},{"name":"output_report","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.train","name":"ss_sgd_train","desc":"Train both linear and logistic regression\\nlinear models for vertical partitioning dataset with mini batch SGD training solver by using secret sharing.\\n- SS-SGD is short for secret sharing SGD training.","version":"0.0.1","attrs":[{"name":"epochs","desc":"The number of complete pass through the training data.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"learning_rate","desc":"The step size at each iteration in one iteration.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"sig_type","desc":"Sigmoid approximation type.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"t1"},"allowedValues":{"ss":["real","t1","t3","t5","df","sr","mix"]}}},{"name":"reg_type","desc":"Regression type","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"penalty","desc":"The penalty(aka regularization term) to be used.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"None"},"allowedValues":{"ss":["None","l1","l2"]}}},{"name":"l2_norm","desc":"L2 regularization term.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.5},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"eps","desc":"If the change rate of weights is less than this threshold, the model is considered to be converged, and the training stops early. 0 to disable.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.001},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"},{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_sgd"]}]},{"domain":"ml.train","name":"ss_xgb_train","desc":"This method provides both classification and regression tree boosting (also known as GBDT, GBM)\\nfor vertical partitioning dataset setting by using secret sharing.\\n- SS-XGB is short for secret sharing XGB.\\n- More details: https://arxiv.org/pdf/2005.08479.pdf","version":"0.0.1","attrs":[{"name":"num_boost_round","desc":"Number of boosting iterations.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"max_depth","desc":"Maximum depth of a tree.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"16"},"upperBoundInclusive":true}},{"name":"learning_rate","desc":"Step size shrinkage used in updates to prevent overfitting.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"objective","desc":"Specify the learning objective.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"reg_lambda","desc":"L2 regularization term on weights.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"subsample","desc":"Subsample ratio of the training instances.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"colsample_by_tree","desc":"Subsample ratio of columns when constructing each tree.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"sketch_eps","desc":"This roughly translates into O(1 / sketch_eps) number of bins.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"base_score","desc":"The initial prediction score of all instances, global bias.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"seed","desc":"Pseudorandom number generator seed.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"42"},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Features to be trained with.","colMinCntInclusive":"1"},{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_xgb"]}]},{"domain":"data_filter","name":"feature_filter","desc":"Drop features from the dataset.","version":"0.0.1","inputs":[{"name":"in_ds","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"drop_features","desc":"Features to drop."}]}],"outputs":[{"name":"out_ds","desc":"Output vertical table.","types":["sf.table.vertical_table"]}]},{"domain":"data_prep","name":"psi","desc":"PSI between two parties.","version":"0.0.1","attrs":[{"name":"protocol","desc":"PSI protocol.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"ECDH_PSI_2PC"},"allowedValues":{"ss":["ECDH_PSI_2PC","KKRT_PSI_2PC","BC22_PSI_2PC"]}}},{"name":"sort","desc":"Sort the output.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"bucket_size","desc":"Specify the hash bucket size used in PSI. Larger values consume more memory.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1048576"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"ecdh_curve_type","desc":"Curve type for ECDH PSI.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"CURVE_FOURQ"},"allowedValues":{"ss":["CURVE_25519","CURVE_FOURQ","CURVE_SM2","CURVE_SECP256K1"]}}}],"inputs":[{"name":"receiver_input","desc":"Individual table for receiver","types":["sf.table.individual"],"attrs":[{"name":"key","desc":"Column(s) used to join.","colMinCntInclusive":"1"}]},{"name":"sender_input","desc":"Individual table for sender","types":["sf.table.individual"],"attrs":[{"name":"key","desc":"Column(s) used to join.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"psi_output","desc":"Output vertical table","types":["sf.table.vertical_table"]}]},{"domain":"data_prep","name":"train_test_split","desc":"Split datasets into random train and test subsets.\\n- Please check: https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html","version":"0.0.1","attrs":[{"name":"train_size","desc":"Proportion of the dataset to include in the train subset.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.75},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"test_size","desc":"Proportion of the dataset to include in the test subset.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.25},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"random_state","desc":"Specify the random seed of the shuffling.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"shuffle","desc":"Whether to shuffle the data before splitting.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{"b":true}}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"train","desc":"Output train dataset.","types":["sf.table.vertical_table"]},{"name":"test","desc":"Output test dataset.","types":["sf.table.vertical_table"]}]},{"domain":"stats","name":"groupby_statistics","desc":"Get a groupby of statistics, like pandas groupby statistics.\\nCurrently only support VDataframe.","version":"0.0.1","attrs":[{"name":"agg","desc":"What kind of aggregation statistics we want to do, currently only supports min, max, mean, sum, var, count(number of elements in each group)","type":"AT_STRING","atomic":{"allowedValues":{"ss":["min","max","mean","sum","var","count"]}}},{"name":"max_group_size","desc":"The maximum number of groups allowed","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10000"},"lowerBoundEnabled":true,"lowerBound":{}}}],"inputs":[{"name":"input_data","desc":"Input table.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"by","desc":"by what columns should we group the values","colMinCntInclusive":"1","colMaxCntInclusive":"4"},{"name":"values","desc":"on which columns should we calculate the statistics","colMinCntInclusive":"1"}]}],"outputs":[{"name":"report","desc":"Output groupby statistics report.","types":["sf.report"]}]},{"domain":"stats","name":"ss_pearsonr","desc":"Calculate Pearson's product-moment correlation coefficient for vertical partitioning dataset\\nby using secret sharing.\\n- For large dataset(large than 10w samples & 200 features), recommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Specify which features to calculate correlation coefficient with. If empty, all features will be used"}]}],"outputs":[{"name":"report","desc":"Output Pearson's product-moment correlation coefficient report.","types":["sf.report"]}]},{"domain":"stats","name":"ss_vif","desc":"Calculate Variance Inflation Factor(VIF) for vertical partitioning dataset\\nby using secret sharing.\\n- For large dataset(large than 10w samples & 200 features), recommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Specify which features to calculate VIF with. If empty, all features will be used."}]}],"outputs":[{"name":"report","desc":"Output Variance Inflation Factor(VIF) report.","types":["sf.report"]}]},{"domain":"stats","name":"table_statistics","desc":"Get a table of statistics,\\nincluding each column's\\n1. datatype\\n2. total_count\\n3. count\\n4. count_na\\n5. min\\n6. max\\n7. var\\n8. std\\n9. sem\\n10. skewness\\n11. kurtosis\\n12. q1\\n13. q2\\n14. q3\\n15. moment_2\\n16. moment_3\\n17. moment_4\\n18. central_moment_2\\n19. central_moment_3\\n20. central_moment_4\\n21. sum\\n22. sum_2\\n23. sum_3\\n24. sum_4\\n- moment_2 means E[X^2].\\n- central_moment_2 means E[(X - mean(X))^2].\\n- sum_2 means sum(X^2).","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input table.","types":["sf.table.vertical_table","sf.table.individual"]}],"outputs":[{"name":"report","desc":"Output table statistics report.","types":["sf.report"]}]}]}`),ca=function(a){var n=[],r=(0,wt.Z)(a,"domain");return Object.keys(r).forEach(function(e){var t=r[e],o={value:e,label:e,children:[]},i=(0,wt.Z)(t,"name");Object.keys(i).forEach(function(s){var l=i[s],g={value:s,label:s,children:[]};l.forEach(function(d){g.children.push({value:d.version,label:d.version,component:d,children:[]})}),o.children.push(g)}),n.push(o)}),n},da=ca(kt.$9),pa=function(a){var n=se()(a,3),r=n[0],e=n[1],t=n[2],o=kt.$9.find(function(i){return i.domain===r&&i.name===e&&i.version===t});return o},fa=function(a){return[a.domain,a.name,a.version]},ma=function(a){var n=a.component,r=a.onComponentChange;return(0,p.jsx)(Ge.Z,{popupClassName:"component-cascader",size:"small",options:da,value:n?[n.domain,n.name,n.version]:[],onChange:function(t,o){var i,s=o==null||(i=o[o.length-1])===null||i===void 0?void 0:i.component;s&&r&&r(s)},placeholder:"Please select a component first."})},St=(0,A.forwardRef)(function(u,a){var n=u.component,r=u.onComponentChange,e=u.defaultComponentConfig,t=u.onComponentConfigChange,o=u.outputs,i=u.report,s=u.loading,l=(0,A.useMemo)(function(){var m=[];return o.forEach(function(C){C.output_type==="stream"?C.text&&m.push(C.text):C.output_type==="error"&&C.traceback&&m.push(C.traceback.join(""))}),(0,p.jsx)(ta.default,{code:m,theme:"light"})},[o]),g=i?[{key:"1",label:"report.name",children:i.name},{key:"2",label:"report.meta.name",children:i.metaName},{key:"3",label:"report.meta.desc",children:i.metaDesc}]:[],d=i?[{title:"",dataIndex:"$key",key:-1,rowScope:"row"}].concat(Ie()(i.metaColumnNames.map(function(m,C){return{title:m,dataIndex:m,key:m}}))):[],h=i?function(){for(var m=[],C=function(k){var P={$key:i.metaRowNames[k]};i.metaColumnNames.forEach(function(z,W){P[z]=Object.values(i.metaRowItems[k][W])[0]}),m.push(j()({},P))},N=0;N<i.metaRowItems.length;N++)C(N);return m}():[],y=[{key:"1",label:"Log",children:(0,p.jsx)("div",{className:"sf-component-log",children:s?(0,p.jsx)("div",{className:"loading",children:(0,p.jsx)(V.Z,{})}):l})},{key:"2",label:"Report",children:(0,p.jsx)("div",{className:"sf-component-report",children:i?(0,p.jsxs)("div",{children:[(0,p.jsx)(T.Z,{items:g}),(0,p.jsx)(D.Z,{columns:d,dataSource:h,pagination:!1,virtual:!0})]}):(0,p.jsx)(Z.Z,{image:Z.Z.PRESENTED_IMAGE_SIMPLE,description:"No report."})})}];return(0,p.jsxs)("div",{className:"component-cell-container",children:[(0,p.jsxs)("div",{className:"header",children:[(0,p.jsx)("span",{children:"component:"}),(0,p.jsx)(ma,{component:n,onComponentChange:function(C){r&&r(C)}})]}),(0,p.jsxs)("div",{className:"body",children:[(0,p.jsx)("div",{className:"config",children:n?(0,p.jsx)(gt,{config:n,ref:a,defaultValue:e,onValuesChange:t}):(0,p.jsx)(Z.Z,{image:Z.Z.PRESENTED_IMAGE_SIMPLE,description:"Select a component first.",style:{marginTop:120}})}),(0,p.jsx)("div",{className:"result",children:(0,p.jsx)(J.Z,{defaultActiveKey:"1",items:y,size:"small"})})]})]})});St.displayName="CellComponent";var Tt,Ot,Bt,It,Nt,At,Mt,xt,Et,jt,Vt,_t,Rt,Ft,ne,je,Pt,Lt,Kt,zt,Dt=(0,A.forwardRef)(function(u,a){var n=(0,E.oC)(be.yd);return(0,p.jsx)("div",{tabIndex:10,ref:a,className:"sf-component-container",onFocus:function(){n.focus(!0)},onBlur:function(e){var t;typeof a!="function"&&!(a!=null&&(t=a.current)!==null&&t!==void 0&&t.contains(e.relatedTarget))&&n.blur()},children:(0,p.jsx)(St,{loading:n.launching,outputs:n.cellModel.outputs,report:n.cellModel.report,component:n.component,onComponentChange:function(e){n.onComponentChange(e)},defaultComponentConfig:n.defaultComponentConfig,onComponentConfigChange:function(e,t){n.onComponentConfigChange(t)}})})});Dt.displayName="SFComponentCellComponent";var Zt=(Tt=(0,I.H3)(),Ot=(0,Ne.ei)("sf-component-cell-view"),Bt=function(a,n){return(0,I.f3)(be.Hj)(a,void 0,0)},It=function(a,n){return(0,I.f3)(b.xxA)(a,void 0,1)},Nt=function(a,n){return(0,I.f3)(ye.H)(a,void 0,2)},At=Reflect.metadata("design:type",Function),Mt=Reflect.metadata("design:paramtypes",[typeof CellViewOptions=="undefined"?Object:CellViewOptions,typeof b.xxA=="undefined"?Object:b.xxA,typeof ye.H=="undefined"?Object:ye.H]),xt=(0,E.vg)(),Et=Reflect.metadata("design:type",typeof ComponentSpec=="undefined"?Object:ComponentSpec),jt=(0,E.vg)(),Vt=Reflect.metadata("design:type",typeof Value=="undefined"?Object:Value),_t=(0,E.vg)(),Rt=Reflect.metadata("design:type",typeof Value=="undefined"?Object:Value),Ft=(0,E.vg)(),Tt(ne=Ot(ne=Bt(ne=It(ne=Nt(ne=At(ne=Mt(ne=(je=function(u){he()(n,u);var a=ge()(n);function n(r,e,t){var o;return Q()(this,n),o=a.call(this,r,e),S()(w()(o),"view",Dt),S()(w()(o),"commandRegistry",void 0),S()(w()(o),"outputArea",{outputs:[]}),G()(w()(o),"component",Pt,w()(o)),G()(w()(o),"componentConfigValue",Lt,w()(o)),G()(w()(o),"defaultComponentConfig",Kt,w()(o)),G()(w()(o),"launching",zt,w()(o)),S()(w()(o),"onComponentChange",function(i){o.component=i,o.componentConfigValue={},o.cellModel.outputs=[],o.cellModel.metadata.component={id:fa(i),params:{}},o.cellModel.outputs=[]}),S()(w()(o),"onComponentConfigChange",function(i){o.componentConfigValue=i;var s=o.cellModel.metadata;s&&s.component&&(s.component.params=i),o.save()}),o.commandRegistry=t,o}return q()(n,[{key:"cellModel",get:function(){return this.model}},{key:"onViewMount",value:function(){var e=this.cellModel.metadata;if(e.component){var t=e.component,o=t.id,i=t.params;this.component=pa(o),this.defaultComponentConfig=i,this.componentConfigValue=i}}},{key:"save",value:function(){this.commandRegistry.executeCommand(b.Xa6.Save.id)}},{key:"run",value:function(){var r=O()(f()().mark(function t(){var o=this,i,s,l,g,d,h,y,m,C;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(i=this.getKernelConnections(),i.length!==0){v.next=3;break}return v.abrupt("return",!1);case 3:if(!(!this.component||!this.componentConfigValue)){v.next=6;break}return R.ZP.error(M.U6.t("Please select a component first.")),v.abrupt("return",!1);case 6:for(this.clearExecution(),this.cellModel.outputs=[],v.prev=8,this.cellModel.executing=!0,this.launching=!0,s=[],l=0,g=i.length;l<g;l+=1)d=i[l],h=d.requestExecute({code:Ct(this.component,this.componentConfigValue)}),h.onIOPub=function(k){o.handleMessages(k),k.header.msg_type==="execute_input"&&(o.cellModel.kernelExecuting=!0)},h.onReply=function(k){o.handleMessages(k)},s.push(h.done);return v.next=15,Promise.all(s);case 15:if(y=v.sent,this.cellModel.kernelExecuting=!1,this.cellModel.executing=!1,m=y.every(function(k){return k.content.status==="ok"}),!m){v.next=24;break}return this.save(),v.abrupt("return",!0);case 24:if(C=y.find(function(k){return k.content.status!=="ok"}),!C){v.next=27;break}throw new b.e__(C.content);case 27:return v.abrupt("return",!1);case 28:v.next=35;break;case 30:if(v.prev=30,v.t0=v.catch(8),!(v.t0 instanceof Error&&v.t0.message.startsWith("Canceled"))){v.next=34;break}return v.abrupt("return",!1);case 34:throw v.t0;case 35:return v.prev=35,this.launching=!1,v.finish(35);case 38:case"end":return v.stop()}},t,this,[[8,30,35,38]])}));function e(){return r.apply(this,arguments)}return e}()},{key:"getKernelConnections",value:function(){var e=this.parent.model;return e?(0,E.P$)(e.kernelConnections):[]}},{key:"handleMessages",value:function(e){if(this.launching=!1,(0,b.HXF)(e)||(0,b.aL4)(e)){var t=j()(j()({},e.content),{},{output_type:e.header.msg_type});this.cellModel.outputs=[].concat(Ie()(this.cellModel.outputs),[t])}if((0,b.TuP)(e)){var o;if(((o=e.content.data)===null||o===void 0?void 0:o.$type)==="component-cell.result"){var i,s=JSON.parse(((i=e.content.data)===null||i===void 0?void 0:i.payload)||"{}"),l=s.outputs.filter(function(m){return m.type==="sf.report"});if(l.length){var g,d=l[0],h=((g=d.meta)===null||g===void 0||(g=g.tabs)===null||g===void 0||(g=g[0])===null||g===void 0||(g=g.divs)===null||g===void 0||(g=g[0])===null||g===void 0||(g=g.children)===null||g===void 0?void 0:g[0])||{},y={name:d.name,metaName:d.meta.name,metaDesc:d.meta.desc};h.type==="table"?this.cellModel.report=j()(j()({},y),{},{metaColumnNames:h.table.headers.map(function(m){return m.name}),metaRowNames:h.table.rows.map(function(m){return m.name}),metaRowItems:h.table.rows.map(function(m){return m.items})}):h.type==="descriptions"?this.cellModel.report=j()(j()({},y),{},{metaColumnNames:["value"],metaRowNames:h.descriptions.items.map(function(m){return m.name}),metaRowItems:h.descriptions.items.map(function(m){return[m.value]})}):this.cellModel.report=j()(j()({},y),{},{metaColumnNames:[],metaRowNames:[],metaRowItems:[]})}}}}},{key:"toJSON",value:function(){var e=this.component&&this.componentConfigValue?Ct(this.component,this.componentConfigValue):"";return{id:this.cellModel.id,cell_type:"component",source:e,metadata:this.cellModel.metadata,outputs:this.cellModel.outputs,report:this.cellModel.report}}},{key:"focus",value:function(e){e&&(this.cellModel.isEdit=!0)}},{key:"blur",value:function(){this.cellModel.isEdit=!1}},{key:"shouldEnterEditorMode",value:function(){return this.cellModel.isEdit}}]),n}(b.XCr),Pt=x()(je.prototype,"component",[xt,Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=x()(je.prototype,"componentConfigValue",[jt,Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=x()(je.prototype,"defaultComponentConfig",[_t,Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=x()(je.prototype,"launching",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),je))||ne)||ne)||ne)||ne)||ne)||ne)||ne),Gt,Ut,$t,Ht,ke,va=(Gt=(0,I.ri)({contrib:[b.SqL,b.GDy]}),Ut=function(a,n){return(0,I.f3)(xe)(a,void 0,0)},$t=Reflect.metadata("design:type",Function),Ht=Reflect.metadata("design:paramtypes",[typeof xe=="undefined"?Object:xe]),Gt(ke=Ut(ke=$t(ke=Ht(ke=function(){function u(a){Q()(this,u),S()(this,"modelFactory",void 0),S()(this,"cellMeta",{type:"component",name:"Component",order:"c",nbformatType:"raw"}),S()(this,"view",Zt),this.modelFactory=a}return q()(u,[{key:"canHandle",value:function(n,r){return r===this.cellMeta.type?1e3:-1}},{key:"createModel",value:function(){var a=O()(f()().mark(function r(e){var t;return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=this.modelFactory(e),i.abrupt("return",t);case 2:case"end":return i.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()}]),u}())||ke)||ke)||ke)||ke),ha=c(60373),Wt,Jt,Xt,Yt,Qt,qt,en,tn,nn,rn,an,sn,on,ln,un,cn,dn,Se,we,pn,fn,mn,vn,hn,gn,bn,yn=(Wt=(0,I.H3)(),Jt=function(a,n){return(0,I.f3)(b.seq)(a,void 0,0)},Xt=Reflect.metadata("design:type",Function),Yt=Reflect.metadata("design:paramtypes",[typeof b.seq=="undefined"?Object:b.seq]),Qt=(0,E.vg)(),qt=(0,E.vg)(),en=Reflect.metadata("design:type",Boolean),tn=(0,E.vg)(),nn=Reflect.metadata("design:type",Boolean),rn=(0,E.vg)(),an=Reflect.metadata("design:type",typeof ExecutionCount=="undefined"?Object:ExecutionCount),sn=(0,E.vg)(),on=Reflect.metadata("design:type",typeof Partial=="undefined"?Object:Partial),ln=(0,E.vg)(),un=Reflect.metadata("design:type",Array),cn=(0,E.vg)(),dn=Reflect.metadata("design:type",typeof ComponentReport=="undefined"?Object:ComponentReport),Wt(Se=Jt(Se=Xt(Se=Yt(Se=(we=function(u){he()(n,u);var a=ge()(n);function n(r){var e;return Q()(this,n),e=a.call(this,r),S()(w()(e),"mimeType","application/vnd.libro.component+json"),S()(w()(e),"hasOutputHidden",!1),S()(w()(e),"hasOutputsScrolled",!1),G()(w()(e),"isEdit",pn,w()(e)),G()(w()(e),"executing",fn,w()(e)),G()(w()(e),"kernelExecuting",mn,w()(e)),G()(w()(e),"executeCount",vn,w()(e)),S()(w()(e),"msgChangeEmitter",void 0),G()(w()(e),"metadata",hn,w()(e)),G()(w()(e),"outputs",gn,w()(e)),G()(w()(e),"report",bn,w()(e)),e.executing=!1,e.kernelExecuting=!1,e.msgChangeEmitter=new ha.Q5,e.metadata=r.cell.metadata||{},e.outputs=r.cell.outputs||[],e.report=r.cell.report||null,e.value=(0,b.XaW)(r.cell.source),e}return q()(n,[{key:"msgChange",get:function(){return this.msgChangeEmitter.event}},{key:"clearExecution",value:function(){this.metadata={},this.outputs=[],this.executing=!1,this.kernelExecuting=!1,this.executeCount=null}}]),n}(b.KZ9),pn=x()(we.prototype,"isEdit",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fn=x()(we.prototype,"executing",[qt,en],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=x()(we.prototype,"kernelExecuting",[tn,nn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vn=x()(we.prototype,"executeCount",[rn,an],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hn=x()(we.prototype,"metadata",[sn,on],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gn=x()(we.prototype,"outputs",[ln,un],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bn=x()(we.prototype,"report",[cn,dn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),we))||Se)||Se)||Se)||Se),ga=Be.R.create().register(va,Zt,yn,{token:xe,useFactory:function(a){return function(n){var r=a.container.createChild();r.register({token:b.seq,useValue:n});var e=r.get(yn);return e}}}),Ue=c(15306),ba=c(7146),ct=c(92440),U=c(53896),Cn,wn,kn,Sn,Tn,On,Bn,In,X,ae=(Cn=(0,I.ri)(),wn=function(a,n){return(0,I.f3)(b.oeX)(a,void 0,0)},kn=function(a,n){return(0,I.f3)(b.frY)(a,void 0,1)},Sn=function(a,n){return(0,I.f3)(U.CP)(a,void 0,2)},Tn=function(a,n){return(0,I.f3)(b.pv1)(a,void 0,3)},On=function(a,n){return(0,I.f3)(ct.V)(a,void 0,4)},Bn=Reflect.metadata("design:type",Function),In=Reflect.metadata("design:paramtypes",[typeof b.oeX=="undefined"?Object:b.oeX,typeof b.frY=="undefined"?Object:b.frY,typeof U.CP=="undefined"?Object:U.CP,typeof b.pv1=="undefined"?Object:b.pv1,typeof ct.V=="undefined"?Object:ct.V]),Cn(X=wn(X=kn(X=Sn(X=Tn(X=On(X=Bn(X=In(X=function(){function u(a,n,r,e,t){Q()(this,u),S()(this,"file2KernelConnections",new Map),S()(this,"kernelConnection2Server",new Map),S()(this,"sessionRestAPI",void 0),S()(this,"kernelRestAPI",void 0),S()(this,"kernelConnectionFactory",void 0),S()(this,"serverManager",void 0),S()(this,"storageService",void 0),this.sessionRestAPI=a,this.kernelRestAPI=n,this.kernelConnectionFactory=e,this.serverManager=r,this.storageService=t}return q()(u,[{key:"createKernelConnections",value:function(){var a=O()(f()().mark(function r(e){var t=this,o,i,s,l,g,d;return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.serverManager.getServerList();case 2:return o=y.sent.filter(function(m){return m.status==="running"}),i=[],y.next=6,this.storageService.getData(this.storedKey(e),[]);case 6:s=y.sent,l=f()().mark(function m(){var C,N,v,k,P,z;return f()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(C=o[g],N=s.find(function(ie){return ie.serverId===C.id}),!N){B.next=21;break}return k=N.options,P=k.model.id,B.next=7,t.isKernelAlive(P,C);case 7:if(z=B.sent,!z){B.next=14;break}return B.next=11,t.connectToKernel(j()(j()({},k),{},{serverSettings:{baseUrl:(0,F.KP)(C.id),wsUrl:(0,F.Vq)(C.id)}}));case 11:v=B.sent,B.next=19;break;case 14:return B.next=16,t.removeStoredSession(e,N);case 16:return B.next=18,t.createKernelConnection(e,C);case 18:v=B.sent;case 19:B.next=24;break;case 21:return B.next=23,t.createKernelConnection(e,C);case 23:v=B.sent;case 24:v&&(i.push(v),t.kernelConnection2Server.set(v.id,C.id));case 25:case"end":return B.stop()}},m)}),g=0,d=o.length;case 9:if(!(g<d)){y.next=14;break}return y.delegateYield(l(),"t0",11);case 11:g++,y.next=9;break;case 14:return this.file2KernelConnections.set(this.storedKey(e),i),y.abrupt("return",i);case 16:case"end":return y.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"addKernelConnectionOnServer",value:function(){var a=O()(f()().mark(function r(e,t){var o,i;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.createKernelConnection(e,t);case 2:o=l.sent,o&&(this.kernelConnection2Server.set(o.id,t.id),i=this.file2KernelConnections.get(this.storedKey(e))||[],this.file2KernelConnections.set(this.storedKey(e),[].concat(Ie()(i),[o])));case 4:case"end":return l.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"deleteKernelConnectionOnServer",value:function(){var a=O()(f()().mark(function r(e,t){var o=this,i,s,l,g,d;return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.storageService.getData(this.storedKey(e),[]);case 2:if(i=y.sent,s=i.find(function(m){return m.serverId===t.id}),!s){y.next=7;break}return y.next=7,this.removeStoredSession(e,s);case 7:l=this.file2KernelConnections.get(this.storedKey(e)),l&&(g=[],l.forEach(function(m){var C=o.getServerByKernelConnection(m);C&&C.id===t.id&&(o.kernelConnection2Server.delete(m.id),m.shutdown(),g.push(m.id))}),d=l.filter(function(m){return!g.includes(m.id)}),this.file2KernelConnections.set(this.storedKey(e),d));case 9:case"end":return y.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"shutdownKernelConnections",value:function(){var a=O()(f()().mark(function r(e){var t=this,o;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o=this.file2KernelConnections.get(this.storedKey(e)),!o){s.next=6;break}return o.forEach(function(l){t.kernelConnection2Server.delete(l.id),l.shutdown()}),s.next=5,this.clearStoredSessions(e);case 5:this.file2KernelConnections.delete(this.storedKey(e));case 6:case"end":return s.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getKernelConnections",value:function(n){return this.file2KernelConnections.get(this.storedKey(n))||[]}},{key:"getServerByKernelConnection",value:function(n){var r=this.kernelConnection2Server.get(n.id);if(r)return this.serverManager.servers.find(function(e){return e.id===r})}},{key:"createKernelConnection",value:function(){var a=O()(f()().mark(function r(e,t){var o,i,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=this.getDefaultKernelName(e,t),d.next=3,this.sessionRestAPI.startSession({name:e.name,kernel:{kernelName:o},path:e.path,type:e.type},{baseUrl:(0,F.KP)(t.id),wsUrl:(0,F.Vq)(t.id)});case 3:if(i=d.sent,!(!i||!i.kernel)){d.next=6;break}return d.abrupt("return");case 6:return s={model:{id:i.kernel.id,name:i.kernel.name}},d.next=9,this.addStoredSession(e,{sessionId:i.id,serverId:t.id,options:s});case 9:return d.next=11,this.connectToKernel(j()(j()({},s),{},{serverSettings:{baseUrl:(0,F.KP)(t.id),wsUrl:(0,F.Vq)(t.id)}}));case 11:return l=d.sent,d.abrupt("return",l);case 13:case"end":return d.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"connectToKernel",value:function(){var a=O()(f()().mark(function r(e){var t;return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=this.kernelConnectionFactory(e),i.abrupt("return",t);case 2:case"end":return i.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"isKernelAlive",value:function(){var a=O()(f()().mark(function r(e,t){var o;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,this.kernelRestAPI.getKernelModel(e,{baseUrl:(0,F.KP)(t.id),wsUrl:(0,F.Vq)(t.id)});case 3:return o=s.sent,s.abrupt("return",!!o);case 7:return s.prev=7,s.t0=s.catch(0),s.abrupt("return",!1);case 10:case"end":return s.stop()}},r,this,[[0,7]])}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"storedKey",value:function(n){return"secretnote_".concat(n.path,"_").concat(n.name)}},{key:"addStoredSession",value:function(){var a=O()(f()().mark(function r(e,t){var o;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.storageService.getData(this.storedKey(e));case 2:return o=s.sent,o?o.push(t):o=[t],s.next=6,this.storageService.setData(this.storedKey(e),o);case 6:case"end":return s.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"removeStoredSession",value:function(){var a=O()(f()().mark(function r(e,t){var o;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.storageService.getData(this.storedKey(e),[]);case 2:return o=s.sent,o=o.filter(function(l){return l.sessionId!==t.sessionId}),s.next=6,this.storageService.setData(this.storedKey(e),o);case 6:case"end":return s.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"clearStoredSessions",value:function(){var a=O()(f()().mark(function r(e){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.storageService.setData(this.storedKey(e),void 0);case 2:case"end":return o.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getDefaultKernelName",value:function(n,r){var e,t,o=((e=n.content.metadata.kernelspec)===null||e===void 0?void 0:e.name)||((t=r.kernelspec)===null||t===void 0?void 0:t.default)||"python3";return o}}]),u}())||X)||X)||X)||X)||X)||X)||X)||X),ya=Be.R.create().register(ae),Nn,An,Mn,xn,En,jn,Vn,_n,Rn,Fn,Pn,Ln,Kn,Y,Ve,zn,Dn,Zn,Gn,Ca=(Nn=(0,I.H3)(),An=function(a,n){return(0,I.f3)(ae)(a,void 0,0)},Mn=function(a,n){return(0,I.f3)(U.CP)(a,void 0,1)},xn=function(a,n){return(0,I.f3)(b.QY6)(a,void 0,2)},En=function(a,n){return(0,I.f3)(Ue.Z)(a,void 0,3)},jn=function(a,n){return(0,I.f3)(ye.H)(a,void 0,4)},Vn=Reflect.metadata("design:type",Function),_n=Reflect.metadata("design:paramtypes",[typeof ae=="undefined"?Object:ae,typeof U.CP=="undefined"?Object:U.CP,typeof b.QY6=="undefined"?Object:b.QY6,typeof Ue.Z=="undefined"?Object:Ue.Z,typeof ye.H=="undefined"?Object:ye.H]),Rn=(0,E.vg)(),Fn=(0,E.vg)(),Pn=Reflect.metadata("design:type",Array),Ln=(0,E.vg)(),Kn=(0,E.vg)(),Nn(Y=An(Y=Mn(Y=xn(Y=En(Y=jn(Y=Vn(Y=_n(Y=(Ve=function(u){he()(n,u);var a=ge()(n);function n(r,e,t,o,i){var s;return Q()(this,n),s=a.call(this),S()(w()(s),"kernelManager",void 0),S()(w()(s),"serverManager",void 0),S()(w()(s),"modalService",void 0),S()(w()(s),"commandRegistry",void 0),S()(w()(s),"currentFileContents",void 0),S()(w()(s),"contentsManager",void 0),G()(w()(s),"kernelConnecting",zn,w()(s)),G()(w()(s),"kernelConnections",Dn,w()(s)),G()(w()(s),"filePath",Zn,w()(s)),G()(w()(s),"lspEnabled",Gn,w()(s)),S()(w()(s),"autoSave",(0,ba.Z)(function(){s.commandRegistry.executeCommand(b.Xa6.Save.id)},500)),s.kernelManager=r,s.serverManager=e,s.contentsManager=t,s.modalService=o,s.commandRegistry=i,s.serverManager.onServerAdded(s.onServerAdded.bind(w()(s))),s.serverManager.onServerDeleted(s.onServerDeleted.bind(w()(s))),s.onChanged(s.autoSave.bind(w()(s))),s}return q()(n,[{key:"isKernelIdle",get:function(){return this.kernelConnections.every(function(e){return e.status==="idle"})}},{key:"kernelConnection",get:function(){return this.kernelConnections[0]}},{key:"startKernelConnection",value:function(){var r=O()(f()().mark(function t(){var o,i;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.kernelConnecting=!0,o=this.currentFileContents,o){l.next=4;break}return l.abrupt("return");case 4:if(i=this.kernelManager.getKernelConnections(o),!(i.length>0)){l.next=10;break}this.kernelConnections=i,this.kernelConnecting=!1,l.next=14;break;case 10:return l.next=12,this.kernelManager.createKernelConnections(o);case 12:this.kernelConnections=l.sent,this.kernelConnecting=!1;case 14:case"end":return l.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"saveNotebookContent",value:function(){var r=O()(f()().mark(function t(){var o,i,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(o=this.toJSON(),this.currentFileContents){d.next=3;break}throw new Error("currentFileContents is undefined");case 3:return d.prev=3,d.next=6,this.contentsManager.save(this.currentFileContents.path,{type:this.currentFileContents.type,content:o,format:this.currentFileContents.format,baseUrl:(0,F.Ue)()});case 6:if(i=d.sent,i){d.next=9;break}return d.abrupt("return");case 9:if(!(i.last_modified===this.currentFileContents.last_modified||i.size===0)){d.next=13;break}throw l="File Save Error: ".concat((s=i)===null||s===void 0?void 0:s.message),this.modalService.openModal(b.l6J),new Error(l);case 13:d.next=21;break;case 15:if(d.prev=15,d.t0=d.catch(3),i){d.next=19;break}return d.abrupt("return");case 19:throw this.modalService.openModal(b.l6J),new Error("File Save Error");case 21:return d.next=23,this.createCheckpoint();case 23:case"end":return d.stop()}},t,this,[[3,15]])}));function e(){return r.apply(this,arguments)}return e}()},{key:"onServerAdded",value:function(){var r=O()(f()().mark(function t(o){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=6;break}return s.next=3,this.kernelManager.addKernelConnectionOnServer(this.currentFileContents,o);case 3:return s.next=5,this.kernelManager.createKernelConnections(this.currentFileContents);case 5:this.kernelConnections=s.sent;case 6:case"end":return s.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"onServerDeleted",value:function(){var r=O()(f()().mark(function t(o){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=6;break}return s.next=3,this.kernelManager.deleteKernelConnectionOnServer(this.currentFileContents,o);case 3:return s.next=5,this.kernelManager.createKernelConnections(this.currentFileContents);case 5:this.kernelConnections=s.sent;case 6:case"end":return s.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"canRun",value:function(){return!0}},{key:"interrupt",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Promise.all(this.kernelConnections.map(function(){var s=O()(f()().mark(function l(g){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,g.interrupt();case 2:case"end":return h.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()));case 2:case"end":return i.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"shutdown",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.currentFileContents){i.next=4;break}return i.next=3,this.kernelManager.shutdownKernelConnections(this.currentFileContents);case 3:this.kernelConnections=[];case 4:case"end":return i.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"restart",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.kernelConnections.length!==0){i.next=5;break}return i.next=3,this.startKernelConnection();case 3:i.next=7;break;case 5:return i.next=7,Promise.all(this.kernelConnections.map(function(){var s=O()(f()().mark(function l(g){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,g.restart();case 2:case"end":return h.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()));case 7:case"end":return i.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"reconnect",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Promise.all(this.kernelConnections.map(function(){var s=O()(f()().mark(function l(g){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,g.reconnect();case 2:case"end":return h.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()));case 2:case"end":return i.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"findRunningCell",value:function(){var e=this.cells.findIndex(function(t){return b.lPh.is(t.model)?t.model.kernelExecuting===!0:!1});e>-1&&(this.selectCell(this.cells[e]),this.scrollToView(this.cells[e]))}},{key:"createCheckpoint",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.currentFileContents){i.next=3;break}return i.next=3,this.contentsManager.createCheckpoint(this.currentFileContents.path,{baseUrl:(0,F.Ue)()});case 3:case"end":return i.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"listCheckpoints",value:function(){var r=O()(f()().mark(function t(){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.currentFileContents){i.next=3;break}return i.next=3,this.contentsManager.listCheckpoints(this.currentFileContents.path,{baseUrl:(0,F.Ue)()});case 3:case"end":return i.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"restoreCheckpoint",value:function(){var r=O()(f()().mark(function t(o){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=3;break}return s.next=3,this.contentsManager.restoreCheckpoint(this.currentFileContents.path,o,{baseUrl:(0,F.Ue)()});case 3:case"end":return s.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"deleteCheckpoint",value:function(){var r=O()(f()().mark(function t(o){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=3;break}return s.next=3,this.contentsManager.deleteCheckpoint(this.currentFileContents.path,o,{baseUrl:(0,F.Ue)()});case 3:case"end":return s.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()}]),n}(b.ero),zn=x()(Ve.prototype,"kernelConnecting",[Rn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Dn=x()(Ve.prototype,"kernelConnections",[Fn,Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Zn=x()(Ve.prototype,"filePath",[Ln],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Gn=x()(Ve.prototype,"lspEnabled",[Kn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ve))||Y)||Y)||Y)||Y)||Y)||Y)||Y)||Y),Un,$n,wa=(Un=(0,I.H3)(),Un($n=function(u){he()(n,u);var a=ge()(n);function n(){return Q()(this,n),a.apply(this,arguments)}return q()(n)}(b.u_T))||$n),dt=c(30393),Ke=c(80155),ka=c(7768),$e=c(65584),Hn=c(41570),Sa=ka.Z.CheckableTag;function Ta(u){var a=u.items,n=u.value,r=u.onChange,e=function(i,s){var l=s?[].concat(Ie()(n),[i]):n.filter(function(g){return g!==i});r&&r(l)},t=function(i){var s=a.filter(function(l){return i.includes(l.key)});return s.length===0?"Select Nodes":s.map(function(l){return l.label}).join(",")};return(0,p.jsx)($e.Z.Ribbon,{text:(0,p.jsx)(L.Z,{placement:"bottomRight",trigger:["click"],overlayStyle:{paddingTop:0},overlayClassName:"secretnote-ribbon-popover",content:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"title",children:[M.U6.t("\u4E0B\u9762\u662F\u5C06\u8981\u6267\u884C\u8BE5\u4EE3\u7801\u7684\u8282\u70B9\u5217\u8868"),":"]}),(0,p.jsx)(Hn.Z,{size:[0,8],wrap:!0,children:a.map(function(o){return(0,p.jsx)(Sa,{checked:n.includes(o.key),onChange:function(s){return e(o.key,s)},children:o.label},o.key)})})]}),children:(0,p.jsx)("span",{className:"secretnote-ribbon",children:t(n)})}),children:u.children})}var Wn,Jn,Xn,Yn,Qn,qn,er,tr,nr,rr,ar,ir,$,pt,sr,or=(0,A.forwardRef)(function(u,a){var n=(0,E.oC)(be.yd),r=n.partyList,e=n.parties;return(0,p.jsx)("div",{className:n.className,ref:a,tabIndex:10,onBlur:n.blur,children:(0,p.jsx)(Ta,{items:r.map(function(t){return{label:t,key:t}}),value:e,onChange:function(o){n.onPartiesChange(o)},children:(0,p.jsx)(b.sUT,{})})})});or.displayName="SecretNoteCodeCellComponent";var ft=[],Oa=(Wn=(0,I.H3)(),Jn=(0,Ne.ei)("secretnote-code-cell-view"),Xn=function(a,n){return(0,I.f3)(be.Hj)(a,void 0,0)},Yn=function(a,n){return(0,I.f3)(b.xxA)(a,void 0,1)},Qn=function(a,n){return(0,I.f3)(dt.v)(a,void 0,2)},qn=function(a,n){return(0,I.f3)(b.fv2)(a,void 0,3)},er=function(a,n){return(0,I.f3)(U.CP)(a,void 0,4)},tr=function(a,n){return(0,I.f3)(ae)(a,void 0,5)},nr=Reflect.metadata("design:type",Function),rr=Reflect.metadata("design:paramtypes",[typeof CellViewOptions=="undefined"?Object:CellViewOptions,typeof b.xxA=="undefined"?Object:b.xxA,typeof dt.v=="undefined"?Object:dt.v,typeof b.fv2=="undefined"?Object:b.fv2,typeof U.CP=="undefined"?Object:U.CP,typeof ae=="undefined"?Object:ae]),ar=(0,E.vg)(),ir=Reflect.metadata("design:type",Array),Wn($=Jn($=Xn($=Yn($=Qn($=qn($=er($=tr($=nr($=rr($=(pt=function(u){he()(n,u);var a=ge()(n);function n(r,e,t,o,i,s){var l;return Q()(this,n),l=a.call(this,r,e,t,o),S()(w()(l),"serverManager",void 0),S()(w()(l),"kernelManager",void 0),S()(w()(l),"view",or),G()(w()(l),"parties",sr,w()(l)),l.serverManager=i,l.kernelManager=s,l.parties=l.getInitializedParties(),l}return q()(n,[{key:"partyList",get:function(){return this.serverManager.servers.filter(function(e){return e.status===U.U$.running}).map(function(e){return e.name})}},{key:"getUsableConnections",value:function(){var e=this,t=this.parent.model;if(!t)return[];var o=(0,E.P$)(t.kernelConnections);return o.filter(function(i){if(i.isDisposed)return!1;var s=e.kernelManager.getServerByKernelConnection(i);return s&&s.status==="running"&&e.parties.includes(s.name)})}},{key:"run",value:function(){var r=O()(f()().mark(function t(){var o=this,i,s,l,g,d,h,y,m,C;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(i=this.model,s=this.getUsableConnections(),s.length!==0){v.next=5;break}return R.ZP.info(M.U6.t("No available node to execute")),v.abrupt("return",!1);case 5:this.clearExecution(),this.updateExecutionStatus({executing:!0}),this.updateExecutionTime({toExecute:new Date().toISOString()}),this.savePartiesToMeta(),v.prev=9,l=[],g=f()().mark(function k(){var P,z;return f()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:P=s[d],z=P.requestExecute({code:i.value}),z.onIOPub=function(ie){ie.header.msg_type==="execute_input"&&(o.updateExecutionStatus({kernelExecuting:!0}),o.updateExecutionTime({start:ie.header.date})),i.msgChangeEmitter.fire({connection:P,msg:ie})},z.onReply=function(ie){i.msgChangeEmitter.fire({connection:P,msg:ie})},l.push(z.done);case 5:case"end":return B.stop()}},k)}),d=0,h=s.length;case 13:if(!(d<h)){v.next=18;break}return v.delegateYield(g(),"t0",15);case 15:d+=1,v.next=13;break;case 18:return v.next=20,Promise.all(l);case 20:if(y=v.sent,this.updateExecutionStatus({executing:!1,kernelExecuting:!1}),this.updateExecutionTime(this.parseMessageTime(y)),m=y.every(function(k){return k.content.status==="ok"}),!m){v.next=28;break}return v.abrupt("return",!0);case 28:if(C=y.find(function(k){return k.content.status!=="ok"}),!C){v.next=31;break}throw new b.e__(C.content);case 31:return v.abrupt("return",!1);case 32:v.next=39;break;case 34:if(v.prev=34,v.t1=v.catch(9),!(v.t1 instanceof Error&&v.t1.message.startsWith("Canceled"))){v.next=38;break}return v.abrupt("return",!1);case 38:throw v.t1;case 39:case"end":return v.stop()}},t,this,[[9,34]])}));function e(){return r.apply(this,arguments)}return e}()},{key:"updateExecutionStatus",value:function(e){var t=e.executing,o=e.kernelExecuting;(0,Ke.Z)(t)||(this.model.executing=t),(0,Ke.Z)(o)||(this.model.kernelExecuting=o)}},{key:"updateExecutionTime",value:function(e){var t=this.model.metadata.execution;if(t){var o=e.start,i=e.end,s=e.toExecute;(0,Ke.Z)(o)||(t["shell.execute_reply.started"]=o),(0,Ke.Z)(i)||(t["shell.execute_reply.end"]=i),(0,Ke.Z)(s)||(t.to_execute=s)}}},{key:"parseMessageTime",value:function(e){var t="",o="";return e.forEach(function(i){var s=i.metadata.started,l=i.header.date;(t===""||(0,F.Id)(s,t)<0)&&(t=s),(o===""||(0,F.Id)(l,o)>0)&&(o=l)}),{start:t,end:o}}},{key:"onPartiesChange",value:function(e){this.parties=e,this.savePartiesToMeta(e),ft=e}},{key:"getInitializedParties",value:function(){var e=this,t=this.model.metadata.execution;if(t&&t.parties)try{var o=JSON.parse(t.parties);return o.filter(function(i){return e.partyList.includes(i)})}catch(i){return[]}else if(ft.length>0)return ft;return this.partyList}},{key:"savePartiesToMeta",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.parties,t=this.model.metadata.execution;t?t.parties=JSON.stringify(e):this.model.metadata.execution={parties:JSON.stringify(e)}}}]),n}(b.qmq),sr=x()(pt.prototype,"parties",[ar,ir],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pt))||$)||$)||$)||$)||$)||$)||$)||$)||$)||$),Ba=c(63011),lr,ur,Ia=(lr=(0,I.ri)({contrib:b.Vij}),lr(ur=function(){function u(){Q()(this,u),S()(this,"canHandle",function(){return 3})}return q()(u,[{key:"loadContent",value:function(){var a=O()(f()().mark(function r(e,t){var o,i,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=t,i=new Ba.o(e.resource),s=i.path.toString(),d.next=5,o.contentsManager.get(s,{baseUrl:(0,F.Ue)(),content:!0});case 5:if(l=d.sent,!l){d.next=12;break}return l.content.nbformat_minor=5,o.currentFileContents=l,o.filePath=l.path,!o.quickEditMode&&!o.readOnly&&o.startKernelConnection(),d.abrupt("return",o.currentFileContents.content);case 12:case"end":return d.stop()}},r)}));function n(r,e){return a.apply(this,arguments)}return n}()}]),u}())||ur),Na=c(78846),Aa=c.n(Na),Ma=c(54088),xa=c.n(Ma),cr,dr,pr,fr,mr,vr,oe,Ea=(cr=(0,I.H3)(),dr=(0,Ne.ei)("libro-output-area"),pr=function(a,n){return(0,I.f3)(be.Hj)(a,void 0,0)},fr=function(a,n){return(0,I.f3)(ae)(a,void 0,1)},mr=Reflect.metadata("design:type",Function),vr=Reflect.metadata("design:paramtypes",[typeof IOutputAreaOption=="undefined"?Object:IOutputAreaOption,typeof ae=="undefined"?Object:ae]),cr(oe=dr(oe=pr(oe=fr(oe=mr(oe=vr(oe=function(u){he()(n,u);var a=ge()(n);function n(r,e){var t;return Q()(this,n),t=a.call(this,r),S()(w()(t),"kernelManager",void 0),S()(w()(t),"connectionId2Message",{}),t.kernelManager=e,t.connectionId2Message={},t.handleMsg(),t}return q()(n,[{key:"handleMsg",value:function(){var e=this,t=this.cell.model;t.msgChangeEmitter.event(function(o){var i=o.connection,s=o.msg;if(s.header.msg_type!=="status"){if(s.header.msg_type==="execute_input"&&(t.executeCount=s.content.execution_count),(0,b.t3d)(s)||(0,b.HXF)(s)||(0,b.aL4)(s)||(0,b.fkE)(s)){var l=j()(j()({},s.content),{},{output_type:s.header.msg_type});e.addOutput(i,l)}if((0,b.vUL)(s)){var g=s.content;if(g.status!=="ok")return;var d=g&&g.payload;if(!d||!d.length)return;var h=d.filter(function(C){return C.source==="page"});if(!h.length)return;var y=JSON.parse(JSON.stringify(h[0])),m={output_type:"display_data",data:y.data,metadata:{}};e.addOutput(i,m)}}})}},{key:"addOutput",value:function(e,t){var o=this.connectionId2Message[e.id]||[];o.length===0&&o.push(this.getBreakOutput(e));var i=o.length-1,s=o[i];if((0,b.eeP)(t)&&(0,b.eeP)(s)&&t.name===s.name){t.text=(0,b.e$h)(s.text+(0,b.Fvn)(t.text)),o[i]=t,this.flushOutputs();return}(0,b.eeP)(t)&&(t.text=(0,b.e$h)((0,b.Fvn)(t.text))),o.push(t),this.connectionId2Message[e.id]=o,this.flushOutputs()}},{key:"flushOutputs",value:function(){var r=O()(f()().mark(function t(){var o=this,i,s;return f()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return i=Object.keys(this.connectionId2Message).length,s=Object.values(this.connectionId2Message).flat(),i<2&&(s=s.filter(function(d){return!d.breakFlag})),this.outputs.forEach(function(d){d.dispose()}),g.next=6,Promise.all(s.map(function(d){return o.doCreateOutput(d)}));case 6:this.outputs=g.sent;case 7:case"end":return g.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"getBreakOutput",value:function(e){var t=this.kernelManager.getServerByKernelConnection(e),o=(t==null?void 0:t.name)||e.clientId,i={output_type:"display_data",data:{"text/html":"<h4>".concat(o,"'s Output:</h4>")},metadata:{},breakFlag:!0};return i}},{key:"clear",value:function(){Aa()(xa()(n.prototype),"clear",this).call(this),this.connectionId2Message={}}}]),n}(b.fZS))||oe)||oe)||oe)||oe)||oe)||oe),ja=Be.R.create().register(Ia,Ea,{token:b.ero,useClass:Ca},{token:b.DHb,useClass:wa},{token:b.iKk,useClass:Oa}).dependOn(b.MDs,U.aB,ya),Va=c(65369),hr=c(85100),_a=c(63778),Ra=c(22825),He=c(79102),gr,br,yr,Cr,wr,kr,Sr,Tr,Or,le,We,Br,Ir,Nr=(gr=(0,I.ri)(),br=function(a,n){return(0,I.f3)(U.CP)(a,void 0,0)},yr=function(a,n){return(0,I.f3)(ae)(a,void 0,1)},Cr=function(a,n){return(0,I.f3)(He.nR)(a,void 0,2)},wr=Reflect.metadata("design:type",Function),kr=Reflect.metadata("design:paramtypes",[typeof U.CP=="undefined"?Object:U.CP,typeof ae=="undefined"?Object:ae,typeof He.nR=="undefined"?Object:He.nR]),Sr=(0,E.vg)(),Tr=Reflect.metadata("design:type",Array),Or=(0,E.vg)(),gr(le=br(le=yr(le=Cr(le=wr(le=kr(le=(We=function(){function u(a,n,r){var e=this;Q()(this,u),S()(this,"_pollModels",void 0),S()(this,"serverManager",void 0),S()(this,"kernelManager",void 0),S()(this,"notebookFileService",void 0),G()(this,"metrics",Br,this),G()(this,"enabled",Ir,this),this.serverManager=a,this.kernelManager=n,this.notebookFileService=r,this.notebookFileService.onNotebookFileChanged(function(){e.refresh()}),this._pollModels=new Ra.n_({auto:!1,factory:function(){return e.getMetrics()},frequency:{interval:4*1e3,backoff:!0,max:300*1e3},name:"metrics",standby:"when-hidden"})}return q()(u,[{key:"enable",value:function(){var a=O()(f()().mark(function r(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.enabled=!0,this.getDefaultMetrics(),t.next=4,(0,E.P$)(this._pollModels).start();case 4:return t.next=6,(0,E.P$)(this._pollModels).tick;case 6:case"end":return t.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"disable",value:function(){var a=O()(f()().mark(function r(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.enabled=!1,t.next=3,(0,E.P$)(this._pollModels).stop();case 3:case"end":return t.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"refresh",value:function(){var a=O()(f()().mark(function r(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.enabled){t.next=5;break}return t.next=3,(0,E.P$)(this._pollModels).refresh();case 3:return t.next=5,(0,E.P$)(this._pollModels).tick;case 5:case"end":return t.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"getDefaultMetrics",value:function(){var n=this.notebookFileService.currentNotebookFile,r=[];if(n)for(var e=this.kernelManager.getKernelConnections(n),t=0,o=e.length;t<o;t++){var i=e[t],s=i.model,l=i.status,g=s.id,d=s.name,h=b.jro[l],y=h.color,m=h.text_zh,C=this.kernelManager.getServerByKernelConnection(i);C&&r.push({server:C,host:{cpu:0,memory:0,cpuText:"N/A",memoryText:"N/A"},kernel:{id:g,name:d,pid:"",status:l,statusText:m,statusColor:y,cpu:0,memory:0,options:[],cpuText:"N/A",memoryText:"N/A"}})}return this.metrics=r,r}},{key:"getMetrics",value:function(){var a=O()(f()().mark(function r(){var e,t,o,i,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e=this.notebookFileService.currentNotebookFile,t=[],!e){d.next=13;break}o=this.kernelManager.getKernelConnections(e),i=0,s=o.length;case 5:if(!(i<s)){d.next=13;break}return d.next=8,this.getMetricsItem(o[i]);case 8:l=d.sent,l&&t.push(l);case 10:i++,d.next=5;break;case 13:return this.metrics=t,d.abrupt("return",t);case 15:case"end":return d.stop()}},r,this)}));function n(){return a.apply(this,arguments)}return n}()},{key:"getMetricsItem",value:function(){var a=O()(f()().mark(function r(e){var t,o,i;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=this.kernelManager.getServerByKernelConnection(e),t){l.next=3;break}return l.abrupt("return");case 3:return l.next=5,this.getServerStatus(t);case 5:return o=l.sent,l.next=8,this.getKernelStatus(t,e);case 8:return i=l.sent,l.abrupt("return",{server:t,host:o,kernel:i});case 10:case"end":return l.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getServerStatus",value:function(){var a=O()(f()().mark(function r(e){var t,o,i;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,t="/api/metrics/v1",o={method:"GET"},l.next=5,(0,F.WY)(t,o,e.id);case 5:return i=l.sent,l.abrupt("return",{cpu:i.cpu_percent,memory:i.rss,cpuText:"".concat(i.cpu_percent," %"),memoryText:this.humanFileSize(i.rss)});case 9:l.prev=9,l.t0=l.catch(0),console.log(l.t0);case 12:return l.abrupt("return",{cpu:0,memory:0,cpuText:"N/A",memoryText:"N/A"});case 13:case"end":return l.stop()}},r,this,[[0,9]])}));function n(r){return a.apply(this,arguments)}return n}()},{key:"getKernelStatus",value:function(){var a=O()(f()().mark(function r(e,t){var o,i,s,l,g,d,h,y,m,C,N,v,k,P,z,W,B;return f()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return o=t.model,i=t.status,s=o.id,l=o.name,g=e.kernelspec?Object.keys(e.kernelspec.kernelspecs):[],ue.prev=3,d="/api/metrics/v1/kernel_usage/get_usage/"+s,h={method:"GET"},ue.next=8,(0,F.WY)(d,h,e.id);case 8:return y=ue.sent,m=this.parseKernelStatus(y),C=m.cpu,N=m.memory,v=m.pid,k=m.cpuText,P=m.memoryText,z=b.jro[i],W=z.color,B=z.text_zh,ue.abrupt("return",{id:s,name:l,pid:v,status:i,statusText:B,statusColor:W,cpu:C,memory:N,options:g,cpuText:k,memoryText:P});case 14:ue.prev=14,ue.t0=ue.catch(3),console.log(ue.t0);case 17:return ue.abrupt("return",{id:s,name:l,pid:"",status:"unknown",statusText:b.jro.unknown.text_zh,statusColor:b.jro.unknown.color,cpu:0,memory:0,options:g,cpuText:"N/A",memoryText:"N/A"});case 18:case"end":return ue.stop()}},r,this,[[3,14]])}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"humanFileSize",value:function(n){var r=Math.floor(Math.log(n)/Math.log(1024));return(n/Math.pow(1024,r)).toFixed(2)+" "+["B","kB","MB","GB","TB"][r]}},{key:"parseKernelStatus",value:function(n){var r=n.content.kernel_cpu,e=n.content.kernel_memory,t=n.content.pid,o="".concat(r," %"),i=this.humanFileSize(e);return{cpu:r,memory:e,pid:t,cpuText:o,memoryText:i}}}]),u}(),Br=x()(We.prototype,"metrics",[Sr,Tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ir=x()(We.prototype,"enabled",[Or],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),We))||le)||le)||le)||le)||le)||le),Fa=c(24185),Pa=c(64239),La=c(28140),Ka=c(29603),Ar=c(15304),Mr=function(a){var n=a.data,r=(0,A.useRef)(null),e=(0,A.useRef)();return(0,A.useEffect)(function(){if(r.current){var t=new Ar.SmoothieChart({millisPerPixel:50,grid:{fillStyle:"#ffffff",strokeStyle:"rgba(119,119,119,0.22)",lineWidth:1},labels:{disabled:!0},tooltip:!1}),o=new Ar.TimeSeries;t.addTimeSeries(o,{lineWidth:1,strokeStyle:"rgba(24,144,255,1)",fillStyle:"rgba(24,144,255,0.2)",interpolation:"bezier"}),t.streamTo(r.current,2e3),e.current=o}},[]),(0,A.useEffect)(function(){e.current&&e.current.append(n.time,n.data)},[n]),(0,p.jsx)("canvas",{ref:r,width:"270",height:"60"})},za=function(a){var n=a.visible,r=a.close,e=(0,E.oC)(Nr),t=e.metrics,o=function(){var s=O()(f()().mark(function l(g){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:g&&e.enable();case 1:case"end":return h.stop()}},l)}));return function(g){return s.apply(this,arguments)}}(),i=function(){e.disable(),r()};return(0,p.jsx)(Ka.Z,{placement:"right",onClose:function(){return i()},width:360,open:n,mask:!1,afterOpenChange:o,destroyOnClose:!0,title:M.U6.t("\u8D44\u6E90\u6D88\u8017"),children:(0,p.jsx)("div",{className:"secretnote-kernel-status",children:t.map(function(s){return(0,p.jsxs)("div",{className:"kernel-status-item",children:[(0,p.jsxs)("div",{className:"server-name",children:[s.server.name,":"]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsxs)("span",{className:"label",children:[M.U6.t("\u540D\u79F0"),":"]}),(0,p.jsx)("span",{children:s.kernel.name})]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsxs)("span",{className:"label",children:[M.U6.t("\u72B6\u6001"),":"]}),(0,p.jsx)($e.Z,{color:s.kernel.statusColor,text:s.kernel.statusText})]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsx)("span",{className:"label",children:"PID:"}),(0,p.jsx)("span",{children:s.kernel.pid})]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsx)("span",{className:"label",children:"CPU:"}),(0,p.jsx)("span",{children:s.kernel.cpuText})]}),(0,p.jsx)(Mr,{data:{time:Date.now(),data:s.kernel.cpu}}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsx)("span",{className:"label",children:"RAM:"}),(0,p.jsx)("span",{children:s.kernel.memoryText})]}),(0,p.jsx)(Mr,{data:{time:Date.now(),data:s.kernel.memory}})]},s.kernel.id)})})})},xr={id:"secretnote-metrics-panel-modal",component:za},Er,jr,Vr,_r,Te,mt={id:"metrics-panel-open"},Da=function(){var a=(0,E.oC)(Ue.Z),n=function(){a.openModal(xr)};return(0,p.jsx)(La.Z,{className:"chat-icon",onClick:n,size:16})},Za=(Er=(0,I.ri)({contrib:[ye.p,Fa.H,Pa.l]}),jr=function(a,n){return(0,I.f3)(b.w29)(a,void 0,0)},Vr=Reflect.metadata("design:type",Function),_r=Reflect.metadata("design:paramtypes",[typeof b.w29=="undefined"?Object:b.w29]),Er(Te=jr(Te=Vr(Te=_r(Te=function(){function u(a){Q()(this,u),S()(this,"libroCommand",void 0),this.libroCommand=a}return q()(u,[{key:"registerCommands",value:function(n){this.libroCommand.registerLibroCommand(n,mt,{execute:function(){var r=O()(f()().mark(function t(o,i){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(!i||!(i instanceof b.yZV))){l.next=2;break}return l.abrupt("return");case 2:case"end":return l.stop()}},t)}));function e(t,o){return r.apply(this,arguments)}return e}(),isVisible:function(e,t,o){return o===b.xNW.HeaderRight},isEnabled:function(e,t){return!t||!(t instanceof b.yZV)?!1:!!t.model.kernelConnection}})}},{key:"registerToolbarItems",value:function(n){n.registerItem({id:mt.id,icon:Da,command:mt.id,order:"a",tooltip:M.U6.t("\u67E5\u770B\u72B6\u6001")})}},{key:"registerModal",value:function(){return xr}}]),u}())||Te)||Te)||Te)||Te),Ga=Be.R.create().register(Za,Nr),Rr,Fr,Pr,Lr,Oe,Ua=(0,F.Q4)(),Je=(Rr=(0,I.ri)(),Fr=function(a,n){return(0,I.f3)(U.CP)(a,void 0,0)},Pr=Reflect.metadata("design:type",Function),Lr=Reflect.metadata("design:paramtypes",[typeof U.CP=="undefined"?Object:U.CP]),Rr(Oe=Fr(Oe=Pr(Oe=Lr(Oe=function(){function u(a){Q()(this,u),S()(this,"serverManager",void 0),this.serverManager=a}return q()(u,[{key:"nodes",get:function(){return this.serverManager.servers.map(function(n){return j()(j()({},n),{},{color:Ua})})}},{key:"addNode",value:function(){var a=O()(f()().mark(function r(e){var t,o,i;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.name,o=e.address,i=e.type,l.next=3,this.serverManager.addServer({name:t.trim(),address:o.trim(),type:i});case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"deleteNode",value:function(){var a=O()(f()().mark(function r(e){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.serverManager.deleteServer(e);case 2:case"end":return o.stop()}},r,this)}));function n(r){return a.apply(this,arguments)}return n}()},{key:"updateNodeName",value:function(){var a=O()(f()().mark(function r(e,t){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.serverManager.updateServer(e,{name:t});case 2:case"end":return i.stop()}},r,this)}));function n(r,e){return a.apply(this,arguments)}return n}()},{key:"checkName",value:function(n){var r=this.nodes.every(function(e){return e.name!==n});return r}},{key:"checkAddress",value:function(n){var r=this,e=this.nodes.every(function(t){return r.normalizedAddress(t.address)!==r.normalizedAddress(n)});return e}},{key:"normalizedAddress",value:function(n){return n.replace("localhost","127.0.0.1")}}]),u}())||Oe)||Oe)||Oe)||Oe),$a=c(89864),Ha=c(98034),vt=c(44288),Kr=c(29800),Wa=c(37951),zr,Dr,Zr,Gr,Ur,ve,Ja=Ha.Z.Paragraph,$r=function(a){var n=a.status;return n===U.U$.running?{status:"success",badgeStatus:"success",text:M.U6.t("\u5728\u7EBF")}:n===U.U$.error?{status:"error",badgeStatus:"error",text:M.U6.t("\u79BB\u7EBF")}:{status:"default",badgeStatus:"default",text:M.U6.t("\u79BB\u7EBF")}},Xa=function(a){var n=a.node,r=(0,E.oC)(be.yd),e=$r(n),t=e.status,o=e.text,i=(0,A.useState)(n.name),s=se()(i,2),l=s[0],g=s[1],d=function(){var y=O()(f()().mark(function m(C){return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,r.service.deleteNode(C);case 3:R.ZP.success(M.U6.t("\u5220\u9664\u6210\u529F")),v.next=9;break;case 6:v.prev=6,v.t0=v.catch(0),v.t0 instanceof Error&&R.ZP.error(v.t0.message);case 9:case"end":return v.stop()}},m,null,[[0,6]])}));return function(C){return y.apply(this,arguments)}}(),h=function(){var y=O()(f()().mark(function m(C,N){return f()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(C.name!==N){k.next=2;break}return k.abrupt("return");case 2:return k.prev=2,k.next=5,r.service.updateNodeName(C.id,N);case 5:g(N),k.next=11;break;case 8:k.prev=8,k.t0=k.catch(2),k.t0 instanceof Error&&R.ZP.error(k.t0.message);case 11:case"end":return k.stop()}},m,null,[[2,8]])}));return function(C,N){return y.apply(this,arguments)}}();return(0,p.jsxs)("div",{className:"secretnote-node-description",children:[(0,p.jsxs)(T.Z,{title:M.U6.t("\u8282\u70B9\u4FE1\u606F"),column:1,children:[(0,p.jsx)(T.Z.Item,{label:M.U6.t("\u540D\u79F0"),children:(0,p.jsx)(Ja,{editable:{onChange:function(m){return h(n,m)},tooltip:!1},children:l})}),(0,p.jsx)(T.Z.Item,{label:M.U6.t("\u5730\u5740"),children:n.address}),(0,p.jsx)(T.Z.Item,{label:M.U6.t("\u72B6\u6001"),children:(0,p.jsx)($e.Z,{status:t,text:o})})]}),(0,p.jsx)(vt.ZP,{type:"link",onClick:function(){d(n.id)},children:M.U6.t("\u5220\u9664")})]})},Ya=function(){var a=K.Z.useForm(),n=se()(a,1),r=n[0],e=(0,A.useState)(!1),t=se()(e,2),o=t[0],i=t[1],s=(0,A.useState)(!1),l=se()(s,2),g=l[0],d=l[1],h=(0,E.oC)(be.yd),y=function(){r.validateFields().then(function(){var N=O()(f()().mark(function v(k){var P;return f()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return d(!0),W.next=3,h.service.addNode(k);case 3:return P=W.sent,P.status===U.U$.running?R.ZP.success(M.U6.t("\u8282\u70B9\u6DFB\u52A0\u6210\u529F")):R.ZP.info("\u8282\u70B9\u6DFB\u52A0\u6210\u529F\uFF0C\u4F46\u662F\u8282\u70B9\u5904\u4E8E\u79BB\u7EBF\u72B6\u6001"),i(!1),r.resetFields(),d(!1),W.abrupt("return");case 9:case"end":return W.stop()}},v)}));return function(v){return N.apply(this,arguments)}}()).catch(function(){})},m=(0,p.jsx)("div",{className:"secretnote-add-node",children:(0,p.jsxs)(K.Z,{form:r,autoComplete:"off",requiredMark:!1,labelCol:{span:4},wrapperCol:{span:20},initialValues:{name:"",address:"",type:"common"},children:[(0,p.jsx)(K.Z.Item,{label:M.U6.t("\u540D\u79F0"),name:"name",rules:[{required:!0,message:M.U6.t("\u8BF7\u8F93\u5165\u540D\u79F0")},{max:16,message:M.U6.t("\u540D\u79F0\u8FC7\u957F")}],children:(0,p.jsx)(te.Z,{placeholder:"Alice"})}),(0,p.jsx)(K.Z.Item,{label:M.U6.t("\u5730\u5740"),name:"address",rules:[{required:!0,message:M.U6.t("\u8BF7\u8F93\u5165\u5730\u5740")},{max:100,message:M.U6.t("\u5730\u5740\u8FC7\u957F")}],children:(0,p.jsx)(te.Z,{placeholder:"127.0.0.1:8888"})}),(0,p.jsx)(K.Z.Item,{wrapperCol:{offset:4,span:20},style:{marginBottom:0},children:(0,p.jsx)(Hn.Z,{children:(0,p.jsx)(vt.ZP,{type:"primary",htmlType:"submit",onClick:function(){y()},loading:g,children:M.U6.t("\u6DFB\u52A0")})})})]})});return(0,p.jsxs)("div",{className:"secretnote-node",children:[(0,p.jsx)(Kr.C.Group,{children:h.service.nodes.map(function(C){return(0,p.jsx)(L.Z,{content:(0,p.jsx)(Xa,{node:C}),title:"",overlayClassName:"secretnote-node-popover",overlayStyle:{width:280},trigger:"click",placement:"bottomLeft",arrow:!1,children:(0,p.jsx)($e.Z,{status:$r(C).badgeStatus,dot:!0,offset:[-28,4],children:(0,p.jsx)(Kr.C,{shape:"square",style:{backgroundColor:C.color,cursor:"pointer"},children:(0,p.jsx)("span",{style:{color:(0,F.U_)(C.color)},children:C.name.slice(0,1).toUpperCase()})})})},C.id)})}),(0,p.jsx)(L.Z,{content:m,title:"",overlayClassName:"secretnote-node-popover",overlayStyle:{width:446},trigger:"click",placement:"bottomLeft",open:o,onOpenChange:function(N){r.resetFields(),i(N)},arrow:!1,children:(0,p.jsx)(vt.ZP,{icon:(0,p.jsx)(Wa.Z,{size:16}),className:"btn",onClick:function(){return i(!0)}})})]})},Hr=(zr=(0,I.ri)(),Dr=(0,Ne.ei)("secretnote-node-view"),Zr=function(a,n){return(0,I.f3)(Je)(a,void 0,0)},Gr=Reflect.metadata("design:type",Function),Ur=Reflect.metadata("design:paramtypes",[typeof Je=="undefined"?Object:Je]),zr(ve=Dr(ve=Zr(ve=Gr(ve=Ur(ve=function(u){he()(n,u);var a=ge()(n);function n(r){var e;return Q()(this,n),e=a.call(this),S()(w()(e),"view",Ya),S()(w()(e),"service",void 0),e.service=r,e}return q()(n)}($a.P))||ve)||ve)||ve)||ve)||ve),Qa=Be.R.create().register(Hr,Je,(0,Ne.bQ)({slot:hr.Mx.right,view:Hr,autoCreate:!0})),qa=c(27275),ei=c(36752),ti=c(39930),ni=c(50013),ri=function(){return(0,p.jsx)(ze.rF.Application,{asChild:!0,modules:[Xe.n6L,hr.xu,ei.O,qa.F,ja,He.qi,Qa,ti.V,Va.Q,Ga,_a.p,ni.u,ga]},"libro-app")},ai=ri}}]);
